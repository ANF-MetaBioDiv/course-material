[
  {
    "objectID": "practicals/PART_I-DADA2_ANF.html",
    "href": "practicals/PART_I-DADA2_ANF.html",
    "title": "Part I- Data preprocessing : From Dada2 to Phyloseq",
    "section": "",
    "text": "Your sequencing data is in the directory data so:\n\n#Put the path directory containing your data (sequencing files) in a « variable » called path_to_fastqs\npath_to_fastqs <- here::here(\"data\",\"raw\")\n\n#download reference databases\nrefdb_folder <- here::here(\"data\",\"refdb\")\ndir.create(refdb_folder)\n\nWarning in dir.create(refdb_folder): '/home/nicolas/Documents/anf-metabarcoding/\ndata/refdb' existe déjà\n\ngetOption('timeout')\n\n[1] 60\n\noptions(timeout=1200)\n\nsilva_train_set <- file.path(refdb_folder,\"silva_nr99_v138.1_train_set.fa.gz\")\n\nif(!file.exists(file.path(refdb_folder,\"silva_nr99_v138.1_train_set.fa.gz\"))){\n  download.file(\"https://zenodo.org/record/4587955/files/silva_nr99_v138.1_train_set.fa.gz\",\n              silva_train_set,\n              quiet=TRUE)\n}\n\nsilva_species_assignment <- file.path(refdb_folder,\"silva_species_assignment_v138.1.fa.gz\")\n\nif(!file.exists(file.path(refdb_folder,\"silva_species_assignment_v138.1.fa.gz\"))){\n  download.file(\"https://zenodo.org/record/4587955/files/silva_species_assignment_v138.1.fa.gz\",\n              silva_species_assignment,\n              quiet=TRUE)\n}\n\noptions(timeout=60)\n\n# Attached functions from functions_dada4.R located in the R folder\nsource(here::here(\"R\",\"functions_dada4.R\"))"
  },
  {
    "objectID": "practicals/PART_I-DADA2_ANF.html#iv-sequence-quality-check",
    "href": "practicals/PART_I-DADA2_ANF.html#iv-sequence-quality-check",
    "title": "Part I- Data preprocessing : From Dada2 to Phyloseq",
    "section": "IV-Sequence Quality Check",
    "text": "IV-Sequence Quality Check\nFunction: plotQualityProfile :\nhttps://www.rdocumentation.org/packages/dada2/versions/1.0.3/topics/plotQualityProfile\nWe use a function implemented in functions_dada4.R, which takes the list of R1 files and R2 files and put all quality plot results in one pdf file and save in your current directory TP_METABARCODING.\n\nqualityprofile\n\nfunction (fileFw, fileRev, outfile) \n{\n    pdf(outfile, onefile = TRUE)\n    for (i in 1:length(fileFw)) {\n        f <- dada2::plotQualityProfile(fileFw[[i]])\n        r <- dada2::plotQualityProfile(fileRev[[i]])\n        print(f)\n        print(r)\n    }\n    dev.off()\n}\n\n\n\n# create a directory for the outputs\nquality_folder <- here::here(\"outputs\",\"dada2\",\"quality_plots\")\n\ndir.create(quality_folder,recursive = TRUE)\n\nWarning in dir.create(quality_folder, recursive = TRUE): '/home/nicolas/\nDocuments/anf-metabarcoding/outputs/dada2/quality_plots' existe déjà\n\nqualityprofile(fnFs,\n               fnRs,\n               file.path(quality_folder,\"quality_plots.pdf\"))\n\nWarning: `guides(<scale> = FALSE)` is deprecated. Please use `guides(<scale> =\n\"none\")` instead.\n\n\nWarning: `guides(<scale> = FALSE)` is deprecated. Please use `guides(<scale> = \"none\")` instead.\n`guides(<scale> = FALSE)` is deprecated. Please use `guides(<scale> = \"none\")` instead.\n`guides(<scale> = FALSE)` is deprecated. Please use `guides(<scale> = \"none\")` instead.\n\n\npng \n  2 \n\n\nOpen the qualityplot.pdf"
  },
  {
    "objectID": "practicals/PART_I-DADA2_ANF.html#v-sequence-trimming",
    "href": "practicals/PART_I-DADA2_ANF.html#v-sequence-trimming",
    "title": "Part I- Data preprocessing : From Dada2 to Phyloseq",
    "section": "V-Sequence Trimming",
    "text": "V-Sequence Trimming\n\na/ Primer Removal\n\nPut primer sequences in variables\n\n\nCreate a sub-directory NOP in ./data directory & with file names\nPrepare empty files that are going to collect the results (e.g. sequences with no primers)\n\n#files are empty at this stage\npath_to_trimmed_reads <- here::here(\"outputs\",\"dada2\",\"trimmed\")\ndir.create(path_to_trimmed_reads)\n\nWarning in dir.create(path_to_trimmed_reads): '/home/nicolas/Documents/anf-\nmetabarcoding/outputs/dada2/trimmed' existe déjà\n\nnopFw <- file.path(path_to_trimmed_reads, basename(fnFs))\nnopRv <- file.path(path_to_trimmed_reads, basename(fnRs))\n#see\nnopFw |> head()\n\n[1] \"/home/nicolas/Documents/anf-metabarcoding/outputs/dada2/trimmed/S11B_R1.fastq.gz\"\n[2] \"/home/nicolas/Documents/anf-metabarcoding/outputs/dada2/trimmed/S1B_R1.fastq.gz\" \n\n\n\n\nRemove primers\n\nFWD  <- \"CCTACGGGNBGCASCAG\"\nREV  <- \"GACTACNVGGGTATCTAAT\"\n#Enlever les Primers  dans fichiers R1=fnFs et R2=fnRs et remplir les nouveaux fichiers sans les primers : nopFs (R1) et nopRs (R2)\ndada2::removePrimers(fnFs, nopFw, primer.fwd=FWD, orient=TRUE, max.mismatch=0,verbose=TRUE)\n\nOverwriting file:/home/nicolas/Documents/anf-metabarcoding/outputs/dada2/trimmed/S11B_R1.fastq.gz\n\n\nRead in 2000, output 1959 (98%) filtered sequences.\n\n\nOverwriting file:/home/nicolas/Documents/anf-metabarcoding/outputs/dada2/trimmed/S1B_R1.fastq.gz\n\n\nRead in 2000, output 1949 (97.4%) filtered sequences.\n\ndada2::removePrimers(fnRs, nopRv, primer.fwd=REV, orient=TRUE, max.mismatch=0,verbose=TRUE)\n\nOverwriting file:/home/nicolas/Documents/anf-metabarcoding/outputs/dada2/trimmed/S11B_R2.fastq.gz\n\n\nRead in 2000, output 1442 (72.1%) filtered sequences.\n\n\nOverwriting file:/home/nicolas/Documents/anf-metabarcoding/outputs/dada2/trimmed/S1B_R2.fastq.gz\n\n\nRead in 2000, output 1487 (74.3%) filtered sequences.\n\n#####\n\n\n\n\nb/ Quality Trimming process\n\nCreate a sub-directory Filtered & files for collecting the filtered results\nSame as previously see for primers, but now for sequence quality trimming\n\npath_to_filtered_reads <- here::here(\"outputs\",\"dada2\",\"filtered\")\ndir.create(path_to_filtered_reads)\n\nWarning in dir.create(path_to_filtered_reads): '/home/nicolas/Documents/anf-\nmetabarcoding/outputs/dada2/filtered' existe déjà\n\nfiltFs <- file.path(path_to_filtered_reads, basename(fnFs))\nfiltRs <- file.path(path_to_filtered_reads, basename(fnRs))\nnames(filtFs) <- sample.names\nnames(filtRs) <- sample.names\n\n\n\nApply quality trimming function\nFunction filterAndTrim: https://rdrr.io/bioc/dada2/man/filterAndTrim.html\n\nout <- dada2::filterAndTrim(nopFw, filtFs, nopRv, filtRs, minLen=150, matchIDs=TRUE,\n                     maxN=0, maxEE=c(3,3), truncQ=2)\n\n\n#See\nout\n\n                 reads.in reads.out\nS11B_R1.fastq.gz     1959       950\nS1B_R1.fastq.gz      1949      1016\n\n\nDetails:\nnopFw : Input, your row Forward list (path) of sequencing files without primer.\nfiltFs : Output, the empty files created at the previous stage that you are now going to fill with this command.\nnopRv, filRs : Same as above, but for the Reverse data\nTruncLen : Truncate reads after truncLen bases. Reads shorter than this are discarded.\nExple : TruncLen=c(200,150), means R1 forward are cut at 200 pb & the R2 reverse at 150 pb.\nTrimLeft : The number of nucleotides to remove from the start of each read, from the left\nTrimright : The number of nucleotides to remove from the start of each read, from the right\nmaxN : Max number of ambiguous bases accepted\nmaxEE : Quality system to remove low quality read. Standard maxEE=c(2,2).\nIf you want to be more flexible (accept more low quality), increase the value, maxEE=c(2,5). 2 is for the forward, 5 for le reverse.\nTruncQ=2. Truncate reads at the first instance of a quality score less than or equal to truncQ."
  },
  {
    "objectID": "practicals/PART_I-DADA2_ANF.html#vi-learn-errors",
    "href": "practicals/PART_I-DADA2_ANF.html#vi-learn-errors",
    "title": "Part I- Data preprocessing : From Dada2 to Phyloseq",
    "section": "VI-Learn « Errors »",
    "text": "VI-Learn « Errors »\nFunction: learnErrors https://rdrr.io/bioc/dada2/man/learnErrors.html\nParametric model to distinguish sequencing artefacts from true biological variations\n\nApply the function\n\nerrF <- dada2::learnErrors(filtFs, randomize =TRUE, multithread=TRUE)\n\n541515 total bases in 1966 reads from 2 samples will be used for learning the error rates.\n\nerrR <- dada2::learnErrors(filtRs, randomize =TRUE, multithread=TRUE)\n\n554402 total bases in 1966 reads from 2 samples will be used for learning the error rates.\n\n#See plot\ndada2::plotErrors(errF, nominalQ=TRUE)\n\nWarning: Transformation introduced infinite values in continuous y-axis\nTransformation introduced infinite values in continuous y-axis"
  },
  {
    "objectID": "practicals/PART_I-DADA2_ANF.html#vii--dereplication-identical-sequences",
    "href": "practicals/PART_I-DADA2_ANF.html#vii--dereplication-identical-sequences",
    "title": "Part I- Data preprocessing : From Dada2 to Phyloseq",
    "section": "VII- Dereplication (identical sequences)",
    "text": "VII- Dereplication (identical sequences)\nFunction: derepFastq\nhttps://www.rdocumentation.org/packages/dada2/versions/1.0.3/topics/derepFastq\n\nderepFs <- dada2::derepFastq(filtFs, verbose=TRUE)\n\nDereplicating sequence entries in Fastq file: /home/nicolas/Documents/anf-metabarcoding/outputs/dada2/filtered/S11B_R1.fastq.gz\n\n\nEncountered 607 unique sequences from 950 total sequences read.\n\n\nDereplicating sequence entries in Fastq file: /home/nicolas/Documents/anf-metabarcoding/outputs/dada2/filtered/S1B_R1.fastq.gz\n\n\nEncountered 664 unique sequences from 1016 total sequences read.\n\nderepRs <- dada2::derepFastq(filtRs, verbose=TRUE)\n\nDereplicating sequence entries in Fastq file: /home/nicolas/Documents/anf-metabarcoding/outputs/dada2/filtered/S11B_R2.fastq.gz\n\n\nEncountered 691 unique sequences from 950 total sequences read.\n\n\nDereplicating sequence entries in Fastq file: /home/nicolas/Documents/anf-metabarcoding/outputs/dada2/filtered/S1B_R2.fastq.gz\n\n\nEncountered 733 unique sequences from 1016 total sequences read."
  },
  {
    "objectID": "practicals/PART_I-DADA2_ANF.html#viii-amplicon-sequence-variant-asv",
    "href": "practicals/PART_I-DADA2_ANF.html#viii-amplicon-sequence-variant-asv",
    "title": "Part I- Data preprocessing : From Dada2 to Phyloseq",
    "section": "VIII-Amplicon Sequence Variant =ASV",
    "text": "VIII-Amplicon Sequence Variant =ASV\nError Corrections: function dada\nhttps://www.quantargo.com/help/r/latest/packages/dada2/1.18.0/dada\n\ndadaFs <- dada2::dada(derepFs, err=errF, multithread=TRUE)\n\nSample 1 - 950 reads in 607 unique sequences.\nSample 2 - 1016 reads in 664 unique sequences.\n\ndadaRs <- dada2::dada(derepRs, err=errR, multithread=TRUE)\n\nSample 1 - 950 reads in 691 unique sequences.\nSample 2 - 1016 reads in 733 unique sequences."
  },
  {
    "objectID": "practicals/PART_I-DADA2_ANF.html#ix--assembly",
    "href": "practicals/PART_I-DADA2_ANF.html#ix--assembly",
    "title": "Part I- Data preprocessing : From Dada2 to Phyloseq",
    "section": "IX- Assembly",
    "text": "IX- Assembly\nFunction: mergePairs :\nhttps://www.rdocumentation.org/packages/dada2/versions/1.0.3/topics/mergePairs\nMerge the forwards & reverses together maxMismatch : how many mismatch do you accept in the overlapping region?\n\nmergers <- dada2::mergePairs(dadaFs, derepFs, dadaRs, derepRs, maxMismatch= 0, verbose=TRUE)\n\n709 paired-reads (in 28 unique pairings) successfully merged out of 768 (in 45 pairings) input.\n\n\n677 paired-reads (in 32 unique pairings) successfully merged out of 758 (in 57 pairings) input.\n\n\n\nMake OTU table: dada2 format have sequences as identifiers!\n\nseqtab <- dada2::makeSequenceTable(mergers)"
  },
  {
    "objectID": "practicals/PART_I-DADA2_ANF.html#x--remove-chimera",
    "href": "practicals/PART_I-DADA2_ANF.html#x--remove-chimera",
    "title": "Part I- Data preprocessing : From Dada2 to Phyloseq",
    "section": "X- Remove Chimera",
    "text": "X- Remove Chimera\nFunction: removeBimeraDenovo\nhttps://www.rdocumentation.org/packages/dada2/versions/1.0.3/topics/removeBimeraDenovo\n\nseqtab.nochim <- dada2::removeBimeraDenovo(seqtab, method=\"consensus\", multithread=TRUE, verbose=TRUE)\n\nIdentified 1 bimeras out of 53 input sequences."
  },
  {
    "objectID": "practicals/PART_I-DADA2_ANF.html#xi-summarize-the-pre-processing",
    "href": "practicals/PART_I-DADA2_ANF.html#xi-summarize-the-pre-processing",
    "title": "Part I- Data preprocessing : From Dada2 to Phyloseq",
    "section": "XI – Summarize the pre-processing",
    "text": "XI – Summarize the pre-processing\n\ngetN <- function(x) sum(dada2::getUniques(x))\n\ntrack <- base::cbind(out, sapply(dadaFs, getN), sapply(dadaRs, getN),sapply(mergers, getN),rowSums(seqtab.nochim),rowSums(seqtab.nochim)/out[,1]*100)\ncolnames(track) <- c(\"input\", \"filtered\", \"denoisedF\", \"denoisedR\", \"merged\", \"nonchim\",\"%retained\")\nrownames(track) <- sample.names\ntrack\n\n     input filtered denoisedF denoisedR merged nonchim %retained\nS11B  1959      950       830       809    709     630  32.15926\nS1B   1949     1016       794       859    677     662  33.96614"
  },
  {
    "objectID": "practicals/PART_I-DADA2_ANF.html#xii--taxonomic-assignment-using-dada2",
    "href": "practicals/PART_I-DADA2_ANF.html#xii--taxonomic-assignment-using-dada2",
    "title": "Part I- Data preprocessing : From Dada2 to Phyloseq",
    "section": "XII- Taxonomic Assignment using Dada2",
    "text": "XII- Taxonomic Assignment using Dada2\nFunction “assignTaxonomy”: Assignment from Phylum to Genus level\nhttps://www.quantargo.com/help/r/latest/packages/dada2/1.18.0/assignTaxonomy\nFunction “addSpecies”: Assignment to the species level if possible (100% identity).\nhttps://www.quantargo.com/help/r/latest/packages/dada2/1.18.0/addSpecies\n\ntaxa <- dada2::assignTaxonomy(seqtab.nochim,\n                              silva_train_set,\n                              taxLevels = c(\"Kingdom\", \"Phylum\",\"Class\", \"Order\", \"Family\",\"Genus\", \"Species\"),\n                              multithread = TRUE,\n                              minBoot = 60)\n\ntaxa <- dada2::addSpecies(taxa,\n                          silva_species_assignment,\n                          allowMultiple = FALSE)"
  },
  {
    "objectID": "practicals/PART_I-DADA2_ANF.html#export-asv-table",
    "href": "practicals/PART_I-DADA2_ANF.html#export-asv-table",
    "title": "Part I- Data preprocessing : From Dada2 to Phyloseq",
    "section": "Export ASV table",
    "text": "Export ASV table\n\nR objects\n\nexport_folder <- here::here(\"outputs\",\"dada2\",\"asv_table\")\n\ndir.create(export_folder)\n\nWarning in dir.create(export_folder): '/home/nicolas/Documents/anf-\nmetabarcoding/outputs/dada2/asv_table' existe déjà\n\nsaveRDS(object = seqtab.nochim,\n        file = file.path(export_folder,\"seqtab_nochim.rds\"))\n\nsaveRDS(object = taxa,\n        file = file.path(export_folder,\"taxa.rds\"))\n\n\n\nText files\n\ntaxo_export <- apply(taxa,1,paste,collapse=\";\")\nseqtab_export <- t(seqtab.nochim)\n\nseqtab_export <- merge(x = taxo_export,\n      y = seqtab_export,\n      by=0,\n      all.x=TRUE,\n      sort=FALSE)\n\ncolnames(seqtab_export)[1:2] <- c(\"sequence\",\"taxonomy\")\n\nwrite.table(seqtab_export,\n            file=file.path(export_folder,\"asv_table.tsv\"),\n            quote=FALSE,\n            sep=\"\\t\",\n            row.names = FALSE)"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "1 + 1\n\n[1] 2"
  },
  {
    "objectID": "courses/dada2.html#i-received-data",
    "href": "courses/dada2.html#i-received-data",
    "title": "Analysing metabarcoding data with dada2",
    "section": "I received data",
    "text": "I received data"
  },
  {
    "objectID": "courses/dada2.html#what-am-i-going-to-do-with-that",
    "href": "courses/dada2.html#what-am-i-going-to-do-with-that",
    "title": "Analysing metabarcoding data with dada2",
    "section": "What am I going to do with that?",
    "text": "What am I going to do with that?\nLet’s have a closer look of what we have\nzcat 18S-NG080819-3_TTAGCT-CMKL6_L001_R1.fastq.gz | head -n 8\n\nWe need a bioinformatic pipeline to:\n\nFilter out wrong sequences, such as sequencing errors\nGet a format suitable for diversity and community composition analyses of our samples"
  },
  {
    "objectID": "courses/dada2.html#overview",
    "href": "courses/dada2.html#overview",
    "title": "Analysing metabarcoding data with dada2",
    "section": "Overview",
    "text": "Overview\nTwo files (R1 and R2) per sequencing run or per sample (60 first nucleotides):\nR1:\n    @M05074:31:000000000-BC3R3:1:1101:13622:1477 1:N:0:1\n    TAACAACCCAGCAGCTGCGGTAATTCCAGCTCCAATAGCGTATATTTAAGTTGTTGCAGT\n    +\n    ---A99EBC-,C,,CF,@++F7,CFFF9,CEFF8,E,,C+B7F<FFF9,,CE,CF,;,,C\nR2:\n    @M05074:31:000000000-BC3R3:1:1101:13622:1477 2:N:0:1\n    ACAACACTTTCGTTCTTGCTTGATGAAAACATCCTTGGCAAATGCTTTCGCATTAGTTCG\n    +\n    -86@BCFFFGF@FGGFG9,CF,,C6,<A<F@FGGGGA,C,C8C<<FEFG:@,,B,,CFE:\nPer record: identifier, sequence, quality"
  },
  {
    "objectID": "courses/dada2.html#identifier",
    "href": "courses/dada2.html#identifier",
    "title": "Analysing metabarcoding data with dada2",
    "section": "Identifier",
    "text": "Identifier\n    @M05074:31:000000000-BC3R3:1:1101:13622:1477 1:N:0:1\n\n\n\nValue\nDescription\n\n\n\n\nM05074\nthe unique instrument id\n\n\n31\nthe run id\n\n\n000000000-BC3R3\nthe flowcell id\n\n\n1\nflowcell lane\n\n\n1101\ntile number within the flowcell lane\n\n\n13622\n‘x’-coordinate within the tile\n\n\n1477\n‘y’-coordinate within the tile\n\n\n1\nthe member of a pair\n\n\nN\nY if the read is filtered (did not pass)\n\n\n0\n0: none of the control bits are on\n\n\n1\nindex sequence"
  },
  {
    "objectID": "courses/dada2.html#sequence",
    "href": "courses/dada2.html#sequence",
    "title": "Analysing metabarcoding data with dada2",
    "section": "Sequence",
    "text": "Sequence\n\n\n\nThe tag, informs you from which sample the read come from\nThe primer used for the amplification\nThe targeted sequence (metabarcode)"
  },
  {
    "objectID": "courses/dada2.html#quality",
    "href": "courses/dada2.html#quality",
    "title": "Analysing metabarcoding data with dada2",
    "section": "Quality",
    "text": "Quality\nQuality score encoded using ASCII characters:\n\n\n\n\n\nASCII character\nQuality score\n\n\n\n\n!\n0\n\n\n”\n1\n\n\n#\n2\n\n\n\n\n\n\n\nASCII character\nQuality score\n\n\n\n\nG\n38\n\n\nH\n39\n\n\nI\n40\n\n\n\n\n\nThe Phred quality score Q is related to the base calling error probability P according to the following formula:\n\\[Q = -10\\log_{10}P\\]\n\\[P=10^{Q/-10}\\]\n\nIn raw data reads, the quality score rarely exceed 40, but higher scores are possible when different raw reads are assembled"
  },
  {
    "objectID": "courses/dada2.html#strategies",
    "href": "courses/dada2.html#strategies",
    "title": "Analysing metabarcoding data with dada2",
    "section": "Strategies",
    "text": "Strategies\n\nGenetic clustering based approaches producing OTUs:\n\nUCLUST\nSwarm (could be seen as denoising too)\n\nDenoising approaches producing ASVs:\n\nDeblur\nUNOISE\nDADA2"
  },
  {
    "objectID": "courses/dada2.html#dada2-quest-ce-que-cest",
    "href": "courses/dada2.html#dada2-quest-ce-que-cest",
    "title": "Analysing metabarcoding data with dada2",
    "section": "DADA2, qu’est-ce que c’est?",
    "text": "DADA2, qu’est-ce que c’est?\n\n\nDADA (Divisive Amplicon Denoising Algorithm) an algorithm to denoise Roche’s 454 platform errors (Rosen et al. 2012)\nDADA2 implements a new quality-aware model of Illumina amplicon errors (Callahan et al. 2016)\nDADA2 is an open-source R package https://github.com/benjjneb/dada2"
  },
  {
    "objectID": "courses/dada2.html#dada2-the-full-amplicon-workflow",
    "href": "courses/dada2.html#dada2-the-full-amplicon-workflow",
    "title": "Analysing metabarcoding data with dada2",
    "section": "DADA2, the full amplicon workflow",
    "text": "DADA2, the full amplicon workflow\n\nQuality assessment → plotQualityProfile()\nLength trimming → filterAndTrim()\nQuality filtering → filterAndTrim()\nDenoising → dada()\nMerging pair-end reads → mergePairs()\nChimera identification → removeBimeraDenovo()\nTaxonomic assignment → assignTaxonomy()\n\nBut some preliminary steps are missing…"
  },
  {
    "objectID": "courses/dada2.html#artificial-sequences",
    "href": "courses/dada2.html#artificial-sequences",
    "title": "Analysing metabarcoding data with dada2",
    "section": "Artificial sequences",
    "text": "Artificial sequences\n\nTags are used to encode the sample provenance of the reads. Reads need to be grouped by sample provenance (demultiplexing)\nPrimer sequences will bias the error model built by DADA2 and need to be removed (primer trimming).\nBoth task can be achieved using Cutadapt, a command line-tool to find and remove error-tolerantly adapters from reads (Martin et al. 2011)."
  },
  {
    "objectID": "courses/dada2.html#demultiplexing-using-cutadapt",
    "href": "courses/dada2.html#demultiplexing-using-cutadapt",
    "title": "Analysing metabarcoding data with dada2",
    "section": "Demultiplexing using cutadapt",
    "text": "Demultiplexing using cutadapt\nIf your tags are in a fasta file with corresponding sample names as header, you can use this command-line:\n\n\ncutadapt \\\n    -g file:${BARCODES} \\\n    -o {name}_R1.fastq.gz \\\n    -p {name}_R2.fastq.gz \\\n    ${R1_FILE} \\\n    ${R2_FILE}\n\n# blabla\n# fff\n\n\nYou end up with as many R1 and R2 files as samples you have\n\n\n\n\n\n\nHelp! My reads are mixed-orientated\n\n\nRun cutadapt a second time, looking for tags in R2.\nKeep the outputs of the two rounds separated for the rest of the workflow."
  },
  {
    "objectID": "courses/dada2.html#primer-removal-using-cutadapt",
    "href": "courses/dada2.html#primer-removal-using-cutadapt",
    "title": "Analysing metabarcoding data with dada2",
    "section": "Primer removal using cutadapt",
    "text": "Primer removal using cutadapt\nTo remove forward and reverse primer sequences form pair-end read files:\n\n\ncutadapt \\\n    -e 0.1 \\\n    -g ${PRIMER_FORWARD} \\\n    -G ${PRIMER_REVERSE} \\\n    --report=minimal \\\n    --discard-untrimmed \\\n    --minimum-length ${MIN_LENGTH} \\\n    --no-indels \\\n    -o ${FORWARD} \\\n    -p ${REVERSE} \\\n    ${R1_FILE} \\\n    ${R2_FILE} 1> ${LOG}\n\n# \n# error tolerance (default value)\n\n\nAs for demultiplexing, if reads are mix-orientated, run cutadapt twice"
  },
  {
    "objectID": "courses/dada2.html#check-reads-quality",
    "href": "courses/dada2.html#check-reads-quality",
    "title": "Analysing metabarcoding data with dada2",
    "section": "Check reads quality",
    "text": "Check reads quality\n\n\nThe overall quality of the sequencing is checked using plotQualityProfile()\nOutside of DADA2, you can also use FASTQC\nIf the overall quality is too low, you will probably have to resequence your samples\n\n\n\n\nA quality drop is often observed by the end of the reads\n\n\ngreen line: mean\norange line (plain): median\norange line (dashed): 25th and 75th quantiles"
  },
  {
    "objectID": "courses/dada2.html#trimming-and-filtering",
    "href": "courses/dada2.html#trimming-and-filtering",
    "title": "Analysing metabarcoding data with dada2",
    "section": "Trimming and filtering",
    "text": "Trimming and filtering\nTrimming, at a given length, will improve the overall read quality\n\n\n\n\n\n\nDanger\n\n\nAfter trimming, make sure that forward and reverse reads still overlap\n\n\n\nReads of low quality and/or with ambiguous nucleotides (N) after trimming are filtered out.\nBoth length trimming and quality filtering are achieved using the function filterAndTrim()"
  },
  {
    "objectID": "courses/dada2.html#denoising",
    "href": "courses/dada2.html#denoising",
    "title": "Analysing metabarcoding data with dada2",
    "section": "Denoising",
    "text": "Denoising\nIs sequence \\(i\\) generated by sequence \\(j\\) because of sequencing errors?\n\nIn order to define if \\(i\\) is an error of \\(j\\) and perform denoising using DADA2, we need to compute:\n\nthe error rate \\(\\lambda_{ji}\\)\nthe abundance p-value \\(p_A(j \\rightarrow i)\\)"
  },
  {
    "objectID": "courses/dada2.html#error-rate",
    "href": "courses/dada2.html#error-rate",
    "title": "Analysing metabarcoding data with dada2",
    "section": "Error rate",
    "text": "Error rate\n\nThe rate at which an amplicon read with sequence i is produced from sample sequence j is reduced to the product over the transition probabilities between the L aligned nucleotides:\n\n\\[\\lambda_{ji} = \\prod_{l=0}^L p(j(l) \\rightarrow i(l),q_i(l))\\]"
  },
  {
    "objectID": "courses/dada2.html#the-abundance-p-value",
    "href": "courses/dada2.html#the-abundance-p-value",
    "title": "Analysing metabarcoding data with dada2",
    "section": "The abundance p-value",
    "text": "The abundance p-value\nThe abundance p-value (\\(p_A\\)) is the probability of all reads of \\(i\\) (\\(a_i\\)) or more being produced from \\(j\\) during amplification ore sequencing.\n\\[p_A(j \\rightarrow i) = \\frac{1}{1- \\rho_{\\mathrm{pois}}(n_j\\lambda_{ji},0)} \\sum_{a=a_i}^\\infty \\rho_{\\mathrm{pois}}(n_j\\lambda_{ji},a)\\]\nA low p-value indicate that it is unlikely that \\(i\\) is noise from amplifying and sequencing \\(j\\)\n\nThe discrete nature of the Poisson distribution is also why this is a probability mass function and not a density function"
  },
  {
    "objectID": "courses/dada2.html#the-divisive-partitioning-algorithm",
    "href": "courses/dada2.html#the-divisive-partitioning-algorithm",
    "title": "Analysing metabarcoding data with dada2",
    "section": "The divisive partitioning algorithm",
    "text": "The divisive partitioning algorithm\n\nall unique sequences into a single partition\n\\(p_A\\) of all sequences against most abundant sequence (center)\nif smallest p-value below \\(\\Omega_A\\): new partition\n\\(p_A\\) of all sequences against center of new partition\nevery sequence join the partition most likely to have produced it\n\nRepeat steps 3 to 5 until all abundance p-values are greater than \\(\\Omega_A\\)"
  },
  {
    "objectID": "courses/dada2.html#learn-the-error-model",
    "href": "courses/dada2.html#learn-the-error-model",
    "title": "Analysing metabarcoding data with dada2",
    "section": "Learn the error model",
    "text": "Learn the error model\nHow do we compute \\(\\lambda_{ji}\\) if we don’t know the error rate for each possible transition?\nThe error rates will be learned from the data using learnErrors()\n\nThe learnErrors method learns this error model from the data, by alternating estimation of the error rates and inference of sample composition until they converge on a jointly consistent solution"
  },
  {
    "objectID": "courses/dada2.html#visualise-the-error-model",
    "href": "courses/dada2.html#visualise-the-error-model",
    "title": "Analysing metabarcoding data with dada2",
    "section": "Visualise the error model",
    "text": "Visualise the error model\nYou can visualise the estimated error rates using the function plotErrors()"
  },
  {
    "objectID": "courses/dada2.html#run-the-dada2-algorithm",
    "href": "courses/dada2.html#run-the-dada2-algorithm",
    "title": "Analysing metabarcoding data with dada2",
    "section": "Run the DADA2 algorithm",
    "text": "Run the DADA2 algorithm\n\nAfter dereplicating your sequences (derepFastq()), denoise using the function dada()\nBy default sample inference is performed on each sample individually (pool = FALSE).\nIf you are interested in rare variants present in several samples use pool = TRUE\nWhen working on big data, pool = \"pseudo\" is an interesting alternative to pool = TRUE"
  },
  {
    "objectID": "courses/dada2.html#merge-paired-reads",
    "href": "courses/dada2.html#merge-paired-reads",
    "title": "Analysing metabarcoding data with dada2",
    "section": "Merge paired reads",
    "text": "Merge paired reads\nMerge forward and reverse reads using mergePairs()\n\n\nminOverlap: minimum size of overlap\nmaxMismatch: maximum number of mismatches\njustConcatenate: in case your reads don’t overlap"
  },
  {
    "objectID": "courses/dada2.html#remove-chimeras",
    "href": "courses/dada2.html#remove-chimeras",
    "title": "Analysing metabarcoding data with dada2",
    "section": "Remove chimeras",
    "text": "Remove chimeras\n\nChimeras are artifact sequences formed by two or more biological sequences incorrectly joined together.\nWe find and remove bimeras (two-parent chimeras) using the function removeBimeraDenovo()\nChimeric sequences are identified if they can be exactly reconstructed by combining a left-segment and a right-segment from two more abundant “parent” sequences.\nCan be done per sample (method=\"per-sample\"), for the entire dataset (method=\"pooled\") or in a consensus way (method=\"consensus\")\n\n\nChimeras are artifact sequences formed by two or more biological sequences incorrectly joined together. This often occurs during PCR reactions using mixed templates (i.e., uncultured environmental samples). Incomplete extensions during PCR allow subsequent PCR cycles to use a partially extended strand to bind to the template of a different, but similar, sequence. This partially extended strand then acts as a primer to extend and form a chimeric sequence. Once created, the chimeric sequence is then further amplified in subsequent cycles. The end result is a PCR artifact that does not represent a sequence that exists in nature."
  },
  {
    "objectID": "courses/dada2.html#taxonomic-assignment",
    "href": "courses/dada2.html#taxonomic-assignment",
    "title": "Analysing metabarcoding data with dada2",
    "section": "Taxonomic assignment",
    "text": "Taxonomic assignment\n\nTaxonomic assignment within DADA2 workflow, assignTaxonomy(), is achieved using a native implementation of the naive Bayesian classifier method (Wang et al. 2007).\nReference fastas for the three most common 16S databases: Silva, RDP and GreenGenes are maintained by dada2’s team.\nFor eukaryotes, a dada2 formatted version of PR2 can be found here."
  },
  {
    "objectID": "courses/dada2.html#extra-filtering-steps",
    "href": "courses/dada2.html#extra-filtering-steps",
    "title": "Analysing metabarcoding data with dada2",
    "section": "Extra filtering steps",
    "text": "Extra filtering steps\n\nASVs can be filtered out if:\n\nsequence has an unexpected length\nnot assigned to the desired taxonomic group\nconsidered as contaminant (present in negative controls)"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Exploration de la Diversité Taxonomique des Ecosystèmes par Metabarcoding",
    "section": "",
    "text": "Monday\n\nR initiation\n\nTuesday\n\nDada2 presentation\nPhyloseq presentation\n\nWednesday\nThursday\nFriday\n\n\n\n\n\nTuesday\nDada2 practical\nWednesday\nThursday\nFriday"
  }
]