<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.339">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ANF MetaBioDiv - PARTII_alpha_Diversity_ANF</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="../site_libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ANF MetaBioDiv</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-day-1" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Day 1</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-day-1">    
        <li class="dropdown-header">Practicals</li>
        <li>
    <a class="dropdown-item" href="../practicals/rforbeginer.html">
 <span class="dropdown-text">R for beginners</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-day-2" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Day 2</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-day-2">    
        <li class="dropdown-header">Courses</li>
        <li>
    <a class="dropdown-item" href="../courses/introduction.pdf">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../courses/dada2.html" target="_blank">
 <span class="dropdown-text">Analysing metabarcoding data with dada2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../courses/phyloseq.html" target="_blank">
 <span class="dropdown-text">Introduction to phyloseq</span></a>
  </li>  
        <li class="dropdown-header">Practicals</li>
        <li>
    <a class="dropdown-item" href="../practicals/preprocessing_dada2.html">
 <span class="dropdown-text">Preprocessing: dada2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../practicals/preprocessing_phyloseq.html">
 <span class="dropdown-text">Preprocessing: phyloseq</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-day-3" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Day 3</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-day-3">    
        <li class="dropdown-header">Courses</li>
        <li>
    <a class="dropdown-item" href="../courses/alpha_diversity.pdf" target="_blank">
 <span class="dropdown-text">Alpha diversity</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../courses/stat_mean_comparison.pdf" target="_blank">
 <span class="dropdown-text">Introduction to univariate statistics</span></a>
  </li>  
        <li class="dropdown-header">Practicals</li>
        <li>
    <a class="dropdown-item" href="../practicals/alpha_diversity.html">
 <span class="dropdown-text">Alpha diversity</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-day-4" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Day 4</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-day-4">    
        <li class="dropdown-header">Courses</li>
        <li>
    <a class="dropdown-item" href="../courses/beta_diversity.pdf" target="_blank">
 <span class="dropdown-text">Beta diversity</span></a>
  </li>  
        <li class="dropdown-header">Practicals</li>
        <li>
    <a class="dropdown-item" href="../practicals/beta_diversity.html">
 <span class="dropdown-text">Beta diversity</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ANF-MetaBioDiv/course-material" target="_blank"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#prepare-workspace" id="toc-prepare-workspace" class="nav-link active" data-scroll-target="#prepare-workspace"><span class="header-section-number">1</span> Prepare workspace</a>
  <ul class="collapse">
  <li><a href="#load-libraries" id="toc-load-libraries" class="nav-link" data-scroll-target="#load-libraries"><span class="header-section-number">1.1</span> Load libraries</a></li>
  <li><a href="#load-custom-functions" id="toc-load-custom-functions" class="nav-link" data-scroll-target="#load-custom-functions"><span class="header-section-number">1.2</span> Load custom functions</a></li>
  <li><a href="#define-output-folder" id="toc-define-output-folder" class="nav-link" data-scroll-target="#define-output-folder"><span class="header-section-number">1.3</span> Define output folder</a></li>
  <li><a href="#load-the-data-and-inspect-the-phyloseq-object" id="toc-load-the-data-and-inspect-the-phyloseq-object" class="nav-link" data-scroll-target="#load-the-data-and-inspect-the-phyloseq-object"><span class="header-section-number">1.4</span> Load the data and inspect the phyloseq object</a></li>
  </ul></li>
  <li><a href="#data-structure" id="toc-data-structure" class="nav-link" data-scroll-target="#data-structure"><span class="header-section-number">2</span> Data Structure</a>
  <ul class="collapse">
  <li><a href="#composition-of-our-phyloseq-object-physeq" id="toc-composition-of-our-phyloseq-object-physeq" class="nav-link" data-scroll-target="#composition-of-our-phyloseq-object-physeq"><span class="header-section-number">2.1</span> Composition of our phyloseq object <code>physeq</code></a>
  <ul class="collapse">
  <li><a href="#an-asv-table-with-the-absolute-counts" id="toc-an-asv-table-with-the-absolute-counts" class="nav-link" data-scroll-target="#an-asv-table-with-the-absolute-counts"><span class="header-section-number">2.1.1</span> An ASV table with the absolute counts</a></li>
  <li><a href="#a-metadata-table-with-information-e.g.-physicochemical-categorical-variables-about-samples" id="toc-a-metadata-table-with-information-e.g.-physicochemical-categorical-variables-about-samples" class="nav-link" data-scroll-target="#a-metadata-table-with-information-e.g.-physicochemical-categorical-variables-about-samples"><span class="header-section-number">2.1.2</span> A metadata table with information (e.g.&nbsp;physicochemical, categorical variables) about samples</a></li>
  <li><a href="#a-table-of-taxonomic-classification-level-of-each-asv" id="toc-a-table-of-taxonomic-classification-level-of-each-asv" class="nav-link" data-scroll-target="#a-table-of-taxonomic-classification-level-of-each-asv"><span class="header-section-number">2.1.3</span> A table of taxonomic classification level of each ASV</a></li>
  <li><a href="#a-phylogenetic-tree" id="toc-a-phylogenetic-tree" class="nav-link" data-scroll-target="#a-phylogenetic-tree"><span class="header-section-number">2.1.4</span> A Phylogenetic tree</a></li>
  <li><a href="#a-table-with-the-asv-sequences" id="toc-a-table-with-the-asv-sequences" class="nav-link" data-scroll-target="#a-table-with-the-asv-sequences"><span class="header-section-number">2.1.5</span> A table with the ASV sequences</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#subsampling-normalization" id="toc-subsampling-normalization" class="nav-link" data-scroll-target="#subsampling-normalization"><span class="header-section-number">3</span> Subsampling normalization</a>
  <ul class="collapse">
  <li><a href="#rarefaction-curves" id="toc-rarefaction-curves" class="nav-link" data-scroll-target="#rarefaction-curves"><span class="header-section-number">3.1</span> Rarefaction Curves</a>
  <ul class="collapse">
  <li><a href="#identify-your-minimum-sample-size" id="toc-identify-your-minimum-sample-size" class="nav-link" data-scroll-target="#identify-your-minimum-sample-size"><span class="header-section-number">3.1.1</span> Identify your minimum sample size</a></li>
  <li><a href="#run-rarefaction-curves-using-our-custom-function-ggrare-defined-in-ralpha_diversity.r" id="toc-run-rarefaction-curves-using-our-custom-function-ggrare-defined-in-ralpha_diversity.r" class="nav-link" data-scroll-target="#run-rarefaction-curves-using-our-custom-function-ggrare-defined-in-ralpha_diversity.r"><span class="header-section-number">3.1.2</span> Run rarefaction curves using our custom function <code>ggrare()</code> (defined in <code>R/alpha_diversity.R</code>)</a></li>
  </ul></li>
  <li><a href="#normalization-process-for-alpha-diversity-sub-sampling" id="toc-normalization-process-for-alpha-diversity-sub-sampling" class="nav-link" data-scroll-target="#normalization-process-for-alpha-diversity-sub-sampling"><span class="header-section-number">3.2</span> Normalization process for alpha diversity: sub-sampling</a></li>
  <li><a href="#run-rarefaction-curves-on-normalized-data" id="toc-run-rarefaction-curves-on-normalized-data" class="nav-link" data-scroll-target="#run-rarefaction-curves-on-normalized-data"><span class="header-section-number">3.3</span> Run rarefaction curves on normalized data</a></li>
  <li><a href="#group-separation" id="toc-group-separation" class="nav-link" data-scroll-target="#group-separation"><span class="header-section-number">3.4</span> Group separation</a></li>
  <li><a href="#rank-abundance-curves" id="toc-rank-abundance-curves" class="nav-link" data-scroll-target="#rank-abundance-curves"><span class="header-section-number">3.5</span> Rank Abundance Curves</a></li>
  </ul></li>
  <li><a href="#iv-alpha-diversity" id="toc-iv-alpha-diversity" class="nav-link" data-scroll-target="#iv-alpha-diversity"><span class="header-section-number">4</span> IV-Alpha Diversity</a>
  <ul class="collapse">
  <li><a href="#indices" id="toc-indices" class="nav-link" data-scroll-target="#indices"><span class="header-section-number">4.1</span> Indices</a>
  <ul class="collapse">
  <li><a href="#get-taxonomy-based-diversity-indices" id="toc-get-taxonomy-based-diversity-indices" class="nav-link" data-scroll-target="#get-taxonomy-based-diversity-indices"><span class="header-section-number">4.1.1</span> Get taxonomy-based diversity indices</a></li>
  <li><a href="#add-the-alpha-indices-result-to-your-metadata-sample_data-phyloseq-object" id="toc-add-the-alpha-indices-result-to-your-metadata-sample_data-phyloseq-object" class="nav-link" data-scroll-target="#add-the-alpha-indices-result-to-your-metadata-sample_data-phyloseq-object"><span class="header-section-number">4.1.2</span> Add the alpha indices result to your metadata (sample_data) phyloseq object</a></li>
  <li><a href="#get-phylogeny-based-diversity-indices-get_nri_nti-function" id="toc-get-phylogeny-based-diversity-indices-get_nri_nti-function" class="nav-link" data-scroll-target="#get-phylogeny-based-diversity-indices-get_nri_nti-function"><span class="header-section-number">4.1.3</span> Get phylogeny based diversity indices: get_NRI_NTI function</a></li>
  <li><a href="#again-add-the-phylogenetic-indices-to-your-metadata-sample_data-phyloseq-object" id="toc-again-add-the-phylogenetic-indices-to-your-metadata-sample_data-phyloseq-object" class="nav-link" data-scroll-target="#again-add-the-phylogenetic-indices-to-your-metadata-sample_data-phyloseq-object"><span class="header-section-number">4.1.4</span> Again!!! Add the phylogenetic indices to your metadata (sample_data) phyloseq object</a></li>
  </ul></li>
  <li><a href="#alpha-diversity-representations" id="toc-alpha-diversity-representations" class="nav-link" data-scroll-target="#alpha-diversity-representations"><span class="header-section-number">4.2</span> Alpha diversity representations</a>
  <ul class="collapse">
  <li><a href="#alpha-representations-using-phyloseqplot_richness" id="toc-alpha-representations-using-phyloseqplot_richness" class="nav-link" data-scroll-target="#alpha-representations-using-phyloseqplot_richness"><span class="header-section-number">4.2.1</span> Alpha representations using phyloseq::plot_richness()</a></li>
  <li><a href="#color-by-group-color-geo-change-sample-name" id="toc-color-by-group-color-geo-change-sample-name" class="nav-link" data-scroll-target="#color-by-group-color-geo-change-sample-name"><span class="header-section-number">4.2.2</span> Color by group: <code>color = Geo</code> &amp; change sample name</a></li>
  <li><a href="#make-box_plot-by-adding-geom_boxplot-function" id="toc-make-box_plot-by-adding-geom_boxplot-function" class="nav-link" data-scroll-target="#make-box_plot-by-adding-geom_boxplot-function"><span class="header-section-number">4.2.3</span> Make box_plot by adding geom_boxplot function</a></li>
  <li><a href="#make-box_plot-geom_boxplot-fill-color-of-boxplot-fill-transparency-with-alpha" id="toc-make-box_plot-geom_boxplot-fill-color-of-boxplot-fill-transparency-with-alpha" class="nav-link" data-scroll-target="#make-box_plot-geom_boxplot-fill-color-of-boxplot-fill-transparency-with-alpha"><span class="header-section-number">4.2.4</span> Make box_plot : geom_boxplot + fill color of boxplot (fill) + transparency (with alpha)</a></li>
  <li><a href="#alpha-representations-using-microbiomeboxplot_alpha-not-shown" id="toc-alpha-representations-using-microbiomeboxplot_alpha-not-shown" class="nav-link" data-scroll-target="#alpha-representations-using-microbiomeboxplot_alpha-not-shown"><span class="header-section-number">4.2.5</span> Alpha representations using <code>Microbiome::boxplot_alpha</code> (not shown)</a></li>
  <li><a href="#alpha-representations-using-ggplot2" id="toc-alpha-representations-using-ggplot2" class="nav-link" data-scroll-target="#alpha-representations-using-ggplot2"><span class="header-section-number">4.2.6</span> Alpha representations using ggplot2</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#statistical-hypothesis-for-alpha-diversity" id="toc-statistical-hypothesis-for-alpha-diversity" class="nav-link" data-scroll-target="#statistical-hypothesis-for-alpha-diversity"><span class="header-section-number">5</span> Statistical hypothesis for alpha diversity</a>
  <ul class="collapse">
  <li><a href="#normality-test-check-the-normal-or-not-normal-distribution-of-your-data-to-choose-the-right-test" id="toc-normality-test-check-the-normal-or-not-normal-distribution-of-your-data-to-choose-the-right-test" class="nav-link" data-scroll-target="#normality-test-check-the-normal-or-not-normal-distribution-of-your-data-to-choose-the-right-test"><span class="header-section-number">5.0.1</span> Normality test: Check the Normal or not normal distribution of your data to choose the right test!</a></li>
  <li><a href="#select-indices-to-test-run-normality-check" id="toc-select-indices-to-test-run-normality-check" class="nav-link" data-scroll-target="#select-indices-to-test-run-normality-check"><span class="header-section-number">5.0.2</span> Select indices to test &amp; run normality check</a></li>
  <li><a href="#anova-parametric-follows-normal-distribution-and-at-least-3-groups" id="toc-anova-parametric-follows-normal-distribution-and-at-least-3-groups" class="nav-link" data-scroll-target="#anova-parametric-follows-normal-distribution-and-at-least-3-groups"><span class="header-section-number">5.1</span> ANOVA: parametric (follows normal distribution) AND at least 3 groups</a>
  <ul class="collapse">
  <li><a href="#alternative-to-bartlett-levene-test-package-car-less-sensitive-to-normality-deviation" id="toc-alternative-to-bartlett-levene-test-package-car-less-sensitive-to-normality-deviation" class="nav-link" data-scroll-target="#alternative-to-bartlett-levene-test-package-car-less-sensitive-to-normality-deviation"><span class="header-section-number">5.1.1</span> Alternative to Bartlett : Levene test (package <code>car</code>), less sensitive to normality deviation</a></li>
  </ul></li>
  <li><a href="#kruskal-wallis-non-parametric-at-least-three-groups" id="toc-kruskal-wallis-non-parametric-at-least-three-groups" class="nav-link" data-scroll-target="#kruskal-wallis-non-parametric-at-least-three-groups"><span class="header-section-number">5.2</span> Kruskal-Wallis: non-parametric &amp; at least three groups</a></li>
  <li><a href="#t-test-parametric-2-groups-i.e-north-vs.-sud" id="toc-t-test-parametric-2-groups-i.e-north-vs.-sud" class="nav-link" data-scroll-target="#t-test-parametric-2-groups-i.e-north-vs.-sud"><span class="header-section-number">5.3</span> T-test: parametric, 2 groups (<em>i.e</em> North Vs. Sud)</a></li>
  <li><a href="#wilcoxon-rank-sum-non-parametric-2-groups" id="toc-wilcoxon-rank-sum-non-parametric-2-groups" class="nav-link" data-scroll-target="#wilcoxon-rank-sum-non-parametric-2-groups"><span class="header-section-number">5.4</span> Wilcoxon rank sum: non-parametric &amp; 2 Groups</a>
  <ul class="collapse">
  <li><a href="#boxplot-representation-with-p-value-information" id="toc-boxplot-representation-with-p-value-information" class="nav-link" data-scroll-target="#boxplot-representation-with-p-value-information"><span class="header-section-number">5.4.1</span> Boxplot representation with p-value information</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#correlation-linear-regression" id="toc-correlation-linear-regression" class="nav-link" data-scroll-target="#correlation-linear-regression"><span class="header-section-number">6</span> Correlation &amp; linear Regression</a>
  <ul class="collapse">
  <li><a href="#correlation-analysis" id="toc-correlation-analysis" class="nav-link" data-scroll-target="#correlation-analysis"><span class="header-section-number">6.1</span> Correlation analysis</a>
  <ul class="collapse">
  <li><a href="#select-variables" id="toc-select-variables" class="nav-link" data-scroll-target="#select-variables"><span class="header-section-number">6.1.1</span> Select variables</a></li>
  <li><a href="#apply-the-method" id="toc-apply-the-method" class="nav-link" data-scroll-target="#apply-the-method"><span class="header-section-number">6.1.2</span> Apply the method</a></li>
  <li><a href="#plot-results-corrplot-function" id="toc-plot-results-corrplot-function" class="nav-link" data-scroll-target="#plot-results-corrplot-function"><span class="header-section-number">6.1.3</span> Plot results: corrplot function</a></li>
  <li><a href="#is-the-correlation-is-due-to-chance-significance-test" id="toc-is-the-correlation-is-due-to-chance-significance-test" class="nav-link" data-scroll-target="#is-the-correlation-is-due-to-chance-significance-test"><span class="header-section-number">6.1.4</span> Is the correlation is due to chance? Significance test!</a></li>
  <li><a href="#show-only-correlations-with-significant-p-values" id="toc-show-only-correlations-with-significant-p-values" class="nav-link" data-scroll-target="#show-only-correlations-with-significant-p-values"><span class="header-section-number">6.1.5</span> Show only correlations with significant p-values</a></li>
  </ul></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression"><span class="header-section-number">6.2</span> Linear regression</a>
  <ul class="collapse">
  <li><a href="#shannon-observed" id="toc-shannon-observed" class="nav-link" data-scroll-target="#shannon-observed"><span class="header-section-number">6.2.1</span> Shannon ~ Observed</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#taxonomy-barplot-graph" id="toc-taxonomy-barplot-graph" class="nav-link" data-scroll-target="#taxonomy-barplot-graph"><span class="header-section-number">7</span> Taxonomy: barplot graph</a>
  <ul class="collapse">
  <li><a href="#abundance-transformation" id="toc-abundance-transformation" class="nav-link" data-scroll-target="#abundance-transformation"><span class="header-section-number">7.1</span> Abundance Transformation</a>
  <ul class="collapse">
  <li><a href="#counts-in-percentage-using-phyloseqtransform_sample_counts" id="toc-counts-in-percentage-using-phyloseqtransform_sample_counts" class="nav-link" data-scroll-target="#counts-in-percentage-using-phyloseqtransform_sample_counts"><span class="header-section-number">7.1.1</span> Counts in percentage using <code>phyloseq::transform_sample_counts()</code></a></li>
  <li><a href="#summarise-at-a-given-taxonomic-level-with-phyloseqtax_glom" id="toc-summarise-at-a-given-taxonomic-level-with-phyloseqtax_glom" class="nav-link" data-scroll-target="#summarise-at-a-given-taxonomic-level-with-phyloseqtax_glom"><span class="header-section-number">7.1.2</span> Summarise at a given taxonomic level with <code>phyloseq::tax_glom()</code></a></li>
  <li><a href="#filter-phylum-mean-of-the-line-phyloseqfilter_taxa" id="toc-filter-phylum-mean-of-the-line-phyloseqfilter_taxa" class="nav-link" data-scroll-target="#filter-phylum-mean-of-the-line-phyloseqfilter_taxa"><span class="header-section-number">7.1.3</span> Filter phylum (mean of the line): <code>phyloseq::filter_taxa()</code></a></li>
  <li><a href="#how-to-save-a-table-into-a-file-exemple-of-phylum-taxonomic-table" id="toc-how-to-save-a-table-into-a-file-exemple-of-phylum-taxonomic-table" class="nav-link" data-scroll-target="#how-to-save-a-table-into-a-file-exemple-of-phylum-taxonomic-table"><span class="header-section-number">7.1.4</span> How to save a table into a file: exemple of phylum taxonomic table</a></li>
  <li><a href="#remove-black-lines" id="toc-remove-black-lines" class="nav-link" data-scroll-target="#remove-black-lines"><span class="header-section-number">7.1.5</span> Remove black lines</a></li>
  </ul></li>
  <li><a href="#microbiome-package" id="toc-microbiome-package" class="nav-link" data-scroll-target="#microbiome-package"><span class="header-section-number">7.2</span> Microbiome package</a>
  <ul class="collapse">
  <li><a href="#microbiomeaggregate_taxa" id="toc-microbiomeaggregate_taxa" class="nav-link" data-scroll-target="#microbiomeaggregate_taxa"><span class="header-section-number">7.2.1</span> <code>microbiome::aggregate_taxa()</code></a></li>
  <li><a href="#microbiomeplot_composition" id="toc-microbiomeplot_composition" class="nav-link" data-scroll-target="#microbiomeplot_composition"><span class="header-section-number">7.2.2</span> <code>microbiome::plot_composition()</code></a></li>
  <li><a href="#interactive-barplot-with-plotlyggplotly" id="toc-interactive-barplot-with-plotlyggplotly" class="nav-link" data-scroll-target="#interactive-barplot-with-plotlyggplotly"><span class="header-section-number">7.2.3</span> Interactive barplot with <code>plotly::ggplotly()</code></a></li>
  <li><a href="#how-to-manage-colors-in-barplots" id="toc-how-to-manage-colors-in-barplots" class="nav-link" data-scroll-target="#how-to-manage-colors-in-barplots"><span class="header-section-number">7.2.4</span> How to manage colors in barplots</a></li>
  <li><a href="#build-your-own-palette" id="toc-build-your-own-palette" class="nav-link" data-scroll-target="#build-your-own-palette"><span class="header-section-number">7.2.5</span> Build your own palette</a></li>
  <li><a href="#use-your-palette-in-the-p_order-barplot" id="toc-use-your-palette-in-the-p_order-barplot" class="nav-link" data-scroll-target="#use-your-palette-in-the-p_order-barplot"><span class="header-section-number">7.2.6</span> Use your palette in the p_order barplot</a></li>
  </ul></li>
  <li><a href="#other-data-manipulation-select-specific-taxa-merge-samples" id="toc-other-data-manipulation-select-specific-taxa-merge-samples" class="nav-link" data-scroll-target="#other-data-manipulation-select-specific-taxa-merge-samples"><span class="header-section-number">7.3</span> Other data Manipulation : select specific taxa, merge samples</a>
  <ul class="collapse">
  <li><a href="#select-actinobacteria-and-bacteroidetes-phyloseqsubset_taxa" id="toc-select-actinobacteria-and-bacteroidetes-phyloseqsubset_taxa" class="nav-link" data-scroll-target="#select-actinobacteria-and-bacteroidetes-phyloseqsubset_taxa"><span class="header-section-number">7.3.1</span> Select Actinobacteria AND Bacteroidetes: <code>phyloseq::subset_taxa()</code></a></li>
  <li><a href="#keep-all-with-the-exception-of-a-class-a-genus-etc-e.g.-contamination" id="toc-keep-all-with-the-exception-of-a-class-a-genus-etc-e.g.-contamination" class="nav-link" data-scroll-target="#keep-all-with-the-exception-of-a-class-a-genus-etc-e.g.-contamination"><span class="header-section-number">7.3.2</span> Keep all with the exception of a class, a genus etc (e.g.&nbsp;contamination)</a></li>
  <li><a href="#understand" id="toc-understand" class="nav-link" data-scroll-target="#understand"><span class="header-section-number">7.3.3</span> Understand:</a></li>
  <li><a href="#merge-samples-groups-duplicates-etc" id="toc-merge-samples-groups-duplicates-etc" class="nav-link" data-scroll-target="#merge-samples-groups-duplicates-etc"><span class="header-section-number">7.3.4</span> Merge samples (groups, duplicates etc)</a></li>
  <li><a href="#sample-selection-phyloseqsubset_samples" id="toc-sample-selection-phyloseqsubset_samples" class="nav-link" data-scroll-target="#sample-selection-phyloseqsubset_samples"><span class="header-section-number">7.3.5</span> Sample selection: <code>phyloseq::subset_samples()</code></a></li>
  <li><a href="#alternative-way-phyloseqprune_samples" id="toc-alternative-way-phyloseqprune_samples" class="nav-link" data-scroll-target="#alternative-way-phyloseqprune_samples"><span class="header-section-number">7.3.6</span> Alternative way: <code>phyloseq::prune_samples</code></a></li>
  </ul></li>
  <li><a href="#retrieve-sequences-from-a-phyloseq-object" id="toc-retrieve-sequences-from-a-phyloseq-object" class="nav-link" data-scroll-target="#retrieve-sequences-from-a-phyloseq-object"><span class="header-section-number">7.4</span> Retrieve sequences from a phyloseq object</a>
  <ul class="collapse">
  <li><a href="#one-sequence" id="toc-one-sequence" class="nav-link" data-scroll-target="#one-sequence"><span class="header-section-number">7.4.1</span> One sequence:</a></li>
  <li><a href="#by-name" id="toc-by-name" class="nav-link" data-scroll-target="#by-name"><span class="header-section-number">7.4.2</span> By name</a></li>
  <li><a href="#from-a-selection" id="toc-from-a-selection" class="nav-link" data-scroll-target="#from-a-selection"><span class="header-section-number">7.4.3</span> From a selection</a></li>
  <li><a href="#retrieve-all-sequences" id="toc-retrieve-all-sequences" class="nav-link" data-scroll-target="#retrieve-all-sequences"><span class="header-section-number">7.4.4</span> Retrieve all sequences</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#core-microbiota-analysis" id="toc-core-microbiota-analysis" class="nav-link" data-scroll-target="#core-microbiota-analysis"><span class="header-section-number">8</span> Core microbiota analysis</a>
  <ul class="collapse">
  <li><a href="#which-core-compare-north-south-core-microbiota" id="toc-which-core-compare-north-south-core-microbiota" class="nav-link" data-scroll-target="#which-core-compare-north-south-core-microbiota"><span class="header-section-number">8.0.1</span> Which core? Compare North &amp; South core microbiota</a></li>
  <li><a href="#change-first-column-name-of-taxonomy-rank" id="toc-change-first-column-name-of-taxonomy-rank" class="nav-link" data-scroll-target="#change-first-column-name-of-taxonomy-rank"><span class="header-section-number">8.0.2</span> Change first column name of taxonomy rank</a></li>
  <li><a href="#add-the-lowest-taxonomy-classification" id="toc-add-the-lowest-taxonomy-classification" class="nav-link" data-scroll-target="#add-the-lowest-taxonomy-classification"><span class="header-section-number">8.0.3</span> Add the lowest taxonomy classification</a></li>
  <li><a href="#see-the-transformation-of-tax_table" id="toc-see-the-transformation-of-tax_table" class="nav-link" data-scroll-target="#see-the-transformation-of-tax_table"><span class="header-section-number">8.0.4</span> See the transformation of tax_table</a></li>
  <li><a href="#identify-core-microbiota" id="toc-identify-core-microbiota" class="nav-link" data-scroll-target="#identify-core-microbiota"><span class="header-section-number">8.0.5</span> Identify Core microbiota</a></li>
  <li><a href="#get-core-microbiota-phyloseq-object" id="toc-get-core-microbiota-phyloseq-object" class="nav-link" data-scroll-target="#get-core-microbiota-phyloseq-object"><span class="header-section-number">8.0.6</span> Get core microbiota phyloseq object</a></li>
  <li><a href="#visualise-core-microbiome-with-microbiomeplot_core" id="toc-visualise-core-microbiome-with-microbiomeplot_core" class="nav-link" data-scroll-target="#visualise-core-microbiome-with-microbiomeplot_core"><span class="header-section-number">8.0.7</span> Visualise core microbiome with <code>microbiome::plot_core()</code></a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/ANF-MetaBioDiv/course-material/edit/main/practicals/alpha_diversity.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/ANF-MetaBioDiv/course-material/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">PARTII_alpha_Diversity_ANF</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Fabrice Armougom, MIO </p>
             <p>Marc Garel, MIO </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>

<section id="prepare-workspace" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Prepare workspace</h1>
<section id="load-libraries" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="load-libraries"><span class="header-section-number">1.1</span> Load libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phyloseq)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-custom-functions" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="load-custom-functions"><span class="header-section-number">1.2</span> Load custom functions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="define-output-folder" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="define-output-folder"><span class="header-section-number">1.3</span> Define output folder</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>output_alpha <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"outputs"</span>, <span class="st">"alpha_diversity"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(output_alpha)) <span class="fu">dir.create</span>(output_alpha)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-the-data-and-inspect-the-phyloseq-object" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="load-the-data-and-inspect-the-phyloseq-object"><span class="header-section-number">1.4</span> Load the data and inspect the phyloseq object</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>physeq <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"asv_table"</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"phyloseq_object_alpha_beta_div.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-structure" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Data Structure</h1>
<ul>
<li><strong><span style="color: steelblue;"><font size="5"> Phyloseq object </font></span></strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>physeq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 213 taxa and 18 samples ]
sample_data() Sample Data:       [ 18 samples by 21 sample variables ]
tax_table()   Taxonomy Table:    [ 213 taxa by 7 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 213 tips and 212 internal nodes ]
refseq()      DNAStringSet:      [ 213 reference sequences ]</code></pre>
</div>
</div>
<section id="composition-of-our-phyloseq-object-physeq" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="composition-of-our-phyloseq-object-physeq"><span class="header-section-number">2.1</span> Composition of our phyloseq object <code>physeq</code></h2>
<section id="an-asv-table-with-the-absolute-counts" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="an-asv-table-with-the-absolute-counts"><span class="header-section-number">2.1.1</span> An ASV table with the absolute counts</h3>
<p>Be careful: Rows are samples, columns are ASVs</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>physeq<span class="sc">@</span>otu_table[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OTU Table:          [10 taxa and 10 samples]
                     taxa are columns
     ASV1 ASV2 ASV3 ASV4 ASV5 ASV6 ASV7 ASV8 ASV9 ASV10
S11B  117   25   85   70   87   40   57   34   41     0
S1B    67    0   23    0   51   48    0    0   27    58
S2B    43    0   35   15   42   52    0    0    0    43
S2S   103   87   76   12   99   43   36   72   46     0
S3B    59    0   32    0   49   73    0    0    0    57
S3S    81   10    0   20   36    0    0    0    0    50
S4B    11    6   38   33   43   46    0    8    0    37
S4S    68    6   38    0   62    0    0   11   30    46
S5B   176   18   62  109    0   35   56   13   33    82
S5S   182    0   36  101   51    0   33    0   29    42</code></pre>
</div>
</div>
</section>
<section id="a-metadata-table-with-information-e.g.-physicochemical-categorical-variables-about-samples" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="a-metadata-table-with-information-e.g.-physicochemical-categorical-variables-about-samples"><span class="header-section-number">2.1.2</span> A metadata table with information (e.g.&nbsp;physicochemical, categorical variables) about samples</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>physeq<span class="sc">@</span>sam_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     SampName   Geo Description groupe Pres PicoEuk Synec Prochloro NanoEuk
S11B     S11B South     South5B    SGF   35    5370 46830       580    6010
S1B       S1B North     North1B    NBF   52     660 32195     10675     955
S2B       S2B North     North2B    NBF   59     890 25480     16595     670
S2S       S2S North     North2S    NBS    0     890 25480     16595     670
S3B       S3B North     North3B    NBF   74     835 13340     25115    1115
S3S       S3S North     North3S    NBS    0     715 26725     16860     890
S4B       S4B North     North4B    NBF   78    2220  3130     29835    2120
S4S       S4S North     North4S    NBS   78    2220  3130     29835    2120
S5B       S5B North     North5B    NBF   42    1620 55780     23795    2555
S5S       S5S North     North5S    NBS    0    1620 56555     22835    2560
S6B       S6B South     South1B    SGF   13    2520 39050       705    3630
S6S       S6S South     South1S    SGS    0    2435 35890       915    3735
S7B       S7B South     South2B    SGF   26       0     0         0    4005
S7S       S7S South     South2S    SGS    0    4535 26545      1340    6585
S8B       S8B South     South3B    SGF   33       0     0         0    5910
S8S       S8S South     South3S    SGS    0    4260 36745       985    5470
S9B       S9B South     South4B    SGF   25    4000 31730       485    4395
S9S       S9S South     South4S    SGS    0    5465 32860       820    5045
     Crypto SiOH4   NO2   NO3   NH4   PO4    NT    PT   Chla       T       S
S11B   1690 3.324 0.083 0.756 0.467 0.115 9.539 4.138 0.0182 23.0308 38.9967
S1B     115 1.813 0.256 0.889 0.324 0.132 9.946 3.565 0.0000 22.7338 37.6204
S2B     395 2.592 0.105 1.125 0.328 0.067 9.378 3.391 0.0000 22.6824 37.6627
S2S     395 3.381 0.231 0.706 0.450 0.109 8.817 3.345 0.0000 22.6854 37.6176
S3B     165 1.438 0.057 1.159 0.369 0.174 8.989 2.568 0.0000 21.5296 37.5549
S3S     200 1.656 0.098 0.794 0.367 0.095 7.847 2.520 0.0000 22.5610 37.5960
S4B     235 2.457 0.099 1.087 0.349 0.137 8.689 3.129 0.0000 18.8515 37.4542
S4S     235 2.457 0.099 1.087 0.349 0.137 8.689 3.129 0.0000 18.8515 37.4542
S5B    1355 2.028 0.103 1.135 0.216 0.128 8.623 3.137 0.0102 24.1905 38.3192
S5S     945 2.669 0.136 0.785 0.267 0.114 9.146 3.062 0.0000 24.1789 38.3213
S6B    1295 2.206 0.249 0.768 0.629 0.236 9.013 3.455 0.0000 22.0197 39.0877
S6S    1300 3.004 0.251 0.927 0.653 0.266 8.776 3.230 0.0134 22.0515 39.0884
S7B    1600 3.016 0.157 0.895 0.491 0.176 8.968 4.116 0.0000 23.6669 38.9699
S7S    1355 1.198 0.165 1.099 0.432 0.180 8.256 3.182 0.0000 23.6814 38.9708
S8B    1590 3.868 0.253 0.567 0.533 0.169 8.395 3.126 0.0000 23.1236 39.0054
S8S    2265 3.639 0.255 0.658 0.665 0.247 8.991 3.843 0.0132 23.3147 38.9885
S9B    1180 3.910 0.107 0.672 0.490 0.134 8.954 4.042 0.0172 22.6306 38.9094
S9S    1545 3.607 0.139 0.644 0.373 0.167 9.817 3.689 0.0062 22.9545 38.7777
     Sigma_t
S11B 26.9631
S1B  26.0046
S2B  26.0521
S2S  26.0137
S3B  26.2987
S3S  26.0332
S4B  26.9415
S4S  26.9415
S5B  26.1037
S5S  26.1065
S6B  27.3241
S6S  27.3151
S7B  26.7536
S7S  26.7488
S8B  26.9423
S8S  26.8713
S9B  27.0131
S9S  26.8172</code></pre>
</div>
</div>
</section>
<section id="a-table-of-taxonomic-classification-level-of-each-asv" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="a-table-of-taxonomic-classification-level-of-each-asv"><span class="header-section-number">2.1.3</span> A table of taxonomic classification level of each ASV</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>physeq<span class="sc">@</span>tax_table[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Taxonomy Table:     [10 taxa by 7 taxonomic ranks]:
      Kingdom    Phylum             Class                 Order             
ASV1  "Bacteria" "Cyanobacteria"    "Cyanobacteriia"      "Synechococcales" 
ASV2  "Bacteria" "Proteobacteria"   "Gammaproteobacteria" "Enterobacterales"
ASV3  "Bacteria" "Proteobacteria"   "Alphaproteobacteria" "SAR11 clade"     
ASV4  "Archaea"  "Thermoplasmatota" "Thermoplasmata"      "Marine Group II" 
ASV5  "Bacteria" "Proteobacteria"   "Alphaproteobacteria" "SAR11 clade"     
ASV6  "Bacteria" "Proteobacteria"   "Alphaproteobacteria" "SAR11 clade"     
ASV7  "Bacteria" "Proteobacteria"   "Alphaproteobacteria" "Rhodospirillales"
ASV8  "Bacteria" "Proteobacteria"   "Gammaproteobacteria" "Enterobacterales"
ASV9  "Bacteria" "Proteobacteria"   "Alphaproteobacteria" "SAR11 clade"     
ASV10 "Bacteria" "Proteobacteria"   "Alphaproteobacteria" "SAR11 clade"     
      Family                    Genus                  Species
ASV1  "Cyanobiaceae"            "Synechococcus CC9902" NA     
ASV2  "Pseudoalteromonadaceae"  "Pseudoalteromonas"    NA     
ASV3  "Clade I"                 "Clade Ia"             NA     
ASV4  NA                        NA                     NA     
ASV5  "Clade I"                 "Clade Ia"             NA     
ASV6  "Clade II"                NA                     NA     
ASV7  "AEGEAN-169 marine group" NA                     NA     
ASV8  "Pseudoalteromonadaceae"  "Pseudoalteromonas"    NA     
ASV9  "Clade I"                 "Clade Ia"             NA     
ASV10 "Clade I"                 "Clade Ia"             NA     </code></pre>
</div>
</div>
</section>
<section id="a-phylogenetic-tree" class="level3" data-number="2.1.4">
<h3 data-number="2.1.4" class="anchored" data-anchor-id="a-phylogenetic-tree"><span class="header-section-number">2.1.4</span> A Phylogenetic tree</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>physeq<span class="sc">@</span>phy_tree</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Phylogenetic tree with 213 tips and 212 internal nodes.

Tip labels:
  ASV1, ASV2, ASV3, ASV4, ASV5, ASV6, ...

Rooted; includes branch lengths.</code></pre>
</div>
</div>
</section>
<section id="a-table-with-the-asv-sequences" class="level3" data-number="2.1.5">
<h3 data-number="2.1.5" class="anchored" data-anchor-id="a-table-with-the-asv-sequences"><span class="header-section-number">2.1.5</span> A table with the ASV sequences</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>physeq<span class="sc">@</span>refseq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DNAStringSet object of length 213:
      width seq                                             names               
  [1]   402 GGAATTTTCCGCAATGGGCGAA...CGAAAGCCAGGGGAGCGAAAGG ASV1
  [2]   425 GGAATATTGCACAATGGGCGCA...CGAAAGCGTGGGGAGCAAACAG ASV2
  [3]   400 GGAATCTTGCACAATGGAGGAA...CGAAAGCATGGGTAGCGAAGAG ASV3
  [4]   383 CGAAAACTTGACAATGCGAGCA...CGAAGCCTAGGGGCACGAACCG ASV4
  [5]   400 GGAATCTTGCACAATGGAGGAA...CGAAAGCATGGGTAGCGAAGAG ASV5
  ...   ... ...
[209]   426 GGAATTTTGCGCAATGGACGAA...CGAAAGCGTGGGGAGCGAACAG ASV209
[210]   403 GGAATATTGCACAATGGGCGCA...GGTCAACACTGACGCTCATGTA ASV210
[211]   360 CGAAAACTTCACACTGCAGGAA...GAACGGATCCGACGGTCAGGGA ASV211
[212]   400 GGAATATTGGACAATGGGCGAA...CGAAAGCGTGGGTAGCAAACAG ASV212
[213]   404 GGAATATTGCACAATGGGCGCA...GTCAACACTGACGCTCATGTAC ASV213</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="subsampling-normalization" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Subsampling normalization</h1>
<section id="rarefaction-curves" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="rarefaction-curves"><span class="header-section-number">3.1</span> Rarefaction Curves</h2>
<p>Before normalization by sub-sampling, lets have a look at rarefaction curves, evaluate your sequencing effort and make decisions</p>
<section id="identify-your-minimum-sample-size" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="identify-your-minimum-sample-size"><span class="header-section-number">3.1.1</span> Identify your minimum sample size</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">sample_sums</span>(physeq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>S11B  S1B  S2B  S2S  S3B  S3S  S4B  S4S  S5B  S5S  S6B  S6S  S7B  S7S  S8B  S8S 
 975  837  893  983  878  889  917 1077 1018 1006 1076  937  878  936  846  958 
 S9B  S9S 
 888  991 </code></pre>
</div>
</div>
<p><strong>What is the minimum sample size?</strong></p>
</section>
<section id="run-rarefaction-curves-using-our-custom-function-ggrare-defined-in-ralpha_diversity.r" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="run-rarefaction-curves-using-our-custom-function-ggrare-defined-in-ralpha_diversity.r"><span class="header-section-number">3.1.2</span> Run rarefaction curves using our custom function <code>ggrare()</code> (defined in <code>R/alpha_diversity.R</code>)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Make rarefaction curves &amp; Add min sample size line</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggrare</span>(physeq, <span class="at">step =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"Description"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">min</span>(<span class="fu">sample_sums</span>(physeq)), <span class="at">color =</span> <span class="st">"gray60"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in vegan::rarefy(x[i, , drop = FALSE], n, se = se): most observed count
data have counts 1, but smallest count is 2

Warning in vegan::rarefy(x[i, , drop = FALSE], n, se = se): most observed count
data have counts 1, but smallest count is 2

Warning in vegan::rarefy(x[i, , drop = FALSE], n, se = se): most observed count
data have counts 1, but smallest count is 2

Warning in vegan::rarefy(x[i, , drop = FALSE], n, se = se): most observed count
data have counts 1, but smallest count is 2

Warning in vegan::rarefy(x[i, , drop = FALSE], n, se = se): most observed count
data have counts 1, but smallest count is 2

Warning in vegan::rarefy(x[i, , drop = FALSE], n, se = se): most observed count
data have counts 1, but smallest count is 2

Warning in vegan::rarefy(x[i, , drop = FALSE], n, se = se): most observed count
data have counts 1, but smallest count is 2

Warning in vegan::rarefy(x[i, , drop = FALSE], n, se = se): most observed count
data have counts 1, but smallest count is 2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in vegan::rarefy(x[i, , drop = FALSE], n, se = se): most observed count
data have counts 1, but smallest count is 4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in vegan::rarefy(x[i, , drop = FALSE], n, se = se): most observed count
data have counts 1, but smallest count is 3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in vegan::rarefy(x[i, , drop = FALSE], n, se = se): most observed count
data have counts 1, but smallest count is 2

Warning in vegan::rarefy(x[i, , drop = FALSE], n, se = se): most observed count
data have counts 1, but smallest count is 2

Warning in vegan::rarefy(x[i, , drop = FALSE], n, se = se): most observed count
data have counts 1, but smallest count is 2

Warning in vegan::rarefy(x[i, , drop = FALSE], n, se = se): most observed count
data have counts 1, but smallest count is 2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in vegan::rarefy(x[i, , drop = FALSE], n, se = se): most observed count
data have counts 1, but smallest count is 4

Warning in vegan::rarefy(x[i, , drop = FALSE], n, se = se): most observed count
data have counts 1, but smallest count is 4</code></pre>
</div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Do you think is a good idea to normalize your data using this minimal sample size?</strong></p>
</section>
</section>
<section id="normalization-process-for-alpha-diversity-sub-sampling" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="normalization-process-for-alpha-diversity-sub-sampling"><span class="header-section-number">3.2</span> Normalization process for alpha diversity: sub-sampling</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>physeq_rar <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">rarefy_even_depth</span>(physeq, <span class="at">rngseed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Check the number of sequences for each sample using sample_sums function</strong></p>
<p><strong>Did you lost a lot of ASVs?</strong></p>
</section>
<section id="run-rarefaction-curves-on-normalized-data" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="run-rarefaction-curves-on-normalized-data"><span class="header-section-number">3.3</span> Run rarefaction curves on normalized data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fu">ggrare</span>(physeq_rar, <span class="at">step =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"Description"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in vegan::rarefy(x[i, , drop = FALSE], n, se = se): most observed count
data have counts 1, but smallest count is 2

Warning in vegan::rarefy(x[i, , drop = FALSE], n, se = se): most observed count
data have counts 1, but smallest count is 2

Warning in vegan::rarefy(x[i, , drop = FALSE], n, se = se): most observed count
data have counts 1, but smallest count is 2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in vegan::rarefy(x[i, , drop = FALSE], n, se = se): most observed count
data have counts 1, but smallest count is 3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in vegan::rarefy(x[i, , drop = FALSE], n, se = se): most observed count
data have counts 1, but smallest count is 4</code></pre>
</div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="group-separation" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="group-separation"><span class="header-section-number">3.4</span> Group separation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>p0 <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Geo, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="rank-abundance-curves" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="rank-abundance-curves"><span class="header-section-number">3.5</span> Rank Abundance Curves</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>tableASV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(phyloseq<span class="sc">::</span><span class="fu">otu_table</span>(physeq_rar))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>metadonnees <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(physeq_rar<span class="sc">@</span>sam_data)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>metadonnees<span class="sc">$</span>Geo <span class="ot">&lt;-</span> <span class="fu">factor</span>(metadonnees<span class="sc">$</span>Geo)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>ab_ranktab <span class="ot">&lt;-</span> <span class="fu">rankabuncomp</span>(tableASV, <span class="at">y=</span>metadonnees, <span class="at">factor=</span><span class="st">'Geo'</span>,<span class="at">scale=</span><span class="st">'logabun'</span>, <span class="at">legend=</span><span class="st">"topright"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="iv-alpha-diversity" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> IV-Alpha Diversity</h1>
<section id="indices" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="indices"><span class="header-section-number">4.1</span> Indices</h2>
<section id="get-taxonomy-based-diversity-indices" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="get-taxonomy-based-diversity-indices"><span class="header-section-number">4.1.1</span> Get taxonomy-based diversity indices</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Get indices with alpha function (NB: index="all" if you want all the indices)</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>alpha_indices <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">alpha</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  physeq_rar,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"observed"</span>, <span class="st">"diversity_gini_simpson"</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>          <span class="st">"diversity_shannon"</span>, <span class="st">"evenness_pielou"</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>          <span class="st">"dominance_relative"</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co">#save</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(alpha_indices,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">file =</span> <span class="fu">file.path</span>(output_alpha, <span class="st">"indices_alpha_resultat.txt"</span>),</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="co">#which type?</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(alpha_indices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data.frame"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>alpha_indices</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     observed diversity_gini_simpson diversity_shannon evenness_pielou
S11B       36             0.94478631         3.1464802      0.87804201
S1B        35             0.94779244         3.1777661      0.89379888
S2B        43             0.95777575         3.4080222      0.90609969
S2S        36             0.94145759         3.1120657      0.86843848
S3B        41             0.95039889         3.2759058      0.88214412
S3S        38             0.94913135         3.2468023      0.89257055
S4B        40             0.95702493         3.3506939      0.90832296
S4S        40             0.93634460         3.0974738      0.83967878
S5B        32             0.92715778         2.9785407      0.85942517
S5S        33             0.92532499         2.9933406      0.85609441
S6B        41             0.94395556         3.2135081      0.86534151
S6S        28             0.82478100         2.4409713      0.73253948
S7B        36             0.94359014         3.1577021      0.88117355
S7S        44             0.94887441         3.2782965      0.86631400
S8B        33             0.94521168         3.1084743      0.88902263
S8S        39             0.95175779         3.3076444      0.90284939
S9B        36             0.94430384         3.1059084      0.86672024
S9S        33             0.94875451         3.1803927      0.90959124
     dominance_relative
S11B        0.102747909
S1B         0.102747909
S2B         0.096774194
S2S         0.109916368
S3B         0.109916368
S3S         0.109916368
S4B         0.087216249
S4S         0.143369176
S5B         0.166069295
S5S         0.188769415
S6B         0.136200717
S6S         0.383512545
S7B         0.130227001
S7S         0.106332139
S8B         0.094384707
S8S         0.096774194
S9B         0.094384707
S9S         0.103942652</code></pre>
</div>
</div>
<p><strong>What can you notice for one sample?</strong></p>
<p><strong>How to show this graphically?</strong></p>
</section>
<section id="add-the-alpha-indices-result-to-your-metadata-sample_data-phyloseq-object" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="add-the-alpha-indices-result-to-your-metadata-sample_data-phyloseq-object"><span class="header-section-number">4.1.2</span> Add the alpha indices result to your metadata (sample_data) phyloseq object</h3>
<p>Important because many times you will probably want to add new variables in the phyloseq class object!!!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Turn into sample_data object : sample_data function</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>alpha_indices <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">sample_data</span>(alpha_indices)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co">#See</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(alpha_indices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sample_data"
attr(,"package")
[1] "phyloseq"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Add alpha_indices to phyloseq sample_data object: merge_phyloseq function!</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>physeq_rar <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">merge_phyloseq</span>(physeq_rar, alpha_indices)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co">#See the result</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_data</span>(physeq_rar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="get-phylogeny-based-diversity-indices-get_nri_nti-function" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="get-phylogeny-based-diversity-indices-get_nri_nti-function"><span class="header-section-number">4.1.3</span> Get phylogeny based diversity indices: get_NRI_NTI function</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CalculateNRI,NTI,PD...: get_NRI_NTI function</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>ind_comp <span class="ot">&lt;-</span> MicrobiotaProcess<span class="sc">::</span><span class="fu">get_NRI_NTI</span>(physeq_rar,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">abundance.weighted =</span> <span class="cn">FALSE</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">metric =</span> <span class="st">"all"</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Retrieve only those of interest :select function, results are in ind_comp@alpha</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>indi_comp <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ind_comp<span class="sc">@</span>alpha)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>NRI_NTI_PB <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(indi_comp, NRI<span class="sc">:</span>PD)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>NRI_NTI_PB</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              NRI            NTI        PD
S11B -1.700640519 -1.73488080003 3.5323774
S1B   1.176239678 -0.76340361000 3.3155461
S2B  -0.261257404 -0.66474586424 3.6970066
S2S  -2.455150637 -0.74180248862 3.4222234
S3B   0.620451099 -1.29874536798 3.6834814
S3S  -0.141085299 -0.73453694988 3.4403182
S4B  -0.485562292  0.00455541779 3.3171476
S4S   1.773462103 -0.91361917079 3.4365770
S5B   0.156984003  0.13152798473 2.9592082
S5S  -0.134251689  1.89245043841 2.4738611
S6B   0.218507592  1.08807022489 3.1227876
S6S   2.631228189  0.00037617274 2.4229824
S7B  -1.470358724 -0.63713654961 3.1692736
S7S  -2.518357417  0.70828292578 3.4530890
S8B  -0.091630593  0.74473762595 2.9358002
S8S  -1.205969382  0.44642821613 3.3017637
S9B  -0.073949264  0.31007463902 2.8807192
S9S   0.443035146  2.45614696757 2.4373593</code></pre>
</div>
</div>
</section>
<section id="again-add-the-phylogenetic-indices-to-your-metadata-sample_data-phyloseq-object" class="level3" data-number="4.1.4">
<h3 data-number="4.1.4" class="anchored" data-anchor-id="again-add-the-phylogenetic-indices-to-your-metadata-sample_data-phyloseq-object"><span class="header-section-number">4.1.4</span> Again!!! Add the phylogenetic indices to your metadata (sample_data) phyloseq object</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Turn into sample_data object : sample_data function</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>NRI_NTI_PB <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">sample_data</span>(NRI_NTI_PB)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Add alpha_indices to phyloseq sample_data object: merge_phyloseq function!</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>physeq_rar <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">merge_phyloseq</span>(physeq_rar, NRI_NTI_PB)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co">#See the result with all the indices included</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_data</span>(physeq_rar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Can you give me one of the most diversified sample based on Simpson/Shannon/Richness/Pielou/PD values observed?</strong></p>
</section>
</section>
<section id="alpha-diversity-representations" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="alpha-diversity-representations"><span class="header-section-number">4.2</span> Alpha diversity representations</h2>
<p><em>This section will show you how to plot by different ways the alpha diversity and its customization.</em> <em>Understand how it works!</em></p>
<section id="alpha-representations-using-phyloseqplot_richness" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="alpha-representations-using-phyloseqplot_richness"><span class="header-section-number">4.2.1</span> Alpha representations using phyloseq::plot_richness()</h3>
<p><em>You are limited to the indices calculated by the phyloseq::estimate_richness function</em> <em>(i.e.Observed, Chao1, ACE, Shannon, Simpson, InvSimpson, Fisher).</em></p>
<section id="selected-indices-sampname" class="level4" data-number="4.2.1.1">
<h4 data-number="4.2.1.1" class="anchored" data-anchor-id="selected-indices-sampname"><span class="header-section-number">4.2.1.1</span> Selected indices + SampName</h4>
<p><code>x</code> allow you to choose the column from sample_data(physeq_rar) for applying the label</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">plot_richness</span>(physeq_rar, <span class="at">x =</span> <span class="st">"SampName"</span>,</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">measures =</span> <span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Shannon"</span>, <span class="st">"Simpson"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="color-by-group-color-geo-change-sample-name" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="color-by-group-color-geo-change-sample-name"><span class="header-section-number">4.2.2</span> Color by group: <code>color = Geo</code> &amp; change sample name</h3>
<p>For color option pass the column of <code>sample_data(physeq_rar)</code> that you want. Here different colors is applied depending on <code>Geo</code> (which is North and South, so 2 different colors)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">plot_richness</span>(physeq_rar,</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">x =</span> <span class="st">"Description"</span>,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color=</span><span class="st">"Geo"</span>,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">measures=</span><span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Shannon"</span>, <span class="st">"Simpson"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="make-box_plot-by-adding-geom_boxplot-function" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="make-box_plot-by-adding-geom_boxplot-function"><span class="header-section-number">4.2.3</span> Make box_plot by adding geom_boxplot function</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">plot_richness</span>(physeq_rar,</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">x=</span><span class="st">"Geo"</span>,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color=</span><span class="st">"Geo"</span>,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">measures=</span><span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Shannon"</span>, <span class="st">"Simpson"</span>)) <span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="make-box_plot-geom_boxplot-fill-color-of-boxplot-fill-transparency-with-alpha" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="make-box_plot-geom_boxplot-fill-color-of-boxplot-fill-transparency-with-alpha"><span class="header-section-number">4.2.4</span> Make box_plot : geom_boxplot + fill color of boxplot (fill) + transparency (with alpha)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">plot_richness</span>(physeq_rar,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">x =</span> <span class="st">"Geo"</span>,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">measures =</span> <span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Shannon"</span>, <span class="st">"Simpson"</span>)) <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Geo), <span class="at">alpha =</span> <span class="fl">0.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="alpha-representations-using-microbiomeboxplot_alpha-not-shown" class="level3" data-number="4.2.5">
<h3 data-number="4.2.5" class="anchored" data-anchor-id="alpha-representations-using-microbiomeboxplot_alpha-not-shown"><span class="header-section-number">4.2.5</span> Alpha representations using <code>Microbiome::boxplot_alpha</code> (not shown)</h3>
<p>Again, you are limited to the indices calculated by the Microbiome::alpha function</p>
</section>
<section id="alpha-representations-using-ggplot2" class="level3" data-number="4.2.6">
<h3 data-number="4.2.6" class="anchored" data-anchor-id="alpha-representations-using-ggplot2"><span class="header-section-number">4.2.6</span> Alpha representations using ggplot2</h3>
<p>Interest: Freedom!! you can use ANY indices that you have calculated from different packages &amp; included in sample_data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Before : Change your phyloseq class oject sample_data as a dataframe</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>metadata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(physeq_rar))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="basic-points-color" class="level4" data-number="4.2.6.1">
<h4 data-number="4.2.6.1" class="anchored" data-anchor-id="basic-points-color"><span class="header-section-number">4.2.6.1</span> basic: points &amp; color</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#You use the columns of the metadata (Geo, observed, groupe etc)</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> Geo, <span class="at">y =</span> observed)) <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> groupe, <span class="at">fill =</span> groupe))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="deals-with-superposed-points-geom_dotplot" class="level4" data-number="4.2.6.2">
<h4 data-number="4.2.6.2" class="anchored" data-anchor-id="deals-with-superposed-points-geom_dotplot"><span class="header-section-number">4.2.6.2</span> Deals with superposed points: <code>geom_dotplot()</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> Geo, <span class="at">y =</span> observed)) <span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">"y"</span>, <span class="at">stackdir =</span> <span class="st">"center"</span>, <span class="at">stackgroups =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">color =</span> groupe, <span class="at">fill =</span> groupe)) <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Geographic position"</span>) <span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Number of Observed ASVs"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="boxplot-color-control-scale_fill-scale_color" class="level4" data-number="4.2.6.3">
<h4 data-number="4.2.6.3" class="anchored" data-anchor-id="boxplot-color-control-scale_fill-scale_color"><span class="header-section-number">4.2.6.3</span> Boxplot &amp; color control : <code>scale_fill</code> &amp; <code>scale_color</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> Geo, <span class="at">y =</span> observed)) <span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="fu">aes</span>(<span class="at">color =</span> Geo, <span class="at">fill =</span> Geo)) <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> Geo, <span class="at">y =</span> observed)) <span class="sc">+</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="fu">aes</span>(<span class="at">color =</span> Geo, <span class="at">fill =</span> Geo)) <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>)) <span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="boxplot-color-control-points-geom_jitter" class="level4" data-number="4.2.6.4">
<h4 data-number="4.2.6.4" class="anchored" data-anchor-id="boxplot-color-control-points-geom_jitter"><span class="header-section-number">4.2.6.4</span> Boxplot, color control &amp; points: <code>geom_jitter()</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> Geo, <span class="at">y =</span> observed)) <span class="sc">+</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>),</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>))<span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> groupe), <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.07</span>), <span class="at">cex =</span> <span class="fl">2.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="boxplot-color-control-points-and-mean-sd-stat_summary" class="level4" data-number="4.2.6.5">
<h4 data-number="4.2.6.5" class="anchored" data-anchor-id="boxplot-color-control-points-and-mean-sd-stat_summary"><span class="header-section-number">4.2.6.5</span> Boxplot, color control, points and Mean SD: <code>stat_summary()</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> Geo, <span class="at">y =</span> observed)) <span class="sc">+</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>),</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>)) <span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> groupe), <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.07</span>), <span class="at">cex =</span> <span class="fl">2.2</span>) <span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">17</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_se"</span>, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> .<span class="dv">1</span>, <span class="at">color =</span> <span class="st">"white"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="combine-graphs-on-same-figure-patchwork" class="level4" data-number="4.2.6.6">
<h4 data-number="4.2.6.6" class="anchored" data-anchor-id="combine-graphs-on-same-figure-patchwork"><span class="header-section-number">4.2.6.6</span> Combine graphs on same figure: <code>patchwork</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Put your  graphs in different variables P1,P2,P3</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> Geo, <span class="at">y =</span> observed)) <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>,<span class="st">"#E7B800"</span>),</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="fu">c</span>(<span class="st">"#00AFBB"</span>,<span class="st">"#E7B800"</span>)) <span class="sc">+</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> groupe), <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.07</span>), <span class="at">cex =</span> <span class="fl">2.2</span>) <span class="sc">+</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> Geo, <span class="at">y =</span> evenness_pielou)) <span class="sc">+</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>),</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>)) <span class="sc">+</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> groupe), <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.07</span>), <span class="at">cex =</span> <span class="fl">2.2</span>) <span class="sc">+</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> Geo, <span class="at">y =</span> diversity_gini_simpson)) <span class="sc">+</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>),</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>)) <span class="sc">+</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> groupe), <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.07</span>), <span class="at">cex =</span> <span class="fl">2.2</span>) <span class="sc">+</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Put the graph of p1, p2 and p3 on same Figure</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>) <span class="sc">+</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="statistical-hypothesis-for-alpha-diversity" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Statistical hypothesis for alpha diversity</h1>
<section id="normality-test-check-the-normal-or-not-normal-distribution-of-your-data-to-choose-the-right-test" class="level3" data-number="5.0.1">
<h3 data-number="5.0.1" class="anchored" data-anchor-id="normality-test-check-the-normal-or-not-normal-distribution-of-your-data-to-choose-the-right-test"><span class="header-section-number">5.0.1</span> Normality test: Check the Normal or not normal distribution of your data to choose the right test!</h3>
<section id="shapiro-test-h0-null-hypothesis-follows-normal-distribution" class="level4" data-number="5.0.1.1">
<h4 data-number="5.0.1.1" class="anchored" data-anchor-id="shapiro-test-h0-null-hypothesis-follows-normal-distribution"><span class="header-section-number">5.0.1.1</span> Shapiro test: H0 Null Hypothesis: follows Normal distribution!</h4>
<p>Means if p&lt;0.05 -&gt; reject the H0 (so does not follow a normal distribution)</p>
</section>
<section id="q-qplots-compare-your-distribution-with-a-theoretical-normal-distribution" class="level4" data-number="5.0.1.2">
<h4 data-number="5.0.1.2" class="anchored" data-anchor-id="q-qplots-compare-your-distribution-with-a-theoretical-normal-distribution"><span class="header-section-number">5.0.1.2</span> Q-Qplots: Compare your distribution with a theoretical normal distribution</h4>
<p>If your data follow a normal distribution, youre expecting a linear relationship theoritical vs.&nbsp;experimental</p>
<p>Our custom function <code>indices_normality()</code> (defined in <code>R/alpha_diversity.R</code>) plots the results of Shapiro test as well as Q-Qplots.</p>
</section>
</section>
<section id="select-indices-to-test-run-normality-check" class="level3" data-number="5.0.2">
<h3 data-number="5.0.2" class="anchored" data-anchor-id="select-indices-to-test-run-normality-check"><span class="header-section-number">5.0.2</span> Select indices to test &amp; run normality check</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>metadata <span class="sc">|&gt;</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(observed,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                diversity_gini_simpson,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>                diversity_shannon,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>                evenness_pielou,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>                PD) <span class="sc">|&gt;</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">indices_normality</span>(<span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>What are your conclusions?</strong></p>
</section>
<section id="anova-parametric-follows-normal-distribution-and-at-least-3-groups" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="anova-parametric-follows-normal-distribution-and-at-least-3-groups"><span class="header-section-number">5.1</span> ANOVA: parametric (follows normal distribution) AND at least 3 groups</h2>
<section id="anova-for-observed-asv-and-4-groups" class="level4" data-number="5.1.0.1">
<h4 data-number="5.1.0.1" class="anchored" data-anchor-id="anova-for-observed-asv-and-4-groups"><span class="header-section-number">5.1.0.1</span> Anova for Observed ASV and 4 groups</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many groups used? See the column "groupe" of metadata:</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">factor</span>(metadata<span class="sc">$</span>groupe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] SGF NBF NBF NBS NBF NBS NBF NBS NBF NBS SGF SGS SGF SGS SGF SGS SGF SGS
Levels: NBF NBS SGF SGS</code></pre>
</div>
</div>
</section>
<section id="variance" class="level4" data-number="5.1.0.2">
<h4 data-number="5.1.0.2" class="anchored" data-anchor-id="variance"><span class="header-section-number">5.1.0.2</span> Variance</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check homogeneity of variance between groups</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (avoid bias in ANOVA result &amp; keep the power of the test)</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co"># H0= equality of variances in the different populations</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">bartlett.test</span>(observed <span class="sc">~</span> groupe, metadata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  observed by groupe
Bartlett's K-squared = 3.17979, df = 3, p-value = 0.36473</code></pre>
</div>
</div>
<p><strong>Conclusion?</strong></p>
</section>
<section id="alternative-to-bartlett-levene-test-package-car-less-sensitive-to-normality-deviation" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="alternative-to-bartlett-levene-test-package-car-less-sensitive-to-normality-deviation"><span class="header-section-number">5.1.1</span> Alternative to Bartlett : Levene test (package <code>car</code>), less sensitive to normality deviation</h3>
<p>Global Test: Anova tell you if that some of the group means are different, but you dont know which pairs of groups are different!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>aov_observed <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">aov</span>(observed <span class="sc">~</span> groupe, metadata)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov_observed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df  Sum Sq Mean Sq F value Pr(&gt;F)
groupe       3  13.028  4.3426  0.2105 0.8874
Residuals   14 288.750 20.6250               </code></pre>
</div>
</div>
<section id="which-pairs-of-groups-are-different---post-hoc-test-tukey-multiple-pairwise-comparisons" class="level4" data-number="5.1.1.1">
<h4 data-number="5.1.1.1" class="anchored" data-anchor-id="which-pairs-of-groups-are-different---post-hoc-test-tukey-multiple-pairwise-comparisons"><span class="header-section-number">5.1.1.1</span> Which pairs of groups are different? -&gt; Post-hoc test: Tukey multiple pairwise-comparisons</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>signif_pairgroups <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">TukeyHSD</span>(aov_observed, <span class="at">method =</span> <span class="st">"bh"</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>signif_pairgroups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: stats::aov(formula = observed ~ groupe, data = metadata)

$groupe
         diff        lwr       upr      p adj
NBS-NBF -1.45 -10.304898 7.4048980 0.96316788
SGF-NBF -1.80 -10.148478 6.5484779 0.92176565
SGS-NBF -2.20 -11.054898 6.6548980 0.88664240
SGF-NBS -0.35  -9.204898 8.5048980 0.99943022
SGS-NBS -0.75 -10.083882 8.5838820 0.99530194
SGS-SGF -0.40  -9.254898 8.4548980 0.99915104</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="kruskal-wallis-non-parametric-at-least-three-groups" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="kruskal-wallis-non-parametric-at-least-three-groups"><span class="header-section-number">5.2</span> Kruskal-Wallis: non-parametric &amp; at least three groups</h2>
<section id="kruskal-for-diversity_shannon-and-4-groups" class="level4" data-number="5.2.0.1">
<h4 data-number="5.2.0.1" class="anchored" data-anchor-id="kruskal-for-diversity_shannon-and-4-groups"><span class="header-section-number">5.2.0.1</span> Kruskal for diversity_shannon and 4 groups</h4>
<p>Global test</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">kruskal.test</span>(diversity_shannon <span class="sc">~</span> groupe, <span class="at">data =</span> metadata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  diversity_shannon by groupe
Kruskal-Wallis chi-squared = 2.95439, df = 3, p-value = 0.39871</code></pre>
</div>
</div>
</section>
<section id="post-hoc-test-dunn-test-pairwise-group-test" class="level4" data-number="5.2.0.2">
<h4 data-number="5.2.0.2" class="anchored" data-anchor-id="post-hoc-test-dunn-test-pairwise-group-test"><span class="header-section-number">5.2.0.2</span> Post hoc test: Dunn test (pairwise group test)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>signifgroup <span class="ot">&lt;-</span> FSA<span class="sc">::</span><span class="fu">dunnTest</span>(diversity_shannon <span class="sc">~</span> groupe,</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> metadata,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"bh"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: groupe was coerced to a factor.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#See</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>signifgroup</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Comparison           Z    P.unadj      P.adj
1  NBF - NBS  1.52183587 0.12805021 0.76830127
2  NBF - SGF  1.24393264 0.21352435 0.64057306
3  NBS - SGF -0.34904492 0.72705558 0.72705558
4  NBF - SGS  0.40489211 0.68555682 0.82266818
5  NBS - SGS -1.05962589 0.28931483 0.57862966
6  SGF - SGS -0.76789883 0.44254729 0.66382094</code></pre>
</div>
</div>
</section>
</section>
<section id="t-test-parametric-2-groups-i.e-north-vs.-sud" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="t-test-parametric-2-groups-i.e-north-vs.-sud"><span class="header-section-number">5.3</span> T-test: parametric, 2 groups (<em>i.e</em> North Vs. Sud)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">bartlett.test</span>(observed <span class="sc">~</span> Geo, metadata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  observed by Geo
Bartlett's K-squared = 0.38191, df = 1, p-value = 0.53658</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>observed_ttest <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">t.test</span>(observed <span class="sc">~</span> Geo, <span class="at">data =</span> metadata)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>observed_ttest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  observed by Geo
t = 0.660078, df = 15.246, p-value = 0.51905
alternative hypothesis: true difference in means between group North and group South is not equal to 0
95 percent confidence interval:
 -2.9660719  5.6327386
sample estimates:
mean in group North mean in group South 
          37.555556           36.222222 </code></pre>
</div>
</div>
</section>
<section id="wilcoxon-rank-sum-non-parametric-2-groups" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="wilcoxon-rank-sum-non-parametric-2-groups"><span class="header-section-number">5.4</span> Wilcoxon rank sum: non-parametric &amp; 2 Groups</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>pairwise_test <span class="ot">&lt;-</span> ggpubr<span class="sc">::</span><span class="fu">compare_means</span>(diversity_shannon <span class="sc">~</span> Geo,</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>                                       metadata,</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">method =</span> <span class="st">"wilcox.test"</span>)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="co">#See</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>pairwise_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1  8
  .y.               group1 group2     p p.adj p.format p.signif method  
  &lt;chr&gt;             &lt;chr&gt;  &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;   
1 diversity_shannon South  North  0.863  0.86 0.86     ns       Wilcoxon</code></pre>
</div>
</div>
<section id="boxplot-representation-with-p-value-information" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="boxplot-representation-with-p-value-information"><span class="header-section-number">5.4.1</span> Boxplot representation with p-value information</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Boxplot as previously seen</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>graph_shan <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> Geo, <span class="at">y =</span> diversity_shannon)) <span class="sc">+</span> </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.6</span>,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>),</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>)) <span class="sc">+</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> groupe),</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.02</span>) ,</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">cex=</span><span class="fl">2.2</span>)<span class="sc">+</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">17</span>, <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"white"</span>)</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Add p-value on graph</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>graph_shan <span class="sc">+</span> ggpubr<span class="sc">::</span><span class="fu">stat_pvalue_manual</span>(</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>  pairwise_test,</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">y.position =</span> <span class="fl">3.5</span>,</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">"p.adj = {p.adj}"</span>,</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">linetype =</span> <span class="dv">1</span>,</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">tip.length =</span> <span class="fl">0.01</span></span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="correlation-linear-regression" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Correlation &amp; linear Regression</h1>
<section id="correlation-analysis" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="correlation-analysis"><span class="header-section-number">6.1</span> Correlation analysis</h2>
<p>Methods available are <code>spearman</code>, <code>kendall</code> and <code>pearson</code>. Correlation coefficient r is <strong>independent of change of origin and scale (So no data transformation!!)</strong>. Correlation analysis describes the nature (strength (0-&gt;1) and direction +/-) of the relationship between two variables (r), whatever the range and the measurement units of them.</p>
<p>Considerations for statistical tests (test of the value being zero): * Pearsons test is parametric (normal distribution required) * Spearmans and Kendalls tests are non-parametric</p>
<section id="select-variables" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="select-variables"><span class="header-section-number">6.1.1</span> Select variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Select variables for bivariate correlation</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>myvariables <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(metadata, SiOH4<span class="sc">:</span>PO4,diversity_shannon)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>myvariables</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     SiOH4   NO2   NO3   NH4   PO4 diversity_shannon
S11B 3.324 0.083 0.756 0.467 0.115         3.1464802
S1B  1.813 0.256 0.889 0.324 0.132         3.1777661
S2B  2.592 0.105 1.125 0.328 0.067         3.4080222
S2S  3.381 0.231 0.706 0.450 0.109         3.1120657
S3B  1.438 0.057 1.159 0.369 0.174         3.2759058
S3S  1.656 0.098 0.794 0.367 0.095         3.2468023
S4B  2.457 0.099 1.087 0.349 0.137         3.3506939
S4S  2.457 0.099 1.087 0.349 0.137         3.0974738
S5B  2.028 0.103 1.135 0.216 0.128         2.9785407
S5S  2.669 0.136 0.785 0.267 0.114         2.9933406
S6B  2.206 0.249 0.768 0.629 0.236         3.2135081
S6S  3.004 0.251 0.927 0.653 0.266         2.4409713
S7B  3.016 0.157 0.895 0.491 0.176         3.1577021
S7S  1.198 0.165 1.099 0.432 0.180         3.2782965
S8B  3.868 0.253 0.567 0.533 0.169         3.1084743
S8S  3.639 0.255 0.658 0.665 0.247         3.3076444
S9B  3.910 0.107 0.672 0.490 0.134         3.1059084
S9S  3.607 0.139 0.644 0.373 0.167         3.1803927</code></pre>
</div>
</div>
</section>
<section id="apply-the-method" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="apply-the-method"><span class="header-section-number">6.1.2</span> Apply the method</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Apply method pearson</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>matrixCor <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">cor</span>(myvariables, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>matrixCor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        SiOH4         NO2          NO3         NH4         PO4
SiOH4              1.00000000  0.26802252 -0.727703077  0.44354653  0.11949381
NO2                0.26802252  1.00000000 -0.484402421  0.62864562  0.57757348
NO3               -0.72770308 -0.48440242  1.000000000 -0.49147592 -0.16912716
NH4                0.44354653  0.62864562 -0.491475923  1.00000000  0.77443570
PO4                0.11949381  0.57757348 -0.169127163  0.77443570  1.00000000
diversity_shannon -0.20728823 -0.29316236  0.094763958 -0.24014733 -0.37791579
                  diversity_shannon
SiOH4                  -0.207288231
NO2                    -0.293162363
NO3                     0.094763958
NH4                    -0.240147333
PO4                    -0.377915793
diversity_shannon       1.000000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we use a function defined in R/utils.R</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="co"># to move the row names content to a new column</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="fu">df_export</span>(matrixCor, <span class="at">new_rn =</span> <span class="st">"variable"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           variable       SiOH4         NO2          NO3         NH4
1             SiOH4  1.00000000  0.26802252 -0.727703077  0.44354653
2               NO2  0.26802252  1.00000000 -0.484402421  0.62864562
3               NO3 -0.72770308 -0.48440242  1.000000000 -0.49147592
4               NH4  0.44354653  0.62864562 -0.491475923  1.00000000
5               PO4  0.11949381  0.57757348 -0.169127163  0.77443570
6 diversity_shannon -0.20728823 -0.29316236  0.094763958 -0.24014733
          PO4 diversity_shannon
1  0.11949381      -0.207288231
2  0.57757348      -0.293162363
3 -0.16912716       0.094763958
4  0.77443570      -0.240147333
5  1.00000000      -0.377915793
6 -0.37791579       1.000000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we can now export</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">df_export</span>(matrixCor, <span class="at">new_rn =</span> <span class="st">"variable"</span>),</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">file.path</span>(output_alpha, <span class="st">"correlation_matrix.tsv"</span>),</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">quote =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-results-corrplot-function" class="level3" data-number="6.1.3">
<h3 data-number="6.1.3" class="anchored" data-anchor-id="plot-results-corrplot-function"><span class="header-section-number">6.1.3</span> Plot results: corrplot function</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  matrixCor,</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">method=</span><span class="st">"circle"</span>,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type=</span><span class="st">"lower"</span>,</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">order=</span><span class="st">'hclust'</span>,</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.cex=</span><span class="fl">0.9</span>,</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">diag =</span> <span class="cn">FALSE</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="is-the-correlation-is-due-to-chance-significance-test" class="level3" data-number="6.1.4">
<h3 data-number="6.1.4" class="anchored" data-anchor-id="is-the-correlation-is-due-to-chance-significance-test"><span class="header-section-number">6.1.4</span> Is the correlation is due to chance? Significance test!</h3>
<p>The idea: Test the correlation at the population scale (=Rho) and compare to r (your samples). HO is : there is not a significant linear correlation between x and y in the population. For instance t-test allows to use sample data to generalize an assumption to an entire population.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Test stats</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>ptest <span class="ot">&lt;-</span> corrplot<span class="sc">::</span><span class="fu">cor.mtest</span>(matrixCor, <span class="at">conf.level =</span> .<span class="dv">95</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co">#The p-value are stored in ptest$p</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>ptest<span class="sc">$</span>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         SiOH4         NO2          NO3         NH4         PO4
SiOH4             0.0000000000 0.188313687 0.0045596985 0.110136746 0.425648355
NO2               0.1883136871 0.000000000 0.0721195375 0.012780256 0.035320670
NO3               0.0045596985 0.072119538 0.0000000000 0.051193376 0.300785372
NH4               0.1101367463 0.012780256 0.0511933761 0.000000000 0.013913210
PO4               0.4256483554 0.035320670 0.3007853722 0.013913210 0.000000000
diversity_shannon 0.3493471499 0.114960693 0.4193117807 0.112842904 0.052189815
                  diversity_shannon
SiOH4                   0.349347150
NO2                     0.114960693
NO3                     0.419311781
NH4                     0.112842904
PO4                     0.052189815
diversity_shannon       0.000000000</code></pre>
</div>
</div>
</section>
<section id="show-only-correlations-with-significant-p-values" class="level3" data-number="6.1.5">
<h3 data-number="6.1.5" class="anchored" data-anchor-id="show-only-correlations-with-significant-p-values"><span class="header-section-number">6.1.5</span> Show only correlations with significant p-values</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  matrixCor,</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.mat =</span> ptest<span class="sc">$</span>p,</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>,</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"circle"</span>,</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"lower"</span>,</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">order =</span> <span class="st">'hclust'</span>,</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.cex =</span> <span class="fl">0.7</span>,</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">diag =</span> <span class="cn">FALSE</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="linear-regression" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="linear-regression"><span class="header-section-number">6.2</span> Linear regression</h2>
<p>Determination coefficient R<sup>2</sup> provides percentage variation in y which is explained by all the x together. Its value is (usually) between 0 and 1 and it indicates strength of Linear Regression model. Higher the R<sup>2</sup> value, data points are less scattered so it is a good model. Lesser the R<sup>2</sup> value is more scattered the data points.</p>
<section id="shannon-observed" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="shannon-observed"><span class="header-section-number">6.2.1</span> Shannon ~ Observed</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> observed, <span class="at">y =</span> diversity_shannon)) <span class="sc">+</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  ggpmisc<span class="sc">::</span><span class="fu">stat_poly_eq</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">after_stat</span>(rr.label),</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">after_stat</span>(p.value.label),</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">sep =</span> <span class="st">"*</span><span class="sc">\"</span><span class="st">, </span><span class="sc">\"</span><span class="st">*"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>What should be your conclusionsbe careful</p>
<p>What is the r value?</p>
</section>
</section>
</section>
<section id="taxonomy-barplot-graph" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Taxonomy: barplot graph</h1>
<section id="abundance-transformation" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="abundance-transformation"><span class="header-section-number">7.1</span> Abundance Transformation</h2>
<section id="counts-in-percentage-using-phyloseqtransform_sample_counts" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="counts-in-percentage-using-phyloseqtransform_sample_counts"><span class="header-section-number">7.1.1</span> Counts in percentage using <code>phyloseq::transform_sample_counts()</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>pourcentS <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">transform_sample_counts</span>(physeq_rar, <span class="cf">function</span>(x) x<span class="sc">/</span><span class="fu">sum</span>(x) <span class="sc">*</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>See plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">plot_bar</span>(pourcentS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>What are the separation lines?</p>
</section>
<section id="summarise-at-a-given-taxonomic-level-with-phyloseqtax_glom" class="level3" data-number="7.1.2">
<h3 data-number="7.1.2" class="anchored" data-anchor-id="summarise-at-a-given-taxonomic-level-with-phyloseqtax_glom"><span class="header-section-number">7.1.2</span> Summarise at a given taxonomic level with <code>phyloseq::tax_glom()</code></h3>
<p>Remember ranks can be obtained with <code>phyloseq::rank_names()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">rank_names</span>(pourcentS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Kingdom" "Phylum"  "Class"   "Order"   "Family"  "Genus"   "Species"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>Phylum_glom <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">tax_glom</span>(pourcentS,</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">taxrank =</span> <span class="st">"Phylum"</span>,</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">NArm =</span> <span class="cn">FALSE</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot at Phylum taxonomic rank, with color</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">plot_bar</span>(Phylum_glom, <span class="at">fill =</span> <span class="st">"Phylum"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>NArm?</em></p>
</section>
<section id="filter-phylum-mean-of-the-line-phyloseqfilter_taxa" class="level3" data-number="7.1.3">
<h3 data-number="7.1.3" class="anchored" data-anchor-id="filter-phylum-mean-of-the-line-phyloseqfilter_taxa"><span class="header-section-number">7.1.3</span> Filter phylum (mean of the line): <code>phyloseq::filter_taxa()</code></h3>
<p>Lets filter out the phylums with a mean relative abundance inferior to 1%</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>Phylum_1 <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">filter_taxa</span>(Phylum_glom,</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">flist =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">&gt;=</span> <span class="dv">1</span>,</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">prune =</span> <span class="cn">TRUE</span>)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot at Phylum taxonomic rank, with color</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">plot_bar</span>(Phylum_1, <span class="at">fill =</span> <span class="st">"Phylum"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="how-to-save-a-table-into-a-file-exemple-of-phylum-taxonomic-table" class="level3" data-number="7.1.4">
<h3 data-number="7.1.4" class="anchored" data-anchor-id="how-to-save-a-table-into-a-file-exemple-of-phylum-taxonomic-table"><span class="header-section-number">7.1.4</span> How to save a table into a file: exemple of phylum taxonomic table</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">df_export</span>(<span class="fu">otu_table</span>(Phylum_glom)),</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">file =</span> <span class="fu">file.path</span>(output_alpha, <span class="st">"Phylum_pourcent.tsv"</span>),</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="remove-black-lines" class="level3" data-number="7.1.5">
<h3 data-number="7.1.5" class="anchored" data-anchor-id="remove-black-lines"><span class="header-section-number">7.1.5</span> Remove black lines</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">plot_bar</span>(Phylum_glom, <span class="st">"Description"</span>, <span class="at">fill =</span> <span class="st">"Phylum"</span>) <span class="sc">+</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Phylum), <span class="at">stat =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="microbiome-package" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="microbiome-package"><span class="header-section-number">7.2</span> Microbiome package</h2>
<section id="microbiomeaggregate_taxa" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="microbiomeaggregate_taxa"><span class="header-section-number">7.2.1</span> <code>microbiome::aggregate_taxa()</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Order Rank</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>Order_microb <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">aggregate_taxa</span>(pourcentS, <span class="st">"Order"</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Filter at 1%</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>Order1 <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">filter_taxa</span>(Order_microb, <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">&gt;=</span> <span class="dv">1</span>, <span class="at">prune =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="microbiomeplot_composition" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="microbiomeplot_composition"><span class="header-section-number">7.2.2</span> <code>microbiome::plot_composition()</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>p_order <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">plot_composition</span>(Order1,</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">otu.sort =</span> <span class="st">"abundance"</span>,</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">sample.sort =</span> <span class="st">"Description"</span>,</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">x.label =</span> <span class="st">"Description"</span>,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">plot.type =</span> <span class="st">"barplot"</span>,</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">verbose =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Relative abundance (%)"</span>)</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>p_order</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Average by group :average_by option</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>p_order_groupe <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">plot_composition</span>(Order1,</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">otu.sort =</span> <span class="st">"abundance"</span>,</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">sample.sort =</span> <span class="st">"Description"</span>,</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">x.label =</span> <span class="st">"Description"</span>,</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">plot.type =</span> <span class="st">"barplot"</span>,</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">average_by =</span> <span class="st">"Geo"</span>) <span class="sc">+</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Relative abundance (%)"</span>)</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>p_order_groupe</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="interactive-barplot-with-plotlyggplotly" class="level3" data-number="7.2.3">
<h3 data-number="7.2.3" class="anchored" data-anchor-id="interactive-barplot-with-plotlyggplotly"><span class="header-section-number">7.2.3</span> Interactive barplot with <code>plotly::ggplotly()</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>plotly<span class="sc">::</span><span class="fu">ggplotly</span>(p_order)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-2d5decdcee306a1d6e0c" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-2d5decdcee306a1d6e0c">{"x":{"data":[{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999858,0.90000000000000013,0.90000000000000036,0.89999999999999858,0.89999999999999991,0.90000000000000036,0.89999999999999947,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858],"base":[53.763440860215049,52.210274790919954,61.051373954599761,65.830346475507767,55.555555555555557,67.98088410991636,65.949820788530474,63.082437275985662,51.612903225806456,71.206690561529271,69.653524492234169,73.237753882915172,73.357228195937878,75.388291517323779,74.551971326164875,81.003584229390682,79.928315412186379,93.189964157706086],"x":[7,4,6,17,2,3,15,1,5,8,18,16,9,10,14,13,12,11],"y":[37.873357228195935,36.798088410991639,35.722819593787342,33.094384707287929,30.465949820788524,30.465949820788538,30.346475507765831,29.749103942652333,27.24014336917562,27.001194743130227,26.045400238948631,24.372759856630822,23.178016726403825,22.81959378733572,21.146953405017925,15.053763440860209,13.620071684587813,6.5710872162485146],"text":["Sample: S4S<br />Abundance: 37.87335723<br />Tax: SAR11 clade","Sample: S3B<br />Abundance: 36.79808841<br />Tax: SAR11 clade","Sample: S4B<br />Abundance: 35.72281959<br />Tax: SAR11 clade","Sample: S9S<br />Abundance: 33.09438471<br />Tax: SAR11 clade","Sample: S2B<br />Abundance: 30.46594982<br />Tax: SAR11 clade","Sample: S2S<br />Abundance: 30.46594982<br />Tax: SAR11 clade","Sample: S8S<br />Abundance: 30.34647551<br />Tax: SAR11 clade","Sample: S1B<br />Abundance: 29.74910394<br />Tax: SAR11 clade","Sample: S3S<br />Abundance: 27.24014337<br />Tax: SAR11 clade","Sample: S5B<br />Abundance: 27.00119474<br />Tax: SAR11 clade","Sample: S11B<br />Abundance: 26.04540024<br />Tax: SAR11 clade","Sample: S9B<br />Abundance: 24.37275986<br />Tax: SAR11 clade","Sample: S5S<br />Abundance: 23.17801673<br />Tax: SAR11 clade","Sample: S6B<br />Abundance: 22.81959379<br />Tax: SAR11 clade","Sample: S8B<br />Abundance: 21.14695341<br />Tax: SAR11 clade","Sample: S7S<br />Abundance: 15.05376344<br />Tax: SAR11 clade","Sample: S7B<br />Abundance: 13.62007168<br />Tax: SAR11 clade","Sample: S6S<br />Abundance:  6.57108722<br />Tax: SAR11 clade"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"SAR11 clade","legendgroup":"SAR11 clade","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999947,0.90000000000000036,0.90000000000000036,0.89999999999999991,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.89999999999999858],"base":[30.465949820788531,44.32497013142175,49.223416965352449,49.342891278375149,45.997610513739545,57.467144563918758,51.851851851851848,71.565113500597363,61.29032258064516,62.485065710872163,68.100358422939067,59.02031063321386,51.732377538829148,61.170848267622461,49.820788530465947,55.197132616487458,52.210274790919954,73.357228195937878],"x":[11,12,14,16,3,10,17,13,18,15,8,6,7,1,5,2,4,9],"y":[62.724014336917556,35.603345280764628,25.328554360812426,23.894862604540023,21.983273596176815,17.921146953405021,13.978494623655919,9.4384707287933196,8.3632019115890088,3.4647550776583103,3.1063321385902043,2.0310633213859006,2.0310633213859006,1.911589008363201,1.7921146953405085,0.35842293906809886,0,0],"text":["Sample: S6S<br />Abundance: 62.72401434<br />Tax: Enterobacterales","Sample: S7B<br />Abundance: 35.60334528<br />Tax: Enterobacterales","Sample: S8B<br />Abundance: 25.32855436<br />Tax: Enterobacterales","Sample: S9B<br />Abundance: 23.89486260<br />Tax: Enterobacterales","Sample: S2S<br />Abundance: 21.98327360<br />Tax: Enterobacterales","Sample: S6B<br />Abundance: 17.92114695<br />Tax: Enterobacterales","Sample: S9S<br />Abundance: 13.97849462<br />Tax: Enterobacterales","Sample: S7S<br />Abundance:  9.43847073<br />Tax: Enterobacterales","Sample: S11B<br />Abundance:  8.36320191<br />Tax: Enterobacterales","Sample: S8S<br />Abundance:  3.46475508<br />Tax: Enterobacterales","Sample: S5B<br />Abundance:  3.10633214<br />Tax: Enterobacterales","Sample: S4B<br />Abundance:  2.03106332<br />Tax: Enterobacterales","Sample: S4S<br />Abundance:  2.03106332<br />Tax: Enterobacterales","Sample: S1B<br />Abundance:  1.91158901<br />Tax: Enterobacterales","Sample: S3S<br />Abundance:  1.79211470<br />Tax: Enterobacterales","Sample: S2B<br />Abundance:  0.35842294<br />Tax: Enterobacterales","Sample: S3B<br />Abundance:  0.00000000<br />Tax: Enterobacterales","Sample: S5S<br />Abundance:  0.00000000<br />Tax: Enterobacterales"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(219,142,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Enterobacterales","legendgroup":"Enterobacterales","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999858,0.89999999999999947,0.90000000000000036,0.90000000000000036,0.89999999999999991,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.90000000000000036,0.90000000000000013,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858],"base":[51.493428912783756,48.148148148148145,30.58542413381123,34.528076463560332,44.922341696535248,43.13022700119474,38.112305854241342,38.829151732377539,35.603345280764636,51.01553166069295,49.103942652329749,45.878136200716845,40.023894862604543,21.983273596176822,63.082437275985662,55.077658303464759,38.829151732377539,43.966547192353644],"x":[9,8,5,7,1,10,4,17,3,18,6,2,16,11,13,15,12,14],"y":[21.863799283154123,19.952210274790922,19.235364396654717,17.204301075268816,16.248506571087212,14.336917562724018,14.097968936678612,13.022700119474308,10.394265232974909,10.27479091995221,9.916367980884111,9.3189964157706129,9.3189964157706058,8.4826762246117084,8.4826762246117013,7.4074074074074048,5.4958183990442109,5.2568697729988045],"text":["Sample: S5S<br />Abundance: 21.86379928<br />Tax: Synechococcales","Sample: S5B<br />Abundance: 19.95221027<br />Tax: Synechococcales","Sample: S3S<br />Abundance: 19.23536440<br />Tax: Synechococcales","Sample: S4S<br />Abundance: 17.20430108<br />Tax: Synechococcales","Sample: S1B<br />Abundance: 16.24850657<br />Tax: Synechococcales","Sample: S6B<br />Abundance: 14.33691756<br />Tax: Synechococcales","Sample: S3B<br />Abundance: 14.09796894<br />Tax: Synechococcales","Sample: S9S<br />Abundance: 13.02270012<br />Tax: Synechococcales","Sample: S2S<br />Abundance: 10.39426523<br />Tax: Synechococcales","Sample: S11B<br />Abundance: 10.27479092<br />Tax: Synechococcales","Sample: S4B<br />Abundance:  9.91636798<br />Tax: Synechococcales","Sample: S2B<br />Abundance:  9.31899642<br />Tax: Synechococcales","Sample: S9B<br />Abundance:  9.31899642<br />Tax: Synechococcales","Sample: S6S<br />Abundance:  8.48267622<br />Tax: Synechococcales","Sample: S7S<br />Abundance:  8.48267622<br />Tax: Synechococcales","Sample: S8S<br />Abundance:  7.40740741<br />Tax: Synechococcales","Sample: S7B<br />Abundance:  5.49581840<br />Tax: Synechococcales","Sample: S8B<br />Abundance:  5.25686977<br />Tax: Synechococcales"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(174,162,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Synechococcales","legendgroup":"Synechococcales","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000013,0.89999999999999858,0.90000000000000036,0.89999999999999947,0.89999999999999991,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000036],"base":[13.022700119474313,32.97491039426523,30.465949820788531,23.775388291517324,23.536439665471924,34.289127837514933,31.421744324970131,49.581839904420548,38.112305854241342,18.160095579450417,40.501792114695341,32.85543608124253,33.930704898446834,30.58542413381123,13.500597371565114,46.59498207885305,31.780167264038234,29.51015531660693],"x":[7,6,2,17,4,8,1,13,9,5,18,10,14,16,11,15,12,3],"y":[21.505376344086017,16.12903225806452,15.412186379928315,15.053763440860216,14.575866188769417,13.859020310633213,13.500597371565117,13.500597371565114,13.381123058542414,12.425328554360814,10.513739545997609,10.27479091995221,10.035842293906811,9.4384707287933125,8.4826762246117084,8.4826762246117084,7.0489844683393059,6.0931899641577054],"text":["Sample: S4S<br />Abundance: 21.50537634<br />Tax: Rhodospirillales","Sample: S4B<br />Abundance: 16.12903226<br />Tax: Rhodospirillales","Sample: S2B<br />Abundance: 15.41218638<br />Tax: Rhodospirillales","Sample: S9S<br />Abundance: 15.05376344<br />Tax: Rhodospirillales","Sample: S3B<br />Abundance: 14.57586619<br />Tax: Rhodospirillales","Sample: S5B<br />Abundance: 13.85902031<br />Tax: Rhodospirillales","Sample: S1B<br />Abundance: 13.50059737<br />Tax: Rhodospirillales","Sample: S7S<br />Abundance: 13.50059737<br />Tax: Rhodospirillales","Sample: S5S<br />Abundance: 13.38112306<br />Tax: Rhodospirillales","Sample: S3S<br />Abundance: 12.42532855<br />Tax: Rhodospirillales","Sample: S11B<br />Abundance: 10.51373955<br />Tax: Rhodospirillales","Sample: S6B<br />Abundance: 10.27479092<br />Tax: Rhodospirillales","Sample: S8B<br />Abundance: 10.03584229<br />Tax: Rhodospirillales","Sample: S9B<br />Abundance:  9.43847073<br />Tax: Rhodospirillales","Sample: S6S<br />Abundance:  8.48267622<br />Tax: Rhodospirillales","Sample: S8S<br />Abundance:  8.48267622<br />Tax: Rhodospirillales","Sample: S7B<br />Abundance:  7.04898447<br />Tax: Rhodospirillales","Sample: S2S<br />Abundance:  6.09318996<br />Tax: Rhodospirillales"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(100,178,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Rhodospirillales","legendgroup":"Rhodospirillales","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.89999999999999947,0.89999999999999858,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.89999999999999991,0.90000000000000036],"base":[18.040621266427717,29.62962962962963,27.47909199522103,14.336917562724015,13.859020310633214,18.518518518518519,18.518518518518519,20.31063321385902,25.209080047789726,20.54958183990442,21.744324970131423,11.111111111111111,18.518518518518519,28.195937873357231,19.115890083632017,11.708482676224612,30.346475507765831,12.664277180406213],"x":[18,13,15,12,16,14,6,8,9,2,3,5,17,10,4,11,1,7],"y":[22.461170848267624,19.952210274790918,19.115890083632021,17.443249701314219,16.726403823178018,15.412186379928315,14.456391875746711,13.978494623655912,12.903225806451616,9.916367980884111,7.7658303464755072,7.0489844683393059,5.2568697729988045,4.6594982078852993,4.4205495818399072,1.7921146953405014,1.0752688172043001,0.35842293906810063],"text":["Sample: S11B<br />Abundance: 22.46117085<br />Tax: Marine Group II","Sample: S7S<br />Abundance: 19.95221027<br />Tax: Marine Group II","Sample: S8S<br />Abundance: 19.11589008<br />Tax: Marine Group II","Sample: S7B<br />Abundance: 17.44324970<br />Tax: Marine Group II","Sample: S9B<br />Abundance: 16.72640382<br />Tax: Marine Group II","Sample: S8B<br />Abundance: 15.41218638<br />Tax: Marine Group II","Sample: S4B<br />Abundance: 14.45639188<br />Tax: Marine Group II","Sample: S5B<br />Abundance: 13.97849462<br />Tax: Marine Group II","Sample: S5S<br />Abundance: 12.90322581<br />Tax: Marine Group II","Sample: S2B<br />Abundance:  9.91636798<br />Tax: Marine Group II","Sample: S2S<br />Abundance:  7.76583035<br />Tax: Marine Group II","Sample: S3S<br />Abundance:  7.04898447<br />Tax: Marine Group II","Sample: S9S<br />Abundance:  5.25686977<br />Tax: Marine Group II","Sample: S6B<br />Abundance:  4.65949821<br />Tax: Marine Group II","Sample: S3B<br />Abundance:  4.42054958<br />Tax: Marine Group II","Sample: S6S<br />Abundance:  1.79211470<br />Tax: Marine Group II","Sample: S1B<br />Abundance:  1.07526882<br />Tax: Marine Group II","Sample: S4S<br />Abundance:  0.35842294<br />Tax: Marine Group II"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,189,92,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Marine Group II","legendgroup":"Marine Group II","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999947,0.90000000000000013,0.89999999999999858,0.89999999999999991,0.90000000000000036,0.89999999999999858,0.90000000000000036,0.90000000000000036,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.89999999999999858],"base":[3.5842293906810037,10.991636798088411,5.0179211469534053,17.323775388291516,10.035842293906811,10.872162485065711,18.27956989247312,21.62485065710872,10.513739545997611,10.991636798088411,6.2126642771804068,13.022700119474312,7.8853046594982077,16.845878136200717,7.2879330943847069,11.589008363201913,8.7216248506571095,15.770609318996415],"x":[9,13,17,10,8,2,15,1,6,14,7,4,16,3,11,12,5,18],"y":[21.624850657108723,18.637992831541219,13.500597371565114,10.872162485065715,10.27479091995221,9.6774193548387082,9.1995221027479097,8.7216248506571112,8.0047789725209082,7.5268817204301079,6.4516129032258061,6.0931899641577054,5.9737156511350067,4.8984468339307057,4.4205495818399054,2.7479091995221019,2.3894862604540013,2.2700119474313016],"text":["Sample: S5S<br />Abundance: 21.62485066<br />Tax: Actinomarinales","Sample: S7S<br />Abundance: 18.63799283<br />Tax: Actinomarinales","Sample: S9S<br />Abundance: 13.50059737<br />Tax: Actinomarinales","Sample: S6B<br />Abundance: 10.87216249<br />Tax: Actinomarinales","Sample: S5B<br />Abundance: 10.27479092<br />Tax: Actinomarinales","Sample: S2B<br />Abundance:  9.67741935<br />Tax: Actinomarinales","Sample: S8S<br />Abundance:  9.19952210<br />Tax: Actinomarinales","Sample: S1B<br />Abundance:  8.72162485<br />Tax: Actinomarinales","Sample: S4B<br />Abundance:  8.00477897<br />Tax: Actinomarinales","Sample: S8B<br />Abundance:  7.52688172<br />Tax: Actinomarinales","Sample: S4S<br />Abundance:  6.45161290<br />Tax: Actinomarinales","Sample: S3B<br />Abundance:  6.09318996<br />Tax: Actinomarinales","Sample: S9B<br />Abundance:  5.97371565<br />Tax: Actinomarinales","Sample: S2S<br />Abundance:  4.89844683<br />Tax: Actinomarinales","Sample: S6S<br />Abundance:  4.42054958<br />Tax: Actinomarinales","Sample: S7B<br />Abundance:  2.74790920<br />Tax: Actinomarinales","Sample: S3S<br />Abundance:  2.38948626<br />Tax: Actinomarinales","Sample: S11B<br />Abundance:  2.27001195<br />Tax: Actinomarinales"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,193,167,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Actinomarinales","legendgroup":"Actinomarinales","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.90000000000000036,0.89999999999999858,0.89999999999999947,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.89999999999999858],"base":[9.4384707287933107,5.3763440860215059,7.6463560334528076,6.8100358422939076,12.425328554360812,6.5710872162485066,14.097968936678614,13.381123058542414,2.3894862604540026,5.0179211469534053,4.5400238948626042,7.4074074074074066,13.261648745519713,6.2126642771804059,3.5842293906810037,9.916367980884111,9.5579450418160103,3.225806451612903],"x":[1,2,4,12,3,14,15,10,7,5,11,8,18,16,17,13,6,9],"y":[12.186379928315409,5.4958183990442055,5.3763440860215042,4.7789725209080052,4.4205495818399054,4.4205495818399045,4.1816009557945062,3.9426523297491016,3.8231780167264042,3.7037037037037042,2.7479091995221028,2.628434886499404,2.5089605734767026,1.6726403823178018,1.4336917562724016,1.0752688172043001,0.9557945041816005,0.35842293906810063],"text":["Sample: S1B<br />Abundance: 12.18637993<br />Tax: Pseudomonadales","Sample: S2B<br />Abundance:  5.49581840<br />Tax: Pseudomonadales","Sample: S3B<br />Abundance:  5.37634409<br />Tax: Pseudomonadales","Sample: S7B<br />Abundance:  4.77897252<br />Tax: Pseudomonadales","Sample: S2S<br />Abundance:  4.42054958<br />Tax: Pseudomonadales","Sample: S8B<br />Abundance:  4.42054958<br />Tax: Pseudomonadales","Sample: S8S<br />Abundance:  4.18160096<br />Tax: Pseudomonadales","Sample: S6B<br />Abundance:  3.94265233<br />Tax: Pseudomonadales","Sample: S4S<br />Abundance:  3.82317802<br />Tax: Pseudomonadales","Sample: S3S<br />Abundance:  3.70370370<br />Tax: Pseudomonadales","Sample: S6S<br />Abundance:  2.74790920<br />Tax: Pseudomonadales","Sample: S5B<br />Abundance:  2.62843489<br />Tax: Pseudomonadales","Sample: S11B<br />Abundance:  2.50896057<br />Tax: Pseudomonadales","Sample: S9B<br />Abundance:  1.67264038<br />Tax: Pseudomonadales","Sample: S9S<br />Abundance:  1.43369176<br />Tax: Pseudomonadales","Sample: S7S<br />Abundance:  1.07526882<br />Tax: Pseudomonadales","Sample: S4B<br />Abundance:  0.95579450<br />Tax: Pseudomonadales","Sample: S5S<br />Abundance:  0.35842294<br />Tax: Pseudomonadales"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,186,222,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pseudomonadales","legendgroup":"Pseudomonadales","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999858,0.90000000000000036,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.90000000000000036,0.90000000000000013,0.89999999999999947,0.90000000000000036,0.89999999999999858,0.89999999999999991,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.89999999999999858,0.89999999999999858],"base":[6.4516129032258061,6.4516129032258061,9.0800477897252083,6.2126642771804068,10.513739545997611,2.5089605734767026,0.11947431302270012,3.225806451612903,5.376344086021505,5.7347670250896057,5.0179211469534053,7.8853046594982086,5.3763440860215059,5.2568697729988054,8.9605734767025087,2.8673835125448028,4.5400238948626042,3.5842293906810037],"x":[18,3,15,13,10,5,7,2,8,4,12,1,14,16,6,9,11,17],"y":[6.8100358422939067,5.9737156511350058,5.0179211469534053,3.7037037037037042,2.8673835125448033,2.5089605734767026,2.2700119474313025,2.1505376344086029,2.0310633213859015,1.9115890083632019,1.7921146953405023,1.5531660692951021,1.1947431302270006,0.9557945041816005,0.59737156511350165,0.35842293906810019,0,0],"text":["Sample: S11B<br />Abundance:  6.81003584<br />Tax: Unknown","Sample: S2S<br />Abundance:  5.97371565<br />Tax: Unknown","Sample: S8S<br />Abundance:  5.01792115<br />Tax: Unknown","Sample: S7S<br />Abundance:  3.70370370<br />Tax: Unknown","Sample: S6B<br />Abundance:  2.86738351<br />Tax: Unknown","Sample: S3S<br />Abundance:  2.50896057<br />Tax: Unknown","Sample: S4S<br />Abundance:  2.27001195<br />Tax: Unknown","Sample: S2B<br />Abundance:  2.15053763<br />Tax: Unknown","Sample: S5B<br />Abundance:  2.03106332<br />Tax: Unknown","Sample: S3B<br />Abundance:  1.91158901<br />Tax: Unknown","Sample: S7B<br />Abundance:  1.79211470<br />Tax: Unknown","Sample: S1B<br />Abundance:  1.55316607<br />Tax: Unknown","Sample: S8B<br />Abundance:  1.19474313<br />Tax: Unknown","Sample: S9B<br />Abundance:  0.95579450<br />Tax: Unknown","Sample: S4B<br />Abundance:  0.59737157<br />Tax: Unknown","Sample: S5S<br />Abundance:  0.35842294<br />Tax: Unknown","Sample: S6S<br />Abundance:  0.00000000<br />Tax: Unknown","Sample: S9S<br />Abundance:  0.00000000<br />Tax: Unknown"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,166,255,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Unknown","legendgroup":"Unknown","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999858,0.90000000000000036,0.89999999999999858,0.90000000000000036,0.89999999999999991,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.89999999999999858,0.90000000000000036,0.89999999999999947,0.89999999999999858,0.89999999999999858],"base":[1.7921146953405018,2.150537634408602,6.3321385902031064,1.9115890083632019,4.1816009557945044,5.7347670250896057,2.6284348864994027,4.0621266427718048,3.3452807646356035,2.7479091995221028,1.5531660692951015,7.5268817204301079,1.6726403823178018,3.106332138590203,0,5.376344086021505,2.8673835125448028,5.0179211469534053],"x":[18,3,10,4,1,15,14,13,16,11,2,6,5,17,7,8,9,12],"y":[4.6594982078853047,4.301075268817204,4.1816009557945044,3.8231780167264038,3.7037037037037042,3.3452807646356026,2.7479091995221032,2.150537634408602,1.9115890083632019,1.7921146953405014,1.6726403823178015,1.4336917562724008,0.83632019115890088,0.47789725209080069,0.11947431302270012,0,0,0],"text":["Sample: S11B<br />Abundance:  4.65949821<br />Tax: Flavobacteriales","Sample: S2S<br />Abundance:  4.30107527<br />Tax: Flavobacteriales","Sample: S6B<br />Abundance:  4.18160096<br />Tax: Flavobacteriales","Sample: S3B<br />Abundance:  3.82317802<br />Tax: Flavobacteriales","Sample: S1B<br />Abundance:  3.70370370<br />Tax: Flavobacteriales","Sample: S8S<br />Abundance:  3.34528076<br />Tax: Flavobacteriales","Sample: S8B<br />Abundance:  2.74790920<br />Tax: Flavobacteriales","Sample: S7S<br />Abundance:  2.15053763<br />Tax: Flavobacteriales","Sample: S9B<br />Abundance:  1.91158901<br />Tax: Flavobacteriales","Sample: S6S<br />Abundance:  1.79211470<br />Tax: Flavobacteriales","Sample: S2B<br />Abundance:  1.67264038<br />Tax: Flavobacteriales","Sample: S4B<br />Abundance:  1.43369176<br />Tax: Flavobacteriales","Sample: S3S<br />Abundance:  0.83632019<br />Tax: Flavobacteriales","Sample: S9S<br />Abundance:  0.47789725<br />Tax: Flavobacteriales","Sample: S4S<br />Abundance:  0.11947431<br />Tax: Flavobacteriales","Sample: S5B<br />Abundance:  0.00000000<br />Tax: Flavobacteriales","Sample: S5S<br />Abundance:  0.00000000<br />Tax: Flavobacteriales","Sample: S7B<br />Abundance:  0.00000000<br />Tax: Flavobacteriales"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(179,133,255,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Flavobacteriales","legendgroup":"Flavobacteriales","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000036,0.89999999999999858,0.89999999999999947,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[1.1947431302270013,1.4336917562724014,2.031063321385902,3.106332138590203,0,2.2700119474313025,0,0,1.1947431302270013,2.1505376344086025,1.5531660692951015,1.4336917562724014,1.4336917562724014,1.3142174432497014,4.1816009557945044,1.5531660692951015,1.9115890083632019,0],"x":[6,15,8,10,17,12,14,3,16,13,9,11,18,5,1,2,4,7],"y":[6.3321385902031064,4.301075268817204,3.3452807646356031,3.2258064516129035,3.106332138590203,2.7479091995221028,2.6284348864994027,2.150537634408602,2.150537634408602,1.9115890083632023,1.3142174432497014,1.3142174432497014,0.35842293906810041,0.35842293906810041,0,0,0,0],"text":["Sample: S4B<br />Abundance:  6.33213859<br />Tax: Chloroplast","Sample: S8S<br />Abundance:  4.30107527<br />Tax: Chloroplast","Sample: S5B<br />Abundance:  3.34528076<br />Tax: Chloroplast","Sample: S6B<br />Abundance:  3.22580645<br />Tax: Chloroplast","Sample: S9S<br />Abundance:  3.10633214<br />Tax: Chloroplast","Sample: S7B<br />Abundance:  2.74790920<br />Tax: Chloroplast","Sample: S8B<br />Abundance:  2.62843489<br />Tax: Chloroplast","Sample: S2S<br />Abundance:  2.15053763<br />Tax: Chloroplast","Sample: S9B<br />Abundance:  2.15053763<br />Tax: Chloroplast","Sample: S7S<br />Abundance:  1.91158901<br />Tax: Chloroplast","Sample: S5S<br />Abundance:  1.31421744<br />Tax: Chloroplast","Sample: S6S<br />Abundance:  1.31421744<br />Tax: Chloroplast","Sample: S11B<br />Abundance:  0.35842294<br />Tax: Chloroplast","Sample: S3S<br />Abundance:  0.35842294<br />Tax: Chloroplast","Sample: S1B<br />Abundance:  0.00000000<br />Tax: Chloroplast","Sample: S2B<br />Abundance:  0.00000000<br />Tax: Chloroplast","Sample: S3B<br />Abundance:  0.00000000<br />Tax: Chloroplast","Sample: S4S<br />Abundance:  0.00000000<br />Tax: Chloroplast"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(239,103,235,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Chloroplast","legendgroup":"Chloroplast","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999947,0.90000000000000036,0.90000000000000013,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.90000000000000036,0.89999999999999858,0.90000000000000036,0.90000000000000036,0.89999999999999858,0.89999999999999858],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,10,12,13,8,4,2,9,18,11,15,5,6,16,3,7,14,17],"y":[4.1816009557945044,3.106332138590203,2.2700119474313025,2.1505376344086025,2.031063321385902,1.9115890083632019,1.5531660692951015,1.5531660692951015,1.4336917562724014,1.4336917562724014,1.4336917562724014,1.3142174432497014,1.1947431302270013,1.1947431302270013,0,0,0,0],"text":["Sample: S1B<br />Abundance:  4.18160096<br />Tax: Rhodobacterales","Sample: S6B<br />Abundance:  3.10633214<br />Tax: Rhodobacterales","Sample: S7B<br />Abundance:  2.27001195<br />Tax: Rhodobacterales","Sample: S7S<br />Abundance:  2.15053763<br />Tax: Rhodobacterales","Sample: S5B<br />Abundance:  2.03106332<br />Tax: Rhodobacterales","Sample: S3B<br />Abundance:  1.91158901<br />Tax: Rhodobacterales","Sample: S2B<br />Abundance:  1.55316607<br />Tax: Rhodobacterales","Sample: S5S<br />Abundance:  1.55316607<br />Tax: Rhodobacterales","Sample: S11B<br />Abundance:  1.43369176<br />Tax: Rhodobacterales","Sample: S6S<br />Abundance:  1.43369176<br />Tax: Rhodobacterales","Sample: S8S<br />Abundance:  1.43369176<br />Tax: Rhodobacterales","Sample: S3S<br />Abundance:  1.31421744<br />Tax: Rhodobacterales","Sample: S4B<br />Abundance:  1.19474313<br />Tax: Rhodobacterales","Sample: S9B<br />Abundance:  1.19474313<br />Tax: Rhodobacterales","Sample: S2S<br />Abundance:  0.00000000<br />Tax: Rhodobacterales","Sample: S4S<br />Abundance:  0.00000000<br />Tax: Rhodobacterales","Sample: S8B<br />Abundance:  0.00000000<br />Tax: Rhodobacterales","Sample: S9S<br />Abundance:  0.00000000<br />Tax: Rhodobacterales"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,99,182,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Rhodobacterales","legendgroup":"Rhodobacterales","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283104,"r":7.3059360730593621,"b":54.794520547945218,"l":43.105022831050235},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,18.600000000000001],"tickmode":"array","ticktext":["North4S","North3B","North4B","South4S","North2B","North2S","South3S","North1B","North3S","North5B","South5B","South4B","North5S","South1B","South3B","South2S","South2B","South1S"],"tickvals":[7,4,5.9999999999999991,17,2,3,15,1,5,8,18,16,9,10,14,13,12,11],"categoryorder":"array","categoryarray":["North4S","North3B","North4B","South4S","North2B","North2S","South3S","North1B","North3S","North5B","South5B","South4B","North5S","South1B","South3B","South2S","South2B","South1S"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-90,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-4.9880525686977304,104.74910394265233],"tickmode":"array","ticktext":["0","25","50","75","100"],"tickvals":[0,25,50.000000000000007,75,100],"categoryorder":"array","categoryarray":["0","25","50","75","100"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Relative abundance (%)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Tax","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"25aa578d291dd":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"25aa578d291dd","visdat":{"25aa578d291dd":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="how-to-manage-colors-in-barplots" class="level3" data-number="7.2.4">
<h3 data-number="7.2.4" class="anchored" data-anchor-id="how-to-manage-colors-in-barplots"><span class="header-section-number">7.2.4</span> How to manage colors in barplots</h3>
<p>With the number of Phyla, Order etc a barplot can become very confusing Need to have distinct color for each taxonomic groups.</p>
<p>Use the library <code>RColorBrewer</code> et <code>scale_fill_manual()</code> See <a href="https://www.nceas.ucsb.edu/sites/default/files/2020-04/colorPaletteCheatsheet.pdf">here</a> to understand the possibilities</p>
<p>You can visualise <code>RColorBrewer</code>s palettes with the following command:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>RColorBrewer<span class="sc">::</span><span class="fu">display.brewer.all</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="build-your-own-palette" class="level3" data-number="7.2.5">
<h3 data-number="7.2.5" class="anchored" data-anchor-id="build-your-own-palette"><span class="header-section-number">7.2.5</span> Build your own palette</h3>
<p>Lets assemble from two RColorBrewers palettes a single 13 colors palette</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">#See Set2 colors</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>(col1 <span class="ot">&lt;-</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="at">name =</span> <span class="st">"Set2"</span>, <span class="at">n =</span> <span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "#66C2A5" "#FC8D62" "#8DA0CB" "#E78AC3" "#A6D854" "#FFD92F" "#E5C494"
[8] "#B3B3B3"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co">#See  Paired colors </span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>(col2 <span class="ot">&lt;-</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="at">name =</span> <span class="st">"Paired"</span>, <span class="at">n =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "#A6CEE3" "#1F78B4" "#B2DF8A" "#33A02C" "#FB9A99"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Build your set of colors using brewer.pal or your own colors</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>mycolors <span class="ot">&lt;-</span> <span class="fu">c</span>(col1, col2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="use-your-palette-in-the-p_order-barplot" class="level3" data-number="7.2.6">
<h3 data-number="7.2.6" class="anchored" data-anchor-id="use-your-palette-in-the-p_order-barplot"><span class="header-section-number">7.2.6</span> Use your palette in the p_order barplot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Use scale_fill_manual</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>p_order <span class="sc">+</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="st">"Order"</span>, <span class="at">values =</span> mycolors) <span class="sc">+</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="other-data-manipulation-select-specific-taxa-merge-samples" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="other-data-manipulation-select-specific-taxa-merge-samples"><span class="header-section-number">7.3</span> Other data Manipulation : select specific taxa, merge samples</h2>
<section id="select-actinobacteria-and-bacteroidetes-phyloseqsubset_taxa" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="select-actinobacteria-and-bacteroidetes-phyloseqsubset_taxa"><span class="header-section-number">7.3.1</span> Select Actinobacteria AND Bacteroidetes: <code>phyloseq::subset_taxa()</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>myselection1 <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">subset_taxa</span>(Phylum_glom, Phylum <span class="sc">==</span> <span class="st">"Actinobacteriota"</span> <span class="sc">|</span> Phylum <span class="sc">==</span> <span class="st">"Bacteroidota"</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">plot_bar</span>(myselection1, <span class="at">x =</span> <span class="st">"Description"</span>, <span class="at">fill =</span> <span class="st">"Phylum"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">plot_bar</span>(myselection1, <span class="at">x =</span> <span class="st">"Description"</span>,</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill=</span><span class="st">"Phylum"</span>, <span class="at">facet_grid =</span> <span class="sc">~</span>Phylum) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="keep-all-with-the-exception-of-a-class-a-genus-etc-e.g.-contamination" class="level3" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="keep-all-with-the-exception-of-a-class-a-genus-etc-e.g.-contamination"><span class="header-section-number">7.3.2</span> Keep all with the exception of a class, a genus etc (e.g.&nbsp;contamination)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>myselection2 <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">subset_taxa</span>(physeq, Class <span class="sc">!=</span> <span class="st">"Thermoplasmata"</span> <span class="sc">|</span> <span class="fu">is.na</span>(Class))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="understand" class="level3" data-number="7.3.3">
<h3 data-number="7.3.3" class="anchored" data-anchor-id="understand"><span class="header-section-number">7.3.3</span> Understand:</h3>
<p><span style="color: red;">!</span> <span style="color: steelblue;"><strong>= means IS NOT</strong></span></p>
<p><span style="color: red;">|</span> <span style="color: steelblue;"><strong>= AND</strong></span></p>
<p><span style="color: red;">Is.na</span> <span style="color: steelblue;"> <strong>= do not remove the NA (Not Assigned at the Class rank), by default it will be removed. be careful</strong>!</span></p>
</section>
<section id="merge-samples-groups-duplicates-etc" class="level3" data-number="7.3.4">
<h3 data-number="7.3.4" class="anchored" data-anchor-id="merge-samples-groups-duplicates-etc"><span class="header-section-number">7.3.4</span> Merge samples (groups, duplicates etc)</h3>
<p>Use a column from metadata to group/merge samples (North &amp; South)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>(NordSud <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">merge_samples</span>(physeq_rar, <span class="st">"Geo"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in asMethod(object): NAs introduits lors de la conversion automatique

Warning in asMethod(object): NAs introduits lors de la conversion automatique

Warning in asMethod(object): NAs introduits lors de la conversion automatique

Warning in asMethod(object): NAs introduits lors de la conversion automatique</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 209 taxa and 2 samples ]
sample_data() Sample Data:       [ 2 samples by 29 sample variables ]
tax_table()   Taxonomy Table:    [ 209 taxa by 7 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 209 tips and 208 internal nodes ]</code></pre>
</div>
</div>
</section>
<section id="sample-selection-phyloseqsubset_samples" class="level3" data-number="7.3.5">
<h3 data-number="7.3.5" class="anchored" data-anchor-id="sample-selection-phyloseqsubset_samples"><span class="header-section-number">7.3.5</span> Sample selection: <code>phyloseq::subset_samples()</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>(sub_North <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">subset_samples</span>(pourcentS, Geo <span class="sc">==</span> <span class="st">"North"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 209 taxa and 9 samples ]
sample_data() Sample Data:       [ 9 samples by 29 sample variables ]
tax_table()   Taxonomy Table:    [ 209 taxa by 7 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 209 tips and 208 internal nodes ]
refseq()      DNAStringSet:      [ 209 reference sequences ]</code></pre>
</div>
</div>
</section>
<section id="alternative-way-phyloseqprune_samples" class="level3" data-number="7.3.6">
<h3 data-number="7.3.6" class="anchored" data-anchor-id="alternative-way-phyloseqprune_samples"><span class="header-section-number">7.3.6</span> Alternative way: <code>phyloseq::prune_samples</code></h3>
<p>Define what you want to keep</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>keep <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"S1B"</span>, <span class="st">"S2S"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then extract these samples from pourcentS phyloseq object</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>keep2samples <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">prune_samples</span>(keep, pourcentS)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_names</span>(keep2samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "S1B" "S2S"</code></pre>
</div>
</div>
</section>
</section>
<section id="retrieve-sequences-from-a-phyloseq-object" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="retrieve-sequences-from-a-phyloseq-object"><span class="header-section-number">7.4</span> Retrieve sequences from a phyloseq object</h2>
<section id="one-sequence" class="level3" data-number="7.4.1">
<h3 data-number="7.4.1" class="anchored" data-anchor-id="one-sequence"><span class="header-section-number">7.4.1</span> One sequence:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>Biostrings<span class="sc">::</span><span class="fu">writeXStringSet</span>(physeq_rar<span class="sc">@</span>refseq[<span class="st">"ASV1"</span>],</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">filepath =</span> <span class="fu">file.path</span>(output_alpha,<span class="st">"ASV1.fasta"</span>),</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">format =</span> <span class="st">"fasta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="by-name" class="level3" data-number="7.4.2">
<h3 data-number="7.4.2" class="anchored" data-anchor-id="by-name"><span class="header-section-number">7.4.2</span> By name</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>listASV <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ASV2"</span>, <span class="st">"ASV8"</span>, <span class="st">"ASV32"</span>, <span class="st">"ASV58"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>Biostrings<span class="sc">::</span><span class="fu">writeXStringSet</span>(physeq_rar<span class="sc">@</span>refseq[listASV],</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">filepath =</span> <span class="fu">file.path</span>(output_alpha,<span class="st">"several_asvs.fasta"</span>),</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">format =</span> <span class="st">"fasta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="from-a-selection" class="level3" data-number="7.4.3">
<h3 data-number="7.4.3" class="anchored" data-anchor-id="from-a-selection"><span class="header-section-number">7.4.3</span> From a selection</h3>
<p>Lets export a fasta files of all ASVs with a maximum relative abundance superior to 10% in North samples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">subset_samples</span>(pourcentS, Geo <span class="sc">==</span> <span class="st">"North"</span>) <span class="sc">|&gt;</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  phyloseq<span class="sc">::</span><span class="fu">filter_taxa</span>(<span class="at">flist =</span> <span class="cf">function</span>(x) <span class="fu">max</span>(x) <span class="sc">&gt;=</span> <span class="dv">10</span>, <span class="at">prune =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  phyloseq<span class="sc">::</span><span class="fu">refseq</span>() <span class="sc">|&gt;</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  Biostrings<span class="sc">::</span><span class="fu">writeXStringSet</span>(</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">filepath =</span> <span class="fu">file.path</span>(output_alpha, <span class="st">"fancy_selection_asvs.fasta"</span>),</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">format =</span> <span class="st">"fasta"</span></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="retrieve-all-sequences" class="level3" data-number="7.4.4">
<h3 data-number="7.4.4" class="anchored" data-anchor-id="retrieve-all-sequences"><span class="header-section-number">7.4.4</span> Retrieve all sequences</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>Biostrings<span class="sc">::</span><span class="fu">writeXStringSet</span>(physeq_rar<span class="sc">@</span>refseq,</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">filepath =</span> <span class="fu">file.path</span>(output_alpha,<span class="st">"all_asvs.fasta"</span>),</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">format =</span> <span class="st">"fasta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="core-microbiota-analysis" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Core microbiota analysis</h1>
<p><strong>Identify the taxa names of the core microbiota</strong></p>
<section id="which-core-compare-north-south-core-microbiota" class="level3" data-number="8.0.1">
<h3 data-number="8.0.1" class="anchored" data-anchor-id="which-core-compare-north-south-core-microbiota"><span class="header-section-number">8.0.1</span> Which core? Compare North &amp; South core microbiota</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create 2 phyloseq objects for North and South sample groups</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>sub_North <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">subset_samples</span>(pourcentS, Geo <span class="sc">==</span> <span class="st">"North"</span>)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>sub_South <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">subset_samples</span>(pourcentS, Geo <span class="sc">==</span> <span class="st">"South"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check group North ok</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>sub_North<span class="sc">@</span>sam_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    SampName   Geo Description groupe Pres PicoEuk Synec Prochloro NanoEuk
S1B      S1B North     North1B    NBF   52     660 32195     10675     955
S2B      S2B North     North2B    NBF   59     890 25480     16595     670
S2S      S2S North     North2S    NBS    0     890 25480     16595     670
S3B      S3B North     North3B    NBF   74     835 13340     25115    1115
S3S      S3S North     North3S    NBS    0     715 26725     16860     890
S4B      S4B North     North4B    NBF   78    2220  3130     29835    2120
S4S      S4S North     North4S    NBS   78    2220  3130     29835    2120
S5B      S5B North     North5B    NBF   42    1620 55780     23795    2555
S5S      S5S North     North5S    NBS    0    1620 56555     22835    2560
    Crypto SiOH4   NO2   NO3   NH4   PO4    NT    PT   Chla       T       S
S1B    115 1.813 0.256 0.889 0.324 0.132 9.946 3.565 0.0000 22.7338 37.6204
S2B    395 2.592 0.105 1.125 0.328 0.067 9.378 3.391 0.0000 22.6824 37.6627
S2S    395 3.381 0.231 0.706 0.450 0.109 8.817 3.345 0.0000 22.6854 37.6176
S3B    165 1.438 0.057 1.159 0.369 0.174 8.989 2.568 0.0000 21.5296 37.5549
S3S    200 1.656 0.098 0.794 0.367 0.095 7.847 2.520 0.0000 22.5610 37.5960
S4B    235 2.457 0.099 1.087 0.349 0.137 8.689 3.129 0.0000 18.8515 37.4542
S4S    235 2.457 0.099 1.087 0.349 0.137 8.689 3.129 0.0000 18.8515 37.4542
S5B   1355 2.028 0.103 1.135 0.216 0.128 8.623 3.137 0.0102 24.1905 38.3192
S5S    945 2.669 0.136 0.785 0.267 0.114 9.146 3.062 0.0000 24.1789 38.3213
    Sigma_t observed diversity_gini_simpson diversity_shannon evenness_pielou
S1B 26.0046       35             0.94779244         3.1777661      0.89379888
S2B 26.0521       43             0.95777575         3.4080222      0.90609969
S2S 26.0137       36             0.94145759         3.1120657      0.86843848
S3B 26.2987       41             0.95039889         3.2759058      0.88214412
S3S 26.0332       38             0.94913135         3.2468023      0.89257055
S4B 26.9415       40             0.95702493         3.3506939      0.90832296
S4S 26.9415       40             0.93634460         3.0974738      0.83967878
S5B 26.1037       32             0.92715778         2.9785407      0.85942517
S5S 26.1065       33             0.92532499         2.9933406      0.85609441
    dominance_relative         NRI           NTI        PD
S1B        0.102747909  1.17623968 -0.7634036100 3.3155461
S2B        0.096774194 -0.26125740 -0.6647458642 3.6970066
S2S        0.109916368 -2.45515064 -0.7418024886 3.4222234
S3B        0.109916368  0.62045110 -1.2987453680 3.6834814
S3S        0.109916368 -0.14108530 -0.7345369499 3.4403182
S4B        0.087216249 -0.48556229  0.0045554178 3.3171476
S4S        0.143369176  1.77346210 -0.9136191708 3.4365770
S5B        0.166069295  0.15698400  0.1315279847 2.9592082
S5S        0.188769415 -0.13425169  1.8924504384 2.4738611</code></pre>
</div>
</div>
</section>
<section id="change-first-column-name-of-taxonomy-rank" class="level3" data-number="8.0.2">
<h3 data-number="8.0.2" class="anchored" data-anchor-id="change-first-column-name-of-taxonomy-rank"><span class="header-section-number">8.0.2</span> Change first column name of taxonomy rank</h3>
<p>Replace Kingdom by Domain, needed for the use of add_best function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Before</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(sub_North<span class="sc">@</span>tax_table)[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Kingdom"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Apply change for North</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(sub_North<span class="sc">@</span>tax_table)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Domain"</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="co">#See </span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(sub_North<span class="sc">@</span>tax_table)[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Domain"</code></pre>
</div>
</div>
</section>
<section id="add-the-lowest-taxonomy-classification" class="level3" data-number="8.0.3">
<h3 data-number="8.0.3" class="anchored" data-anchor-id="add-the-lowest-taxonomy-classification"><span class="header-section-number">8.0.3</span> Add the lowest taxonomy classification</h3>
<p>https://rdrr.io/github/microbiome/microbiome/man/add_besthit.html</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>sub_North <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">add_besthit</span>(sub_North, <span class="at">sep =</span> <span class="st">":"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="see-the-transformation-of-tax_table" class="level3" data-number="8.0.4">
<h3 data-number="8.0.4" class="anchored" data-anchor-id="see-the-transformation-of-tax_table"><span class="header-section-number">8.0.4</span> See the transformation of tax_table</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sub_North<span class="sc">@</span>tax_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Taxonomy Table:     [6 taxa by 7 taxonomic ranks]:
                          Domain     Phylum             Class                
ASV1:Synechococcus CC9902 "Bacteria" "Cyanobacteria"    "Cyanobacteriia"     
ASV2:Pseudoalteromonas    "Bacteria" "Proteobacteria"   "Gammaproteobacteria"
ASV3:Clade Ia             "Bacteria" "Proteobacteria"   "Alphaproteobacteria"
ASV4:Marine Group II      "Archaea"  "Thermoplasmatota" "Thermoplasmata"     
ASV5:Clade Ia             "Bacteria" "Proteobacteria"   "Alphaproteobacteria"
ASV6:Clade II             "Bacteria" "Proteobacteria"   "Alphaproteobacteria"
                          Order              Family                  
ASV1:Synechococcus CC9902 "Synechococcales"  "Cyanobiaceae"          
ASV2:Pseudoalteromonas    "Enterobacterales" "Pseudoalteromonadaceae"
ASV3:Clade Ia             "SAR11 clade"      "Clade I"               
ASV4:Marine Group II      "Marine Group II"  NA                      
ASV5:Clade Ia             "SAR11 clade"      "Clade I"               
ASV6:Clade II             "SAR11 clade"      "Clade II"              
                          Genus                  Species
ASV1:Synechococcus CC9902 "Synechococcus CC9902" NA     
ASV2:Pseudoalteromonas    "Pseudoalteromonas"    NA     
ASV3:Clade Ia             "Clade Ia"             NA     
ASV4:Marine Group II      NA                     NA     
ASV5:Clade Ia             "Clade Ia"             NA     
ASV6:Clade II             NA                     NA     </code></pre>
</div>
</div>
</section>
<section id="identify-core-microbiota" class="level3" data-number="8.0.5">
<h3 data-number="8.0.5" class="anchored" data-anchor-id="identify-core-microbiota"><span class="header-section-number">8.0.5</span> Identify Core microbiota</h3>
<p>https://rdrr.io/github/microbiome/microbiome/man/core_members.html</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co">#North</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>(core_taxa_north <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">core_members</span>(sub_North,</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">detection =</span> <span class="fl">0.0001</span>,</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">prevalence =</span> <span class="dv">50</span><span class="sc">/</span><span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "ASV1:Synechococcus CC9902"            
 [2] "ASV2:Pseudoalteromonas"               
 [3] "ASV3:Clade Ia"                        
 [4] "ASV4:Marine Group II"                 
 [5] "ASV5:Clade Ia"                        
 [6] "ASV6:Clade II"                        
 [7] "ASV9:Clade Ia"                        
 [8] "ASV10:Clade Ia"                       
 [9] "ASV11:AEGEAN-169 marine group"        
[10] "ASV12:Prochlorococcus MIT9313.marinus"
[11] "ASV16:AEGEAN-169 marine group"        
[12] "ASV18:Clade Ib"                       
[13] "ASV22:Clade Ia"                       
[14] "ASV23:Clade Ia"                       
[15] "ASV26:Chloroplast"                    
[16] "ASV30:Marine Group II"                
[17] "ASV32:Dadabacteriales"                
[18] "ASV33:SAR324 clade(Marine group B)"   
[19] "ASV35:Clade IV"                       
[20] "ASV37:Marine Group III"               
[21] "ASV49:SAR202 clade"                   
[22] "ASV53:AEGEAN-169 marine group"        </code></pre>
</div>
</div>
</section>
<section id="get-core-microbiota-phyloseq-object" class="level3" data-number="8.0.6">
<h3 data-number="8.0.6" class="anchored" data-anchor-id="get-core-microbiota-phyloseq-object"><span class="header-section-number">8.0.6</span> Get core microbiota phyloseq object</h3>
<p>Get the phyloseq object with also sequences, phylo tree etc.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>(phyloseq_core_north <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">core</span>(sub_North,</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">detection =</span> <span class="fl">0.0001</span>,</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">prevalence =</span> .<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 22 taxa and 9 samples ]
sample_data() Sample Data:       [ 9 samples by 29 sample variables ]
tax_table()   Taxonomy Table:    [ 22 taxa by 7 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 22 tips and 21 internal nodes ]
refseq()      DNAStringSet:      [ 22 reference sequences ]</code></pre>
</div>
</div>
<p>See full taxanomy of core members</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>(tax_mat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(phyloseq<span class="sc">::</span><span class="fu">tax_table</span>(phyloseq_core_north)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                        Domain                       Phylum
ASV1:Synechococcus CC9902             Bacteria                Cyanobacteria
ASV2:Pseudoalteromonas                Bacteria               Proteobacteria
ASV3:Clade Ia                         Bacteria               Proteobacteria
ASV4:Marine Group II                   Archaea             Thermoplasmatota
ASV5:Clade Ia                         Bacteria               Proteobacteria
ASV6:Clade II                         Bacteria               Proteobacteria
ASV9:Clade Ia                         Bacteria               Proteobacteria
ASV10:Clade Ia                        Bacteria               Proteobacteria
ASV11:AEGEAN-169 marine group         Bacteria               Proteobacteria
ASV12:Prochlorococcus MIT9313.marinus Bacteria                Cyanobacteria
ASV16:AEGEAN-169 marine group         Bacteria               Proteobacteria
ASV18:Clade Ib                        Bacteria               Proteobacteria
ASV22:Clade Ia                        Bacteria               Proteobacteria
ASV23:Clade Ia                        Bacteria               Proteobacteria
ASV26:Chloroplast                     Bacteria                Cyanobacteria
ASV30:Marine Group II                  Archaea             Thermoplasmatota
ASV32:Dadabacteriales                 Bacteria                 Dadabacteria
ASV33:SAR324 clade(Marine group B)    Bacteria SAR324 clade(Marine group B)
ASV35:Clade IV                        Bacteria               Proteobacteria
ASV37:Marine Group III                 Archaea             Thermoplasmatota
ASV49:SAR202 clade                    Bacteria                  Chloroflexi
ASV53:AEGEAN-169 marine group         Bacteria               Proteobacteria
                                                    Class            Order
ASV1:Synechococcus CC9902                  Cyanobacteriia  Synechococcales
ASV2:Pseudoalteromonas                Gammaproteobacteria Enterobacterales
ASV3:Clade Ia                         Alphaproteobacteria      SAR11 clade
ASV4:Marine Group II                       Thermoplasmata  Marine Group II
ASV5:Clade Ia                         Alphaproteobacteria      SAR11 clade
ASV6:Clade II                         Alphaproteobacteria      SAR11 clade
ASV9:Clade Ia                         Alphaproteobacteria      SAR11 clade
ASV10:Clade Ia                        Alphaproteobacteria      SAR11 clade
ASV11:AEGEAN-169 marine group         Alphaproteobacteria Rhodospirillales
ASV12:Prochlorococcus MIT9313.marinus      Cyanobacteriia  Synechococcales
ASV16:AEGEAN-169 marine group         Alphaproteobacteria Rhodospirillales
ASV18:Clade Ib                        Alphaproteobacteria      SAR11 clade
ASV22:Clade Ia                        Alphaproteobacteria      SAR11 clade
ASV23:Clade Ia                        Alphaproteobacteria      SAR11 clade
ASV26:Chloroplast                          Cyanobacteriia      Chloroplast
ASV30:Marine Group II                      Thermoplasmata  Marine Group II
ASV32:Dadabacteriales                       Dadabacteriia  Dadabacteriales
ASV33:SAR324 clade(Marine group B)                   &lt;NA&gt;             &lt;NA&gt;
ASV35:Clade IV                        Alphaproteobacteria      SAR11 clade
ASV37:Marine Group III                     Thermoplasmata Marine Group III
ASV49:SAR202 clade                        Dehalococcoidia     SAR202 clade
ASV53:AEGEAN-169 marine group         Alphaproteobacteria Rhodospirillales
                                                       Family
ASV1:Synechococcus CC9902                        Cyanobiaceae
ASV2:Pseudoalteromonas                 Pseudoalteromonadaceae
ASV3:Clade Ia                                         Clade I
ASV4:Marine Group II                                     &lt;NA&gt;
ASV5:Clade Ia                                         Clade I
ASV6:Clade II                                        Clade II
ASV9:Clade Ia                                         Clade I
ASV10:Clade Ia                                        Clade I
ASV11:AEGEAN-169 marine group         AEGEAN-169 marine group
ASV12:Prochlorococcus MIT9313.marinus            Cyanobiaceae
ASV16:AEGEAN-169 marine group         AEGEAN-169 marine group
ASV18:Clade Ib                                        Clade I
ASV22:Clade Ia                                        Clade I
ASV23:Clade Ia                                        Clade I
ASV26:Chloroplast                                        &lt;NA&gt;
ASV30:Marine Group II                                    &lt;NA&gt;
ASV32:Dadabacteriales                                    &lt;NA&gt;
ASV33:SAR324 clade(Marine group B)                       &lt;NA&gt;
ASV35:Clade IV                                       Clade IV
ASV37:Marine Group III                                   &lt;NA&gt;
ASV49:SAR202 clade                                       &lt;NA&gt;
ASV53:AEGEAN-169 marine group         AEGEAN-169 marine group
                                                        Genus Species
ASV1:Synechococcus CC9902                Synechococcus CC9902    &lt;NA&gt;
ASV2:Pseudoalteromonas                      Pseudoalteromonas    &lt;NA&gt;
ASV3:Clade Ia                                        Clade Ia    &lt;NA&gt;
ASV4:Marine Group II                                     &lt;NA&gt;    &lt;NA&gt;
ASV5:Clade Ia                                        Clade Ia    &lt;NA&gt;
ASV6:Clade II                                            &lt;NA&gt;    &lt;NA&gt;
ASV9:Clade Ia                                        Clade Ia    &lt;NA&gt;
ASV10:Clade Ia                                       Clade Ia    &lt;NA&gt;
ASV11:AEGEAN-169 marine group                            &lt;NA&gt;    &lt;NA&gt;
ASV12:Prochlorococcus MIT9313.marinus Prochlorococcus MIT9313 marinus
ASV16:AEGEAN-169 marine group                            &lt;NA&gt;    &lt;NA&gt;
ASV18:Clade Ib                                       Clade Ib    &lt;NA&gt;
ASV22:Clade Ia                                       Clade Ia    &lt;NA&gt;
ASV23:Clade Ia                                       Clade Ia    &lt;NA&gt;
ASV26:Chloroplast                                        &lt;NA&gt;    &lt;NA&gt;
ASV30:Marine Group II                                    &lt;NA&gt;    &lt;NA&gt;
ASV32:Dadabacteriales                                    &lt;NA&gt;    &lt;NA&gt;
ASV33:SAR324 clade(Marine group B)                       &lt;NA&gt;    &lt;NA&gt;
ASV35:Clade IV                                           &lt;NA&gt;    &lt;NA&gt;
ASV37:Marine Group III                                   &lt;NA&gt;    &lt;NA&gt;
ASV49:SAR202 clade                                       &lt;NA&gt;    &lt;NA&gt;
ASV53:AEGEAN-169 marine group                            &lt;NA&gt;    &lt;NA&gt;</code></pre>
</div>
</div>
</section>
<section id="visualise-core-microbiome-with-microbiomeplot_core" class="level3" data-number="8.0.7">
<h3 data-number="8.0.7" class="anchored" data-anchor-id="visualise-core-microbiome-with-microbiomeplot_core"><span class="header-section-number">8.0.7</span> Visualise core microbiome with <code>microbiome::plot_core()</code></h3>
<p>Visualise the core microbiome of North samples</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>microbiome<span class="sc">::</span><span class="fu">plot_core</span>(phyloseq_core_north,</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">plot.type =</span> <span class="st">"heatmap"</span>,</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">colours =</span> <span class="fu">rev</span>(RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"RdBu"</span>)),</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">prevalences =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">1</span>),</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">detections =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.1</span>, <span class="at">to =</span> <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">n.dodge =</span> <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Detection Threshold (Relative Abundance (%))"</span>) <span class="sc">+</span></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"ASVs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in microbiome::plot_core(phyloseq_core_north, plot.type = "heatmap", : The plot_core function is typically used with compositional 
                data. The data is not compositional. Make sure that you
                intend to operate on non-compositional data.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Do the same for the South samples .. please!</p>
<p>What are your conclusions about the comparison between North &amp; South core micobiota at the ASV level?</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        console.log("RESIZE");
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("https:\/\/ANF-MetaBioDiv\.github\.io\/course-material\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p><a href="http://abims.sb-roscoff.fr/"><img src="../img/logo_abims.png" alt="ABiMS" height="35"></a> <a href="https://www.umr-beep.fr/"><img src="../img/logo_beep.png" alt="beep" height="40"></a> <a href="https://www.france-bioinformatique.fr/"><img src="../img/logo_ifb.png" alt="IFB" height="40"></a> <a href="https://www.cnrs.fr//"><img src="../img/logo_cnrs.svg" alt="CNRS" height="40"></a> <a href="https://www.ird.fr/"><img src="../img/logo_ird.png" alt="IRD" height="40"></a> <a href="https://www.mio.osupytheas.fr/"><img src="../img/logo_mio.png" alt="MIO" height="40"></a> <a href="https://umr-marbec.fr/"><img src="../img/logo_marbec.jpeg" alt="marbec" height="40"></a> <a href="https://umr-marbec.fr/"><img src="../img/logo_tara.png" alt="marbec" height="30"></a></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>