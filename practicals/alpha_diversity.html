<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ANF metabarcoding - PARTII_alpha_Diversity_ANF</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="../site_libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../site_libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../site_libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ANF metabarcoding</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">Home</a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-day-2" role="button" data-bs-toggle="dropdown" aria-expanded="false">Day 2</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-day-2">    
        <li class="dropdown-header">Courses</li>
        <li>
    <a class="dropdown-item" href="../courses/dada2.html">
 <span class="dropdown-text">Analysing metabarcoding data with dada2</span></a>
  </li>  
        <li class="dropdown-header">Practicals</li>
        <li>
    <a class="dropdown-item" href="../practicals/preprocessing_dada2.html">
 <span class="dropdown-text">Preprocessing: dada2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../practicals/preprocessing_dada2.html">
 <span class="dropdown-text">Preprocessing: phyloseq</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-day-3" role="button" data-bs-toggle="dropdown" aria-expanded="false">Day 3</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-day-3">    
        <li class="dropdown-header">Practicals</li>
        <li>
    <a class="dropdown-item" href="../practicals/alpha_diversity.html">
 <span class="dropdown-text">Alpha diversity</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-day-4" role="button" data-bs-toggle="dropdown" aria-expanded="false">Day 4</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-day-4">    
        <li class="dropdown-header">Practicals</li>
        <li>
    <a class="dropdown-item" href="../practicals/beta_diversity.html">
 <span class="dropdown-text">Beta diversity</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../about.html">About</a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/nhenry50/ANF-metabarcoding"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#prepare-workspace" id="toc-prepare-workspace" class="nav-link active" data-scroll-target="#prepare-workspace"> <span class="header-section-number">1</span> Prepare workspace</a></li>
  <li><a href="#data-structure" id="toc-data-structure" class="nav-link" data-scroll-target="#data-structure"> <span class="header-section-number">2</span> Data Structure</a>
  <ul class="collapse">
  <li><a href="#our-phyloseq-object-physeq-is-composed-of" id="toc-our-phyloseq-object-physeq-is-composed-of" class="nav-link" data-scroll-target="#our-phyloseq-object-physeq-is-composed-of"> <span class="header-section-number">2.1</span> Our phyloseq object <code>physeq</code> is composed of:</a>
  <ul class="collapse">
  <li><a href="#an-asv-table-with-the-absolute-counts" id="toc-an-asv-table-with-the-absolute-counts" class="nav-link" data-scroll-target="#an-asv-table-with-the-absolute-counts"> <span class="header-section-number">2.1.1</span> An ASV table with the absolute counts</a></li>
  <li><a href="#a-metadata-table-with-information-e.g.-physicochemical-categorical-variables-about-samples" id="toc-a-metadata-table-with-information-e.g.-physicochemical-categorical-variables-about-samples" class="nav-link" data-scroll-target="#a-metadata-table-with-information-e.g.-physicochemical-categorical-variables-about-samples"> <span class="header-section-number">2.1.2</span> A metadata table with information (e.g.&nbsp;physicochemical, categorical variables) about samples</a></li>
  <li><a href="#a-table-of-taxonomic-classification-of-each-asv" id="toc-a-table-of-taxonomic-classification-of-each-asv" class="nav-link" data-scroll-target="#a-table-of-taxonomic-classification-of-each-asv"> <span class="header-section-number">2.1.3</span> A table of Taxonomic classification of each ASV</a></li>
  <li><a href="#a-phylogenetic-tree" id="toc-a-phylogenetic-tree" class="nav-link" data-scroll-target="#a-phylogenetic-tree"> <span class="header-section-number">2.1.4</span> A Phylogenetic Tree</a></li>
  <li><a href="#a-table-with-the-asv-sequences" id="toc-a-table-with-the-asv-sequences" class="nav-link" data-scroll-target="#a-table-with-the-asv-sequences"> <span class="header-section-number">2.1.5</span> A table with the ASV Sequences</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#starting-with-some-basic-commands" id="toc-starting-with-some-basic-commands" class="nav-link" data-scroll-target="#starting-with-some-basic-commands"> <span class="header-section-number">3</span> Starting with some basic commands</a>
  <ul class="collapse">
  <li><a href="#get-the-total-number-of-asvs" id="toc-get-the-total-number-of-asvs" class="nav-link" data-scroll-target="#get-the-total-number-of-asvs"> <span class="header-section-number">3.1</span> Get the total number of ASVs</a></li>
  <li><a href="#get-the-total-number-of-samples" id="toc-get-the-total-number-of-samples" class="nav-link" data-scroll-target="#get-the-total-number-of-samples"> <span class="header-section-number">3.2</span> Get the total number of samples</a></li>
  <li><a href="#get-sample-names" id="toc-get-sample-names" class="nav-link" data-scroll-target="#get-sample-names"> <span class="header-section-number">3.3</span> Get sample names</a></li>
  <li><a href="#get-asv-identification" id="toc-get-asv-identification" class="nav-link" data-scroll-target="#get-asv-identification"> <span class="header-section-number">3.4</span> Get ASV identification</a></li>
  <li><a href="#get-the-names-of-variables-in-sam_data" id="toc-get-the-names-of-variables-in-sam_data" class="nav-link" data-scroll-target="#get-the-names-of-variables-in-sam_data"> <span class="header-section-number">3.5</span> Get the names of variables in sam_data</a></li>
  <li><a href="#display-all-variables-with-values" id="toc-display-all-variables-with-values" class="nav-link" data-scroll-target="#display-all-variables-with-values"> <span class="header-section-number">3.6</span> Display all variables with values</a></li>
  <li><a href="#sum-the-reads-by-sample" id="toc-sum-the-reads-by-sample" class="nav-link" data-scroll-target="#sum-the-reads-by-sample"> <span class="header-section-number">3.7</span> Sum the reads by sample</a></li>
  <li><a href="#sum-the-reads-by-speciestaxaotus-for-all-samples" id="toc-sum-the-reads-by-speciestaxaotus-for-all-samples" class="nav-link" data-scroll-target="#sum-the-reads-by-speciestaxaotus-for-all-samples"> <span class="header-section-number">3.8</span> Sum the reads by species/taxa/OTUs (for all samples)</a></li>
  <li><a href="#sort-speciestaxaotus-by-devreasing-number-of-reads" id="toc-sort-speciestaxaotus-by-devreasing-number-of-reads" class="nav-link" data-scroll-target="#sort-speciestaxaotus-by-devreasing-number-of-reads"> <span class="header-section-number">3.9</span> Sort species/taxa/OTUs by devreasing number of reads</a></li>
  <li><a href="#get-taxonomic-ranks" id="toc-get-taxonomic-ranks" class="nav-link" data-scroll-target="#get-taxonomic-ranks"> <span class="header-section-number">3.10</span> Get taxonomic ranks</a></li>
  <li><a href="#show-abundance-for-a-given-asv" id="toc-show-abundance-for-a-given-asv" class="nav-link" data-scroll-target="#show-abundance-for-a-given-asv"> <span class="header-section-number">3.11</span> Show abundance for a given ASV</a></li>
  <li><a href="#show-asvs-and-abundance-for-a-given-sample" id="toc-show-asvs-and-abundance-for-a-given-sample" class="nav-link" data-scroll-target="#show-asvs-and-abundance-for-a-given-sample"> <span class="header-section-number">3.12</span> Show ASVs and abundance for a given sample</a></li>
  <li><a href="#get-all-phyla-detected-in-your-samples" id="toc-get-all-phyla-detected-in-your-samples" class="nav-link" data-scroll-target="#get-all-phyla-detected-in-your-samples"> <span class="header-section-number">3.13</span> Get All phyla detected in your samples</a></li>
  <li><a href="#distribution-of-asvs-by-phylum-taxonomic-rank" id="toc-distribution-of-asvs-by-phylum-taxonomic-rank" class="nav-link" data-scroll-target="#distribution-of-asvs-by-phylum-taxonomic-rank"> <span class="header-section-number">3.14</span> Distribution of ASVs by phylum taxonomic rank</a></li>
  </ul></li>
  <li><a href="#subsampling-normalization" id="toc-subsampling-normalization" class="nav-link" data-scroll-target="#subsampling-normalization"> <span class="header-section-number">4</span> Subsampling normalization</a>
  <ul class="collapse">
  <li><a href="#rarefaction-curves" id="toc-rarefaction-curves" class="nav-link" data-scroll-target="#rarefaction-curves"> <span class="header-section-number">4.1</span> Rarefaction Curves</a>
  <ul class="collapse">
  <li><a href="#identify-your-minimum-sample-size" id="toc-identify-your-minimum-sample-size" class="nav-link" data-scroll-target="#identify-your-minimum-sample-size"> <span class="header-section-number">4.1.1</span> Identify your minimum sample size</a></li>
  <li><a href="#what-is-the-minimum-sample-size" id="toc-what-is-the-minimum-sample-size" class="nav-link" data-scroll-target="#what-is-the-minimum-sample-size"> <span class="header-section-number">4.1.2</span> What is the minimum sample size?</a></li>
  </ul></li>
  <li><a href="#normalization-process-for-alpha-diversity-sub-sampling" id="toc-normalization-process-for-alpha-diversity-sub-sampling" class="nav-link" data-scroll-target="#normalization-process-for-alpha-diversity-sub-sampling"> <span class="header-section-number">4.2</span> Normalization process for alpha diversity: sub-sampling</a></li>
  <li><a href="#run-rarefaction-curves-on-normalized-data" id="toc-run-rarefaction-curves-on-normalized-data" class="nav-link" data-scroll-target="#run-rarefaction-curves-on-normalized-data"> <span class="header-section-number">4.3</span> Run rarefaction curves on normalized data</a></li>
  <li><a href="#group-separation" id="toc-group-separation" class="nav-link" data-scroll-target="#group-separation"> <span class="header-section-number">4.4</span> Group separation</a></li>
  </ul></li>
  <li><a href="#alpha-diversity" id="toc-alpha-diversity" class="nav-link" data-scroll-target="#alpha-diversity"> <span class="header-section-number">5</span> Alpha Diversity</a>
  <ul class="collapse">
  <li><a href="#indices" id="toc-indices" class="nav-link" data-scroll-target="#indices"> <span class="header-section-number">5.1</span> Indices</a>
  <ul class="collapse">
  <li><a href="#get-taxonomy-based-diversity-indices" id="toc-get-taxonomy-based-diversity-indices" class="nav-link" data-scroll-target="#get-taxonomy-based-diversity-indices"> <span class="header-section-number">5.1.1</span> Get taxonomy-based diversity indices</a></li>
  <li><a href="#add-the-alpha-indices-result-to-your-metadata-sample_data-phyloseq-object" id="toc-add-the-alpha-indices-result-to-your-metadata-sample_data-phyloseq-object" class="nav-link" data-scroll-target="#add-the-alpha-indices-result-to-your-metadata-sample_data-phyloseq-object"> <span class="header-section-number">5.1.2</span> Add the alpha indices result to your metadata (sample_data) phyloseq object</a></li>
  <li><a href="#get-phylogeny-based-diversity-indices-get_nri_nti-function" id="toc-get-phylogeny-based-diversity-indices-get_nri_nti-function" class="nav-link" data-scroll-target="#get-phylogeny-based-diversity-indices-get_nri_nti-function"> <span class="header-section-number">5.1.3</span> Get phylogeny based diversity indices: get_NRI_NTI function</a></li>
  <li><a href="#again-add-the-phylogenetic-indices-to-your-metadata-sample_data-phyloseq-object" id="toc-again-add-the-phylogenetic-indices-to-your-metadata-sample_data-phyloseq-object" class="nav-link" data-scroll-target="#again-add-the-phylogenetic-indices-to-your-metadata-sample_data-phyloseq-object"> <span class="header-section-number">5.1.4</span> Again!!! Add the phylogenetic indices to your metadata (sample_data) phyloseq object</a></li>
  <li><a href="#importance-of-metadata-tablefile" id="toc-importance-of-metadata-tablefile" class="nav-link" data-scroll-target="#importance-of-metadata-tablefile"> <span class="header-section-number">5.1.5</span> Importance of metadata table/file</a></li>
  <li><a href="#add-my-own-variable-to-metadata" id="toc-add-my-own-variable-to-metadata" class="nav-link" data-scroll-target="#add-my-own-variable-to-metadata"> <span class="header-section-number">5.1.6</span> Add my own variable to metadata</a></li>
  </ul></li>
  <li><a href="#alpha-diversity-representations" id="toc-alpha-diversity-representations" class="nav-link" data-scroll-target="#alpha-diversity-representations"> <span class="header-section-number">5.2</span> Alpha diversity representations</a>
  <ul class="collapse">
  <li><a href="#alpha-representations-using-phyloseqplot_richness" id="toc-alpha-representations-using-phyloseqplot_richness" class="nav-link" data-scroll-target="#alpha-representations-using-phyloseqplot_richness"> <span class="header-section-number">5.2.1</span> Alpha representations using phyloseq::plot_richness()</a></li>
  <li><a href="#alpha-representations-using-microbiomeboxplot_alpha" id="toc-alpha-representations-using-microbiomeboxplot_alpha" class="nav-link" data-scroll-target="#alpha-representations-using-microbiomeboxplot_alpha"> <span class="header-section-number">5.2.2</span> Alpha representations using <code>Microbiome::boxplot_alpha</code></a></li>
  <li><a href="#alpha-representations-using-ggplot2" id="toc-alpha-representations-using-ggplot2" class="nav-link" data-scroll-target="#alpha-representations-using-ggplot2"> <span class="header-section-number">5.2.3</span> Alpha representations using ggplot2</a></li>
  </ul></li>
  <li><a href="#univariate-statistics-for-alpha-diversity" id="toc-univariate-statistics-for-alpha-diversity" class="nav-link" data-scroll-target="#univariate-statistics-for-alpha-diversity"> <span class="header-section-number">5.3</span> Univariate Statistics for alpha diversity</a>
  <ul class="collapse">
  <li><a href="#normality-test-check-the-normal-or-not-normal-distribution-of-your-data-to-choose-the-right-test" id="toc-normality-test-check-the-normal-or-not-normal-distribution-of-your-data-to-choose-the-right-test" class="nav-link" data-scroll-target="#normality-test-check-the-normal-or-not-normal-distribution-of-your-data-to-choose-the-right-test"> <span class="header-section-number">5.3.1</span> Normality test: Check the Normal or not normal distribution of your data to choose the right test!</a></li>
  <li><a href="#select-indices-to-test-run-normality-check" id="toc-select-indices-to-test-run-normality-check" class="nav-link" data-scroll-target="#select-indices-to-test-run-normality-check"> <span class="header-section-number">5.3.2</span> Select indices to test &amp; run normality check</a></li>
  <li><a href="#anova-parametric-follows-normal-distribution-and-at-least-3-groups" id="toc-anova-parametric-follows-normal-distribution-and-at-least-3-groups" class="nav-link" data-scroll-target="#anova-parametric-follows-normal-distribution-and-at-least-3-groups"> <span class="header-section-number">5.3.3</span> ANOVA: parametric (follows normal distribution) AND at least 3 groups</a></li>
  <li><a href="#alternative-to-bartlett-levene-test-package-car-less-sensitive-to-normality-deviation" id="toc-alternative-to-bartlett-levene-test-package-car-less-sensitive-to-normality-deviation" class="nav-link" data-scroll-target="#alternative-to-bartlett-levene-test-package-car-less-sensitive-to-normality-deviation"> <span class="header-section-number">5.3.4</span> Alternative to Bartlett : Levene test (package car), less sensitive to normality deviation</a></li>
  <li><a href="#kruskal-wallis-non-parametric-at-least-three-groups" id="toc-kruskal-wallis-non-parametric-at-least-three-groups" class="nav-link" data-scroll-target="#kruskal-wallis-non-parametric-at-least-three-groups"> <span class="header-section-number">5.3.5</span> Kruskal-Wallis: non-parametric &amp; at least three groups</a></li>
  <li><a href="#t-test-parametric-2-groups-i.e-north-vs.-sud" id="toc-t-test-parametric-2-groups-i.e-north-vs.-sud" class="nav-link" data-scroll-target="#t-test-parametric-2-groups-i.e-north-vs.-sud"> <span class="header-section-number">5.3.6</span> T-test: parametric, 2 groups (<em>i.e</em> North Vs. Sud)</a></li>
  <li><a href="#wilcoxon-rank-sum-non-parametric-2-groups" id="toc-wilcoxon-rank-sum-non-parametric-2-groups" class="nav-link" data-scroll-target="#wilcoxon-rank-sum-non-parametric-2-groups"> <span class="header-section-number">5.3.7</span> Wilcoxon rank sum: non-parametric &amp; 2 Groups</a></li>
  <li><a href="#boxplot-representation-with-p-value-information" id="toc-boxplot-representation-with-p-value-information" class="nav-link" data-scroll-target="#boxplot-representation-with-p-value-information"> <span class="header-section-number">5.3.8</span> Boxplot representation with p-value information</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#bivariate-statistics-linear-regression" id="toc-bivariate-statistics-linear-regression" class="nav-link" data-scroll-target="#bivariate-statistics-linear-regression"> <span class="header-section-number">6</span> Bivariate statistics &amp; linear Regression</a>
  <ul class="collapse">
  <li><a href="#correlation-analysis" id="toc-correlation-analysis" class="nav-link" data-scroll-target="#correlation-analysis"> <span class="header-section-number">6.1</span> Correlation analysis</a>
  <ul class="collapse">
  <li><a href="#select-variables" id="toc-select-variables" class="nav-link" data-scroll-target="#select-variables"> <span class="header-section-number">6.1.1</span> Select variables</a></li>
  <li><a href="#apply-the-method" id="toc-apply-the-method" class="nav-link" data-scroll-target="#apply-the-method"> <span class="header-section-number">6.1.2</span> Apply the method</a></li>
  <li><a href="#plot-results-corrplot-function" id="toc-plot-results-corrplot-function" class="nav-link" data-scroll-target="#plot-results-corrplot-function"> <span class="header-section-number">6.1.3</span> Plot results: corrplot function</a></li>
  <li><a href="#is-the-correlation-is-due-to-chance-significance-test" id="toc-is-the-correlation-is-due-to-chance-significance-test" class="nav-link" data-scroll-target="#is-the-correlation-is-due-to-chance-significance-test"> <span class="header-section-number">6.1.4</span> Is the correlation is due to chance? Significance test!</a></li>
  <li><a href="#show-only-correlations-with-significant-p-values" id="toc-show-only-correlations-with-significant-p-values" class="nav-link" data-scroll-target="#show-only-correlations-with-significant-p-values"> <span class="header-section-number">6.1.5</span> Show only correlations with significant p-values</a></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression"> <span class="header-section-number">6.1.6</span> Linear regression</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#taxonomy-barplot-graph" id="toc-taxonomy-barplot-graph" class="nav-link" data-scroll-target="#taxonomy-barplot-graph"> <span class="header-section-number">7</span> Taxonomy: barplot graph</a>
  <ul class="collapse">
  <li><a href="#abundance-transformation" id="toc-abundance-transformation" class="nav-link" data-scroll-target="#abundance-transformation"> <span class="header-section-number">7.1</span> Abundance Transformation</a>
  <ul class="collapse">
  <li><a href="#counts-in-percentage-using-phyloseqtransform_sample_counts" id="toc-counts-in-percentage-using-phyloseqtransform_sample_counts" class="nav-link" data-scroll-target="#counts-in-percentage-using-phyloseqtransform_sample_counts"> <span class="header-section-number">7.1.1</span> Counts in percentage using <code>phyloseq::transform_sample_counts()</code></a></li>
  <li><a href="#summarise-at-a-given-taxonomic-level-with-phyloseqtax_glom" id="toc-summarise-at-a-given-taxonomic-level-with-phyloseqtax_glom" class="nav-link" data-scroll-target="#summarise-at-a-given-taxonomic-level-with-phyloseqtax_glom"> <span class="header-section-number">7.1.2</span> Summarise at a given taxonomic level with <code>phyloseq::tax_glom()</code></a></li>
  <li><a href="#filter-phylum-mean-of-the-line-phyloseqfilter_taxa" id="toc-filter-phylum-mean-of-the-line-phyloseqfilter_taxa" class="nav-link" data-scroll-target="#filter-phylum-mean-of-the-line-phyloseqfilter_taxa"> <span class="header-section-number">7.1.3</span> Filter phylum (mean of the line): <code>phyloseq::filter_taxa()</code></a></li>
  <li><a href="#how-to-save-a-table-into-a-file-exemple-of-phylum-taxonomic-table" id="toc-how-to-save-a-table-into-a-file-exemple-of-phylum-taxonomic-table" class="nav-link" data-scroll-target="#how-to-save-a-table-into-a-file-exemple-of-phylum-taxonomic-table"> <span class="header-section-number">7.1.4</span> How to save a table into a file: exemple of phylum taxonomic table</a></li>
  <li><a href="#remove-black-lines" id="toc-remove-black-lines" class="nav-link" data-scroll-target="#remove-black-lines"> <span class="header-section-number">7.1.5</span> Remove black lines</a></li>
  </ul></li>
  <li><a href="#how-to-manage-colors-in-barplots" id="toc-how-to-manage-colors-in-barplots" class="nav-link" data-scroll-target="#how-to-manage-colors-in-barplots"> <span class="header-section-number">7.2</span> How to manage colors in barplots**</a>
  <ul class="collapse">
  <li><a href="#build-your-own-palette" id="toc-build-your-own-palette" class="nav-link" data-scroll-target="#build-your-own-palette"> <span class="header-section-number">7.2.1</span> Build your own palette</a></li>
  <li><a href="#use-your-palette-in-the-p_order-barplot" id="toc-use-your-palette-in-the-p_order-barplot" class="nav-link" data-scroll-target="#use-your-palette-in-the-p_order-barplot"> <span class="header-section-number">7.2.2</span> Use your palette in the p_order barplot</a></li>
  </ul></li>
  <li><a href="#other-data-manipulation-select-specific-taxa-merge-samples" id="toc-other-data-manipulation-select-specific-taxa-merge-samples" class="nav-link" data-scroll-target="#other-data-manipulation-select-specific-taxa-merge-samples"> <span class="header-section-number">7.3</span> Other data Manipulation : select specific taxa, merge samples</a>
  <ul class="collapse">
  <li><a href="#select-actinobacteria-and-bacteroidetes-phyloseqsubset_taxa" id="toc-select-actinobacteria-and-bacteroidetes-phyloseqsubset_taxa" class="nav-link" data-scroll-target="#select-actinobacteria-and-bacteroidetes-phyloseqsubset_taxa"> <span class="header-section-number">7.3.1</span> Select Actinobacteria AND Bacteroidetes: <code>phyloseq::subset_taxa()</code></a></li>
  <li><a href="#keep-all-with-the-exception-of-a-class-a-genus-etc-e.g.-contamination" id="toc-keep-all-with-the-exception-of-a-class-a-genus-etc-e.g.-contamination" class="nav-link" data-scroll-target="#keep-all-with-the-exception-of-a-class-a-genus-etc-e.g.-contamination"> <span class="header-section-number">7.3.2</span> Keep all with the exception of a class, a genus etc (e.g.&nbsp;contamination)</a></li>
  <li><a href="#understand" id="toc-understand" class="nav-link" data-scroll-target="#understand"> <span class="header-section-number">7.3.3</span> Understand:</a></li>
  <li><a href="#merge-samples-groups-duplicates-etc" id="toc-merge-samples-groups-duplicates-etc" class="nav-link" data-scroll-target="#merge-samples-groups-duplicates-etc"> <span class="header-section-number">7.3.4</span> Merge samples (groups, duplicates etc)</a></li>
  <li><a href="#sample-selection-phyloseqsubset_samples" id="toc-sample-selection-phyloseqsubset_samples" class="nav-link" data-scroll-target="#sample-selection-phyloseqsubset_samples"> <span class="header-section-number">7.3.5</span> Sample selection: <code>phyloseq::subset_samples()</code></a></li>
  <li><a href="#alternative-way-phyloseqprune_samples" id="toc-alternative-way-phyloseqprune_samples" class="nav-link" data-scroll-target="#alternative-way-phyloseqprune_samples"> <span class="header-section-number">7.3.6</span> Alternative way: <code>phyloseq::prune_samples</code></a></li>
  </ul></li>
  <li><a href="#retrieve-fasta-sequences-from-a-phyloseq-object" id="toc-retrieve-fasta-sequences-from-a-phyloseq-object" class="nav-link" data-scroll-target="#retrieve-fasta-sequences-from-a-phyloseq-object"> <span class="header-section-number">7.4</span> Retrieve fasta sequences from a phyloseq object</a>
  <ul class="collapse">
  <li><a href="#create-a-fasta-file-from-your-sequences" id="toc-create-a-fasta-file-from-your-sequences" class="nav-link" data-scroll-target="#create-a-fasta-file-from-your-sequences"> <span class="header-section-number">7.4.1</span> Create a fasta file from your sequences</a></li>
  <li><a href="#retrieve-a-subset-of-sequences" id="toc-retrieve-a-subset-of-sequences" class="nav-link" data-scroll-target="#retrieve-a-subset-of-sequences"> <span class="header-section-number">7.4.2</span> Retrieve a subset of sequences</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#core-microbiota-analysis" id="toc-core-microbiota-analysis" class="nav-link" data-scroll-target="#core-microbiota-analysis"> <span class="header-section-number">8</span> Core microbiota analysis</a>
  <ul class="collapse">
  <li><a href="#identify-the-taxa-names-of-the-core-microbiota" id="toc-identify-the-taxa-names-of-the-core-microbiota" class="nav-link" data-scroll-target="#identify-the-taxa-names-of-the-core-microbiota"> <span class="header-section-number">8.1</span> Identify the taxa names of the core microbiota</a>
  <ul class="collapse">
  <li><a href="#which-core-compare-north-south-core-microbiota" id="toc-which-core-compare-north-south-core-microbiota" class="nav-link" data-scroll-target="#which-core-compare-north-south-core-microbiota"> <span class="header-section-number">8.1.1</span> Which core? Compare North &amp; South core microbiota</a></li>
  <li><a href="#change-first-column-name-of-taxonomy-rank" id="toc-change-first-column-name-of-taxonomy-rank" class="nav-link" data-scroll-target="#change-first-column-name-of-taxonomy-rank"> <span class="header-section-number">8.1.2</span> Change first column name of taxonomy rank</a></li>
  <li><a href="#add-the-lowest-taxonomy-classification" id="toc-add-the-lowest-taxonomy-classification" class="nav-link" data-scroll-target="#add-the-lowest-taxonomy-classification"> <span class="header-section-number">8.1.3</span> Add the lowest taxonomy classification</a></li>
  <li><a href="#see-the-transformation-of-tax_table" id="toc-see-the-transformation-of-tax_table" class="nav-link" data-scroll-target="#see-the-transformation-of-tax_table"> <span class="header-section-number">8.1.4</span> See the transformation of tax_table</a></li>
  <li><a href="#identify-core-microbiota" id="toc-identify-core-microbiota" class="nav-link" data-scroll-target="#identify-core-microbiota"> <span class="header-section-number">8.1.5</span> Identify Core microbiota</a></li>
  <li><a href="#get-core-microbiota-phyloseq-object" id="toc-get-core-microbiota-phyloseq-object" class="nav-link" data-scroll-target="#get-core-microbiota-phyloseq-object"> <span class="header-section-number">8.1.6</span> Get core microbiota phyloseq object</a></li>
  </ul></li>
  <li><a href="#visualise-core-microbiome-with-microbiomeplot_core" id="toc-visualise-core-microbiome-with-microbiomeplot_core" class="nav-link" data-scroll-target="#visualise-core-microbiome-with-microbiomeplot_core"> <span class="header-section-number">8.2</span> Visualise core microbiome with <code>microbiome::plot_core()</code></a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/nhenry50/ANF-metabarcoding/edit/main/practicals/alpha_diversity.Rmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/nhenry50/ANF-metabarcoding/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">PARTII_alpha_Diversity_ANF</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Fabrice Armougom, MIO </p>
             <p>Marc Garel, MIO </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="prepare-workspace" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Prepare workspace</h1>
<p>Load libraries</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phyloseq)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Load custom functions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Define output folder:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>output_alpha <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"outputs"</span>, <span class="st">"alpha_diversity"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(output_alpha)) <span class="fu">dir.create</span>(output_alpha)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Load the data and inspect the phyloseq object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>physeq <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"asv_table"</span>, <span class="st">"phyloseq_object_alpha_beta_div.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-structure" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Data Structure</h1>
<p>Have a look at the phyloseq object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>physeq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 213 taxa and 18 samples ]
sample_data() Sample Data:       [ 18 samples by 21 sample variables ]
tax_table()   Taxonomy Table:    [ 213 taxa by 7 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 213 tips and 212 internal nodes ]
refseq()      DNAStringSet:      [ 213 reference sequences ]</code></pre>
</div>
</div>
<section id="our-phyloseq-object-physeq-is-composed-of" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="our-phyloseq-object-physeq-is-composed-of"><span class="header-section-number">2.1</span> Our phyloseq object <code>physeq</code> is composed of:</h2>
<section id="an-asv-table-with-the-absolute-counts" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="an-asv-table-with-the-absolute-counts"><span class="header-section-number">2.1.1</span> An ASV table with the absolute counts</h3>
<p>Be careful: Rows are samples, columns are ASVs</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>physeq<span class="sc">@</span>otu_table[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OTU Table:          [10 taxa and 10 samples]
                     taxa are columns
     ASV1 ASV2 ASV3 ASV4 ASV5 ASV6 ASV7 ASV8 ASV9 ASV10
S11B  117   25   85   70   87   40   57   34   41     0
S1B    67    0   23    0   51   48    0    0   27    58
S2B    43    0   35   15   42   52    0    0    0    43
S2S   103   87   76   12   99   43   36   72   46     0
S3B    59    0   32    0   49   73    0    0    0    57
S3S    81   10    0   20   36    0    0    0    0    50
S4B    11    6   38   33   43   46    0    8    0    37
S4S    68    6   38    0   62    0    0   11   30    46
S5B   176   18   62  109    0   35   56   13   33    82
S5S   182    0   36  101   51    0   33    0   29    42</code></pre>
</div>
</div>
</section>
<section id="a-metadata-table-with-information-e.g.-physicochemical-categorical-variables-about-samples" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="a-metadata-table-with-information-e.g.-physicochemical-categorical-variables-about-samples"><span class="header-section-number">2.1.2</span> A metadata table with information (e.g.&nbsp;physicochemical, categorical variables) about samples</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>physeq<span class="sc">@</span>sam_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     SampName   Geo Description groupe Pres PicoEuk Synec Prochloro NanoEuk
S11B     S11B South     South5B    SGF   35    5370 46830       580    6010
S1B       S1B North     North1B    NBF   52     660 32195     10675     955
S2B       S2B North     North2B    NBF   59     890 25480     16595     670
S2S       S2S North     North2S    NBS    0     890 25480     16595     670
S3B       S3B North     North3B    NBF   74     835 13340     25115    1115
S3S       S3S North     North3S    NBS    0     715 26725     16860     890
S4B       S4B North     North4B    NBF   78    2220  3130     29835    2120
S4S       S4S North     North4S    NBS   78    2220  3130     29835    2120
S5B       S5B North     North5B    NBF   42    1620 55780     23795    2555
S5S       S5S North     North5S    NBS    0    1620 56555     22835    2560
S6B       S6B South     South1B    SGF   13    2520 39050       705    3630
S6S       S6S South     South1S    SGS    0    2435 35890       915    3735
S7B       S7B South     South2B    SGF   26       0     0         0    4005
S7S       S7S South     South2S    SGS    0    4535 26545      1340    6585
S8B       S8B South     South3B    SGF   33       0     0         0    5910
S8S       S8S South     South3S    SGS    0    4260 36745       985    5470
S9B       S9B South     South4B    SGF   25    4000 31730       485    4395
S9S       S9S South     South4S    SGS    0    5465 32860       820    5045
     Crypto SiOH4   NO2   NO3   NH4   PO4    NT    PT   Chla       T       S
S11B   1690 3.324 0.083 0.756 0.467 0.115 9.539 4.138 0.0182 23.0308 38.9967
S1B     115 1.813 0.256 0.889 0.324 0.132 9.946 3.565 0.0000 22.7338 37.6204
S2B     395 2.592 0.105 1.125 0.328 0.067 9.378 3.391 0.0000 22.6824 37.6627
S2S     395 3.381 0.231 0.706 0.450 0.109 8.817 3.345 0.0000 22.6854 37.6176
S3B     165 1.438 0.057 1.159 0.369 0.174 8.989 2.568 0.0000 21.5296 37.5549
S3S     200 1.656 0.098 0.794 0.367 0.095 7.847 2.520 0.0000 22.5610 37.5960
S4B     235 2.457 0.099 1.087 0.349 0.137 8.689 3.129 0.0000 18.8515 37.4542
S4S     235 2.457 0.099 1.087 0.349 0.137 8.689 3.129 0.0000 18.8515 37.4542
S5B    1355 2.028 0.103 1.135 0.216 0.128 8.623 3.137 0.0102 24.1905 38.3192
S5S     945 2.669 0.136 0.785 0.267 0.114 9.146 3.062 0.0000 24.1789 38.3213
S6B    1295 2.206 0.249 0.768 0.629 0.236 9.013 3.455 0.0000 22.0197 39.0877
S6S    1300 3.004 0.251 0.927 0.653 0.266 8.776 3.230 0.0134 22.0515 39.0884
S7B    1600 3.016 0.157 0.895 0.491 0.176 8.968 4.116 0.0000 23.6669 38.9699
S7S    1355 1.198 0.165 1.099 0.432 0.180 8.256 3.182 0.0000 23.6814 38.9708
S8B    1590 3.868 0.253 0.567 0.533 0.169 8.395 3.126 0.0000 23.1236 39.0054
S8S    2265 3.639 0.255 0.658 0.665 0.247 8.991 3.843 0.0132 23.3147 38.9885
S9B    1180 3.910 0.107 0.672 0.490 0.134 8.954 4.042 0.0172 22.6306 38.9094
S9S    1545 3.607 0.139 0.644 0.373 0.167 9.817 3.689 0.0062 22.9545 38.7777
     Sigma_t
S11B 26.9631
S1B  26.0046
S2B  26.0521
S2S  26.0137
S3B  26.2987
S3S  26.0332
S4B  26.9415
S4S  26.9415
S5B  26.1037
S5S  26.1065
S6B  27.3241
S6S  27.3151
S7B  26.7536
S7S  26.7488
S8B  26.9423
S8S  26.8713
S9B  27.0131
S9S  26.8172</code></pre>
</div>
</div>
</section>
<section id="a-table-of-taxonomic-classification-of-each-asv" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="a-table-of-taxonomic-classification-of-each-asv"><span class="header-section-number">2.1.3</span> A table of Taxonomic classification of each ASV</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>physeq<span class="sc">@</span>tax_table[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Taxonomy Table:     [10 taxa by 7 taxonomic ranks]:
      Kingdom    Phylum             Class                 Order             
ASV1  "Bacteria" "Cyanobacteria"    "Cyanobacteriia"      "Synechococcales" 
ASV2  "Bacteria" "Proteobacteria"   "Gammaproteobacteria" "Enterobacterales"
ASV3  "Bacteria" "Proteobacteria"   "Alphaproteobacteria" "SAR11 clade"     
ASV4  "Archaea"  "Thermoplasmatota" "Thermoplasmata"      "Marine Group II" 
ASV5  "Bacteria" "Proteobacteria"   "Alphaproteobacteria" "SAR11 clade"     
ASV6  "Bacteria" "Proteobacteria"   "Alphaproteobacteria" "SAR11 clade"     
ASV7  "Bacteria" "Proteobacteria"   "Alphaproteobacteria" "Rhodospirillales"
ASV8  "Bacteria" "Proteobacteria"   "Gammaproteobacteria" "Enterobacterales"
ASV9  "Bacteria" "Proteobacteria"   "Alphaproteobacteria" "SAR11 clade"     
ASV10 "Bacteria" "Proteobacteria"   "Alphaproteobacteria" "SAR11 clade"     
      Family                    Genus                  Species
ASV1  "Cyanobiaceae"            "Synechococcus CC9902" NA     
ASV2  "Pseudoalteromonadaceae"  "Pseudoalteromonas"    NA     
ASV3  "Clade I"                 "Clade Ia"             NA     
ASV4  NA                        NA                     NA     
ASV5  "Clade I"                 "Clade Ia"             NA     
ASV6  "Clade II"                NA                     NA     
ASV7  "AEGEAN-169 marine group" NA                     NA     
ASV8  "Pseudoalteromonadaceae"  "Pseudoalteromonas"    NA     
ASV9  "Clade I"                 "Clade Ia"             NA     
ASV10 "Clade I"                 "Clade Ia"             NA     </code></pre>
</div>
</div>
</section>
<section id="a-phylogenetic-tree" class="level3" data-number="2.1.4">
<h3 data-number="2.1.4" class="anchored" data-anchor-id="a-phylogenetic-tree"><span class="header-section-number">2.1.4</span> A Phylogenetic Tree</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>physeq<span class="sc">@</span>phy_tree</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Phylogenetic tree with 213 tips and 212 internal nodes.

Tip labels:
  ASV1, ASV2, ASV3, ASV4, ASV5, ASV6, ...

Rooted; includes branch lengths.</code></pre>
</div>
</div>
</section>
<section id="a-table-with-the-asv-sequences" class="level3" data-number="2.1.5">
<h3 data-number="2.1.5" class="anchored" data-anchor-id="a-table-with-the-asv-sequences"><span class="header-section-number">2.1.5</span> A table with the ASV Sequences</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>physeq<span class="sc">@</span>refseq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DNAStringSet object of length 213:
      width seq                                             names               
  [1]   402 GGAATTTTCCGCAATGGGCGAA...CGAAAGCCAGGGGAGCGAAAGG ASV1
  [2]   425 GGAATATTGCACAATGGGCGCA...CGAAAGCGTGGGGAGCAAACAG ASV2
  [3]   400 GGAATCTTGCACAATGGAGGAA...CGAAAGCATGGGTAGCGAAGAG ASV3
  [4]   383 CGAAAACTTGACAATGCGAGCA...CGAAGCCTAGGGGCACGAACCG ASV4
  [5]   400 GGAATCTTGCACAATGGAGGAA...CGAAAGCATGGGTAGCGAAGAG ASV5
  ...   ... ...
[209]   426 GGAATTTTGCGCAATGGACGAA...CGAAAGCGTGGGGAGCGAACAG ASV209
[210]   403 GGAATATTGCACAATGGGCGCA...GGTCAACACTGACGCTCATGTA ASV210
[211]   360 CGAAAACTTCACACTGCAGGAA...GAACGGATCCGACGGTCAGGGA ASV211
[212]   400 GGAATATTGGACAATGGGCGAA...CGAAAGCGTGGGTAGCAAACAG ASV212
[213]   404 GGAATATTGCACAATGGGCGCA...GTCAACACTGACGCTCATGTAC ASV213</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="starting-with-some-basic-commands" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Starting with some basic commands</h1>
<section id="get-the-total-number-of-asvs" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="get-the-total-number-of-asvs"><span class="header-section-number">3.1</span> Get the total number of ASVs</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">ntaxa</span>(physeq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 213</code></pre>
</div>
</div>
</section>
<section id="get-the-total-number-of-samples" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="get-the-total-number-of-samples"><span class="header-section-number">3.2</span> Get the total number of samples</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">nsamples</span>(physeq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18</code></pre>
</div>
</div>
</section>
<section id="get-sample-names" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="get-sample-names"><span class="header-section-number">3.3</span> Get sample names</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">sample_names</span>(physeq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "S11B" "S1B"  "S2B"  "S2S"  "S3B"  "S3S"  "S4B"  "S4S"  "S5B"  "S5S" 
[11] "S6B"  "S6S"  "S7B"  "S7S"  "S8B"  "S8S"  "S9B"  "S9S" </code></pre>
</div>
</div>
</section>
<section id="get-asv-identification" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="get-asv-identification"><span class="header-section-number">3.4</span> Get ASV identification</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">taxa_names</span>(physeq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "ASV1"   "ASV2"   "ASV3"   "ASV4"   "ASV5"   "ASV6"   "ASV7"   "ASV8"  
  [9] "ASV9"   "ASV10"  "ASV11"  "ASV12"  "ASV13"  "ASV14"  "ASV15"  "ASV16" 
 [17] "ASV17"  "ASV18"  "ASV19"  "ASV20"  "ASV21"  "ASV22"  "ASV23"  "ASV24" 
 [25] "ASV25"  "ASV26"  "ASV27"  "ASV28"  "ASV29"  "ASV30"  "ASV31"  "ASV32" 
 [33] "ASV33"  "ASV34"  "ASV35"  "ASV36"  "ASV37"  "ASV38"  "ASV39"  "ASV40" 
 [41] "ASV41"  "ASV42"  "ASV43"  "ASV44"  "ASV45"  "ASV46"  "ASV47"  "ASV48" 
 [49] "ASV49"  "ASV50"  "ASV51"  "ASV52"  "ASV53"  "ASV54"  "ASV55"  "ASV56" 
 [57] "ASV57"  "ASV58"  "ASV59"  "ASV60"  "ASV61"  "ASV62"  "ASV63"  "ASV64" 
 [65] "ASV65"  "ASV66"  "ASV67"  "ASV68"  "ASV69"  "ASV70"  "ASV71"  "ASV72" 
 [73] "ASV73"  "ASV74"  "ASV75"  "ASV76"  "ASV77"  "ASV78"  "ASV79"  "ASV80" 
 [81] "ASV81"  "ASV82"  "ASV83"  "ASV84"  "ASV85"  "ASV86"  "ASV87"  "ASV88" 
 [89] "ASV89"  "ASV90"  "ASV91"  "ASV92"  "ASV93"  "ASV94"  "ASV95"  "ASV96" 
 [97] "ASV97"  "ASV98"  "ASV99"  "ASV100" "ASV101" "ASV102" "ASV103" "ASV104"
[105] "ASV105" "ASV106" "ASV107" "ASV108" "ASV109" "ASV110" "ASV111" "ASV112"
[113] "ASV113" "ASV114" "ASV115" "ASV116" "ASV117" "ASV118" "ASV119" "ASV120"
[121] "ASV121" "ASV122" "ASV123" "ASV124" "ASV125" "ASV126" "ASV127" "ASV128"
[129] "ASV129" "ASV130" "ASV131" "ASV132" "ASV133" "ASV134" "ASV135" "ASV136"
[137] "ASV137" "ASV138" "ASV139" "ASV140" "ASV141" "ASV142" "ASV143" "ASV144"
[145] "ASV145" "ASV146" "ASV147" "ASV148" "ASV149" "ASV150" "ASV151" "ASV152"
[153] "ASV153" "ASV154" "ASV155" "ASV156" "ASV157" "ASV158" "ASV159" "ASV160"
[161] "ASV161" "ASV162" "ASV163" "ASV164" "ASV165" "ASV166" "ASV167" "ASV168"
[169] "ASV169" "ASV170" "ASV171" "ASV172" "ASV173" "ASV174" "ASV175" "ASV176"
[177] "ASV177" "ASV178" "ASV179" "ASV180" "ASV181" "ASV182" "ASV183" "ASV184"
[185] "ASV185" "ASV186" "ASV187" "ASV188" "ASV189" "ASV190" "ASV191" "ASV192"
[193] "ASV193" "ASV194" "ASV195" "ASV196" "ASV197" "ASV198" "ASV199" "ASV200"
[201] "ASV201" "ASV202" "ASV203" "ASV204" "ASV205" "ASV206" "ASV207" "ASV208"
[209] "ASV209" "ASV210" "ASV211" "ASV212" "ASV213"</code></pre>
</div>
</div>
</section>
<section id="get-the-names-of-variables-in-sam_data" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="get-the-names-of-variables-in-sam_data"><span class="header-section-number">3.5</span> Get the names of variables in sam_data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">sample_variables</span>(physeq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "SampName"    "Geo"         "Description" "groupe"      "Pres"       
 [6] "PicoEuk"     "Synec"       "Prochloro"   "NanoEuk"     "Crypto"     
[11] "SiOH4"       "NO2"         "NO3"         "NH4"         "PO4"        
[16] "NT"          "PT"          "Chla"        "T"           "S"          
[21] "Sigma_t"    </code></pre>
</div>
</div>
</section>
<section id="display-all-variables-with-values" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="display-all-variables-with-values"><span class="header-section-number">3.6</span> Display all variables with values</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">get_variable</span>(physeq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     SampName   Geo Description groupe Pres PicoEuk Synec Prochloro NanoEuk
S11B     S11B South     South5B    SGF   35    5370 46830       580    6010
S1B       S1B North     North1B    NBF   52     660 32195     10675     955
S2B       S2B North     North2B    NBF   59     890 25480     16595     670
S2S       S2S North     North2S    NBS    0     890 25480     16595     670
S3B       S3B North     North3B    NBF   74     835 13340     25115    1115
S3S       S3S North     North3S    NBS    0     715 26725     16860     890
S4B       S4B North     North4B    NBF   78    2220  3130     29835    2120
S4S       S4S North     North4S    NBS   78    2220  3130     29835    2120
S5B       S5B North     North5B    NBF   42    1620 55780     23795    2555
S5S       S5S North     North5S    NBS    0    1620 56555     22835    2560
S6B       S6B South     South1B    SGF   13    2520 39050       705    3630
S6S       S6S South     South1S    SGS    0    2435 35890       915    3735
S7B       S7B South     South2B    SGF   26       0     0         0    4005
S7S       S7S South     South2S    SGS    0    4535 26545      1340    6585
S8B       S8B South     South3B    SGF   33       0     0         0    5910
S8S       S8S South     South3S    SGS    0    4260 36745       985    5470
S9B       S9B South     South4B    SGF   25    4000 31730       485    4395
S9S       S9S South     South4S    SGS    0    5465 32860       820    5045
     Crypto SiOH4   NO2   NO3   NH4   PO4    NT    PT   Chla       T       S
S11B   1690 3.324 0.083 0.756 0.467 0.115 9.539 4.138 0.0182 23.0308 38.9967
S1B     115 1.813 0.256 0.889 0.324 0.132 9.946 3.565 0.0000 22.7338 37.6204
S2B     395 2.592 0.105 1.125 0.328 0.067 9.378 3.391 0.0000 22.6824 37.6627
S2S     395 3.381 0.231 0.706 0.450 0.109 8.817 3.345 0.0000 22.6854 37.6176
S3B     165 1.438 0.057 1.159 0.369 0.174 8.989 2.568 0.0000 21.5296 37.5549
S3S     200 1.656 0.098 0.794 0.367 0.095 7.847 2.520 0.0000 22.5610 37.5960
S4B     235 2.457 0.099 1.087 0.349 0.137 8.689 3.129 0.0000 18.8515 37.4542
S4S     235 2.457 0.099 1.087 0.349 0.137 8.689 3.129 0.0000 18.8515 37.4542
S5B    1355 2.028 0.103 1.135 0.216 0.128 8.623 3.137 0.0102 24.1905 38.3192
S5S     945 2.669 0.136 0.785 0.267 0.114 9.146 3.062 0.0000 24.1789 38.3213
S6B    1295 2.206 0.249 0.768 0.629 0.236 9.013 3.455 0.0000 22.0197 39.0877
S6S    1300 3.004 0.251 0.927 0.653 0.266 8.776 3.230 0.0134 22.0515 39.0884
S7B    1600 3.016 0.157 0.895 0.491 0.176 8.968 4.116 0.0000 23.6669 38.9699
S7S    1355 1.198 0.165 1.099 0.432 0.180 8.256 3.182 0.0000 23.6814 38.9708
S8B    1590 3.868 0.253 0.567 0.533 0.169 8.395 3.126 0.0000 23.1236 39.0054
S8S    2265 3.639 0.255 0.658 0.665 0.247 8.991 3.843 0.0132 23.3147 38.9885
S9B    1180 3.910 0.107 0.672 0.490 0.134 8.954 4.042 0.0172 22.6306 38.9094
S9S    1545 3.607 0.139 0.644 0.373 0.167 9.817 3.689 0.0062 22.9545 38.7777
     Sigma_t
S11B 26.9631
S1B  26.0046
S2B  26.0521
S2S  26.0137
S3B  26.2987
S3S  26.0332
S4B  26.9415
S4S  26.9415
S5B  26.1037
S5S  26.1065
S6B  27.3241
S6S  27.3151
S7B  26.7536
S7S  26.7488
S8B  26.9423
S8S  26.8713
S9B  27.0131
S9S  26.8172</code></pre>
</div>
</div>
</section>
<section id="sum-the-reads-by-sample" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="sum-the-reads-by-sample"><span class="header-section-number">3.7</span> Sum the reads by sample</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">sample_sums</span>(physeq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>S11B  S1B  S2B  S2S  S3B  S3S  S4B  S4S  S5B  S5S  S6B  S6S  S7B  S7S  S8B  S8S 
 975  837  893  983  878  889  917 1077 1018 1006 1076  937  878  936  846  958 
 S9B  S9S 
 888  991 </code></pre>
</div>
</div>
</section>
<section id="sum-the-reads-by-speciestaxaotus-for-all-samples" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="sum-the-reads-by-speciestaxaotus-for-all-samples"><span class="header-section-number">3.8</span> Sum the reads by species/taxa/OTUs (for all samples)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">taxa_sums</span>(physeq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ASV1   ASV2   ASV3   ASV4   ASV5   ASV6   ASV7   ASV8   ASV9  ASV10  ASV11 
  1558    973    899    833    767    654    642    598    475    474    468 
 ASV12  ASV13  ASV14  ASV15  ASV16  ASV17  ASV18  ASV19  ASV20  ASV21  ASV22 
   417    301    282    251    246    245    236    221    210    206    200 
 ASV23  ASV24  ASV25  ASV26  ASV27  ASV28  ASV29  ASV30  ASV31  ASV32  ASV33 
   190    181    181    176    175    173    169    163    149    132    122 
 ASV34  ASV35  ASV36  ASV37  ASV38  ASV39  ASV40  ASV41  ASV42  ASV43  ASV44 
   120    116    115    115    111    108    101    100     94     84     84 
 ASV45  ASV46  ASV47  ASV48  ASV49  ASV50  ASV51  ASV52  ASV53  ASV54  ASV55 
    83     79     71     70     68     64     64     64     59     55     52 
 ASV56  ASV57  ASV58  ASV59  ASV60  ASV61  ASV62  ASV63  ASV64  ASV65  ASV66 
    48     46     44     42     41     40     40     39     36     36     36 
 ASV67  ASV68  ASV69  ASV70  ASV71  ASV72  ASV73  ASV74  ASV75  ASV76  ASV77 
    35     34     34     31     31     30     30     30     30     29     29 
 ASV78  ASV79  ASV80  ASV81  ASV82  ASV83  ASV84  ASV85  ASV86  ASV87  ASV88 
    28     27     27     27     26     26     25     25     23     23     22 
 ASV89  ASV90  ASV91  ASV92  ASV93  ASV94  ASV95  ASV96  ASV97  ASV98  ASV99 
    22     22     21     19     19     18     17     17     17     16     16 
ASV100 ASV101 ASV102 ASV103 ASV104 ASV105 ASV106 ASV107 ASV108 ASV109 ASV110 
    16     16     16     16     16     15     15     15     15     14     14 
ASV111 ASV112 ASV113 ASV114 ASV115 ASV116 ASV117 ASV118 ASV119 ASV120 ASV121 
    14     13     13     13     13     13     12     12     12     11     11 
ASV122 ASV123 ASV124 ASV125 ASV126 ASV127 ASV128 ASV129 ASV130 ASV131 ASV132 
    11     11     11     10     10     10     10     10     10     10     10 
ASV133 ASV134 ASV135 ASV136 ASV137 ASV138 ASV139 ASV140 ASV141 ASV142 ASV143 
    10      9      9      9      9      9      9      9      9      9      9 
ASV144 ASV145 ASV146 ASV147 ASV148 ASV149 ASV150 ASV151 ASV152 ASV153 ASV154 
     8      8      8      8      8      8      8      8      8      8      7 
ASV155 ASV156 ASV157 ASV158 ASV159 ASV160 ASV161 ASV162 ASV163 ASV164 ASV165 
     7      7      7      7      7      7      7      7      7      7      6 
ASV166 ASV167 ASV168 ASV169 ASV170 ASV171 ASV172 ASV173 ASV174 ASV175 ASV176 
     6      6      6      6      6      6      6      5      5      5      5 
ASV177 ASV178 ASV179 ASV180 ASV181 ASV182 ASV183 ASV184 ASV185 ASV186 ASV187 
     5      5      5      5      5      5      4      4      4      4      4 
ASV188 ASV189 ASV190 ASV191 ASV192 ASV193 ASV194 ASV195 ASV196 ASV197 ASV198 
     4      4      4      4      4      4      4      3      3      3      3 
ASV199 ASV200 ASV201 ASV202 ASV203 ASV204 ASV205 ASV206 ASV207 ASV208 ASV209 
     3      3      3      2      2      2      2      2      2      2      2 
ASV210 ASV211 ASV212 ASV213 
     2      2      2      1 </code></pre>
</div>
</div>
</section>
<section id="sort-speciestaxaotus-by-devreasing-number-of-reads" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="sort-speciestaxaotus-by-devreasing-number-of-reads"><span class="header-section-number">3.9</span> Sort species/taxa/OTUs by devreasing number of reads</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(phyloseq<span class="sc">::</span><span class="fu">taxa_sums</span>(physeq), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ASV1   ASV2   ASV3   ASV4   ASV5   ASV6   ASV7   ASV8   ASV9  ASV10  ASV11 
  1558    973    899    833    767    654    642    598    475    474    468 
 ASV12  ASV13  ASV14  ASV15  ASV16  ASV17  ASV18  ASV19  ASV20  ASV21  ASV22 
   417    301    282    251    246    245    236    221    210    206    200 
 ASV23  ASV24  ASV25  ASV26  ASV27  ASV28  ASV29  ASV30  ASV31  ASV32  ASV33 
   190    181    181    176    175    173    169    163    149    132    122 
 ASV34  ASV35  ASV36  ASV37  ASV38  ASV39  ASV40  ASV41  ASV42  ASV43  ASV44 
   120    116    115    115    111    108    101    100     94     84     84 
 ASV45  ASV46  ASV47  ASV48  ASV49  ASV50  ASV51  ASV52  ASV53  ASV54  ASV55 
    83     79     71     70     68     64     64     64     59     55     52 
 ASV56  ASV57  ASV58  ASV59  ASV60  ASV61  ASV62  ASV63  ASV64  ASV65  ASV66 
    48     46     44     42     41     40     40     39     36     36     36 
 ASV67  ASV68  ASV69  ASV70  ASV71  ASV72  ASV73  ASV74  ASV75  ASV76  ASV77 
    35     34     34     31     31     30     30     30     30     29     29 
 ASV78  ASV79  ASV80  ASV81  ASV82  ASV83  ASV84  ASV85  ASV86  ASV87  ASV88 
    28     27     27     27     26     26     25     25     23     23     22 
 ASV89  ASV90  ASV91  ASV92  ASV93  ASV94  ASV95  ASV96  ASV97  ASV98  ASV99 
    22     22     21     19     19     18     17     17     17     16     16 
ASV100 ASV101 ASV102 ASV103 ASV104 ASV105 ASV106 ASV107 ASV108 ASV109 ASV110 
    16     16     16     16     16     15     15     15     15     14     14 
ASV111 ASV112 ASV113 ASV114 ASV115 ASV116 ASV117 ASV118 ASV119 ASV120 ASV121 
    14     13     13     13     13     13     12     12     12     11     11 
ASV122 ASV123 ASV124 ASV125 ASV126 ASV127 ASV128 ASV129 ASV130 ASV131 ASV132 
    11     11     11     10     10     10     10     10     10     10     10 
ASV133 ASV134 ASV135 ASV136 ASV137 ASV138 ASV139 ASV140 ASV141 ASV142 ASV143 
    10      9      9      9      9      9      9      9      9      9      9 
ASV144 ASV145 ASV146 ASV147 ASV148 ASV149 ASV150 ASV151 ASV152 ASV153 ASV154 
     8      8      8      8      8      8      8      8      8      8      7 
ASV155 ASV156 ASV157 ASV158 ASV159 ASV160 ASV161 ASV162 ASV163 ASV164 ASV165 
     7      7      7      7      7      7      7      7      7      7      6 
ASV166 ASV167 ASV168 ASV169 ASV170 ASV171 ASV172 ASV173 ASV174 ASV175 ASV176 
     6      6      6      6      6      6      6      5      5      5      5 
ASV177 ASV178 ASV179 ASV180 ASV181 ASV182 ASV183 ASV184 ASV185 ASV186 ASV187 
     5      5      5      5      5      5      4      4      4      4      4 
ASV188 ASV189 ASV190 ASV191 ASV192 ASV193 ASV194 ASV195 ASV196 ASV197 ASV198 
     4      4      4      4      4      4      4      3      3      3      3 
ASV199 ASV200 ASV201 ASV202 ASV203 ASV204 ASV205 ASV206 ASV207 ASV208 ASV209 
     3      3      3      2      2      2      2      2      2      2      2 
ASV210 ASV211 ASV212 ASV213 
     2      2      2      1 </code></pre>
</div>
</div>
<p>Looking for the 2 last commands you can notice that dada2 has already ranked ASV ASV1 the most abundant and after decreasing.</p>
</section>
<section id="get-taxonomic-ranks" class="level2" data-number="3.10">
<h2 data-number="3.10" class="anchored" data-anchor-id="get-taxonomic-ranks"><span class="header-section-number">3.10</span> Get taxonomic ranks</h2>
<p>Be careful: in the future command/functions used in this practical, you will often call a taxonomic rank it <strong>MUST</strong> be one of these (case sensitive)!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">rank_names</span>(physeq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Kingdom" "Phylum"  "Class"   "Order"   "Family"  "Genus"   "Species"</code></pre>
</div>
</div>
</section>
<section id="show-abundance-for-a-given-asv" class="level2" data-number="3.11">
<h2 data-number="3.11" class="anchored" data-anchor-id="show-abundance-for-a-given-asv"><span class="header-section-number">3.11</span> Show abundance for a given ASV</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">get_sample</span>(physeq, <span class="at">i =</span> <span class="st">"ASV37"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>S11B  S1B  S2B  S2S  S3B  S3S  S4B  S4S  S5B  S5S  S6B  S6S  S7B  S7S  S8B  S8S 
  12    5    0    4    5   53    5   12    0   12    0    0    3    4    0    0 
 S9B  S9S 
   0    0 </code></pre>
</div>
</div>
</section>
<section id="show-asvs-and-abundance-for-a-given-sample" class="level2" data-number="3.12">
<h2 data-number="3.12" class="anchored" data-anchor-id="show-asvs-and-abundance-for-a-given-sample"><span class="header-section-number">3.12</span> Show ASVs and abundance for a given sample</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">get_taxa</span>(physeq, <span class="at">i =</span> <span class="st">"S2B"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ASV1   ASV2   ASV3   ASV4   ASV5   ASV6   ASV7   ASV8   ASV9  ASV10  ASV11 
    43      0     35     15     42     52      0      0      0     43     60 
 ASV12  ASV13  ASV14  ASV15  ASV16  ASV17  ASV18  ASV19  ASV20  ASV21  ASV22 
    29      3      0      0     55      0     43      0      0     24     28 
 ASV23  ASV24  ASV25  ASV26  ASV27  ASV28  ASV29  ASV30  ASV31  ASV32  ASV33 
    31     16      0      0      0     71      0     10      0     11      5 
 ASV34  ASV35  ASV36  ASV37  ASV38  ASV39  ASV40  ASV41  ASV42  ASV43  ASV44 
     0     15      0      0      0      0      0     19      0      0      0 
 ASV45  ASV46  ASV47  ASV48  ASV49  ASV50  ASV51  ASV52  ASV53  ASV54  ASV55 
     0      0      0      0     20      0      0      0     17      0     30 
 ASV56  ASV57  ASV58  ASV59  ASV60  ASV61  ASV62  ASV63  ASV64  ASV65  ASV66 
     0      0     15      0     12      0      0      0     14      0      0 
 ASV67  ASV68  ASV69  ASV70  ASV71  ASV72  ASV73  ASV74  ASV75  ASV76  ASV77 
     0      0      0      0      0     13     11      7      0      0      0 
 ASV78  ASV79  ASV80  ASV81  ASV82  ASV83  ASV84  ASV85  ASV86  ASV87  ASV88 
     0      0      0      0      0      0      0      0     10      0      0 
 ASV89  ASV90  ASV91  ASV92  ASV93  ASV94  ASV95  ASV96  ASV97  ASV98  ASV99 
     0      0      8      0      7      0      0      0      0      0     16 
ASV100 ASV101 ASV102 ASV103 ASV104 ASV105 ASV106 ASV107 ASV108 ASV109 ASV110 
     8      0      0      0      0      0      0      0     15      0      0 
ASV111 ASV112 ASV113 ASV114 ASV115 ASV116 ASV117 ASV118 ASV119 ASV120 ASV121 
     0      0      0      0      0      0     12      9      0      0      4 
ASV122 ASV123 ASV124 ASV125 ASV126 ASV127 ASV128 ASV129 ASV130 ASV131 ASV132 
     0      0      0      0      2      0      0      0      0      0      0 
ASV133 ASV134 ASV135 ASV136 ASV137 ASV138 ASV139 ASV140 ASV141 ASV142 ASV143 
     0      0      0      0      0      0      0      0      0      0      0 
ASV144 ASV145 ASV146 ASV147 ASV148 ASV149 ASV150 ASV151 ASV152 ASV153 ASV154 
     0      0      0      0      0      0      0      0      0      0      0 
ASV155 ASV156 ASV157 ASV158 ASV159 ASV160 ASV161 ASV162 ASV163 ASV164 ASV165 
     7      0      0      0      0      0      0      0      0      0      0 
ASV166 ASV167 ASV168 ASV169 ASV170 ASV171 ASV172 ASV173 ASV174 ASV175 ASV176 
     0      0      0      0      0      0      0      0      0      0      0 
ASV177 ASV178 ASV179 ASV180 ASV181 ASV182 ASV183 ASV184 ASV185 ASV186 ASV187 
     0      0      0      0      0      0      0      4      0      0      0 
ASV188 ASV189 ASV190 ASV191 ASV192 ASV193 ASV194 ASV195 ASV196 ASV197 ASV198 
     0      0      0      0      0      0      0      0      0      0      0 
ASV199 ASV200 ASV201 ASV202 ASV203 ASV204 ASV205 ASV206 ASV207 ASV208 ASV209 
     0      0      0      0      0      2      0      0      0      0      0 
ASV210 ASV211 ASV212 ASV213 
     0      0      0      0 </code></pre>
</div>
</div>
</section>
<section id="get-all-phyla-detected-in-your-samples" class="level2" data-number="3.13">
<h2 data-number="3.13" class="anchored" data-anchor-id="get-all-phyla-detected-in-your-samples"><span class="header-section-number">3.13</span> Get All phyla detected in your samples</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Taxonomic rank should be one from rank_names(physeq)...ALWAYS, case sensitive! </span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">get_taxa_unique</span>(physeq, <span class="at">taxonomic.rank =</span> <span class="st">"Phylum"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Cyanobacteria"                 "Proteobacteria"               
 [3] "Thermoplasmatota"              "Actinobacteriota"             
 [5] "Bacteroidota"                  "Dadabacteria"                 
 [7] "SAR324 clade(Marine group B)"  "Chloroflexi"                  
 [9] "Marinimicrobia (SAR406 clade)" "Verrucomicrobiota"            
[11] "Desulfobacterota"             </code></pre>
</div>
</div>
</section>
<section id="distribution-of-asvs-by-phylum-taxonomic-rank" class="level2" data-number="3.14">
<h2 data-number="3.14" class="anchored" data-anchor-id="distribution-of-asvs-by-phylum-taxonomic-rank"><span class="header-section-number">3.14</span> Distribution of ASVs by phylum taxonomic rank</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(phyloseq<span class="sc">::</span><span class="fu">tax_table</span>(physeq)[, <span class="st">"Phylum"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
             Actinobacteriota                  Bacteroidota 
                           19                            15 
                  Chloroflexi                 Cyanobacteria 
                            4                            14 
                 Dadabacteria              Desulfobacterota 
                            3                             1 
Marinimicrobia (SAR406 clade)                Proteobacteria 
                            9                           116 
 SAR324 clade(Marine group B)              Thermoplasmatota 
                            2                            26 
            Verrucomicrobiota 
                            4 </code></pre>
</div>
</div>
</section>
</section>
<section id="subsampling-normalization" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Subsampling normalization</h1>
<section id="rarefaction-curves" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="rarefaction-curves"><span class="header-section-number">4.1</span> Rarefaction Curves</h2>
<p>Before normalization by sub-sampling, lets have a look at rarefaction curves, evaluate your sequencing effort and make decisions</p>
<section id="identify-your-minimum-sample-size" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="identify-your-minimum-sample-size"><span class="header-section-number">4.1.1</span> Identify your minimum sample size</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">sample_sums</span>(physeq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>S11B  S1B  S2B  S2S  S3B  S3S  S4B  S4S  S5B  S5S  S6B  S6S  S7B  S7S  S8B  S8S 
 975  837  893  983  878  889  917 1077 1018 1006 1076  937  878  936  846  958 
 S9B  S9S 
 888  991 </code></pre>
</div>
</div>
</section>
<section id="what-is-the-minimum-sample-size" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="what-is-the-minimum-sample-size"><span class="header-section-number">4.1.2</span> What is the minimum sample size?</h3>
<p>Run rarefaction curves using our custom function <code>ggrare()</code> (defined in <code>R/alpha_diversity.R</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Make rarefaction curves &amp; Add min sample size line</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggrare</span>(physeq, <span class="at">step =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"Description"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">min</span>(<span class="fu">sample_sums</span>(physeq)), <span class="at">color =</span> <span class="st">"gray60"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-27-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Do you think is a good idea to normalize your data using this minimal sample size?</strong></p>
</section>
</section>
<section id="normalization-process-for-alpha-diversity-sub-sampling" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="normalization-process-for-alpha-diversity-sub-sampling"><span class="header-section-number">4.2</span> Normalization process for alpha diversity: sub-sampling</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>physeq_rar <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">rarefy_even_depth</span>(physeq, <span class="at">rngseed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Check the number of sequences for each sample using sample_sums function</strong></p>
<p><strong>Did you lost a lot of ASVs?</strong></p>
</section>
<section id="run-rarefaction-curves-on-normalized-data" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="run-rarefaction-curves-on-normalized-data"><span class="header-section-number">4.3</span> Run rarefaction curves on normalized data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fu">ggrare</span>(physeq_rar, <span class="at">step =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"Description"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="group-separation" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="group-separation"><span class="header-section-number">4.4</span> Group separation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>p0 <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Geo, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="alpha-diversity" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Alpha Diversity</h1>
<section id="indices" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="indices"><span class="header-section-number">5.1</span> Indices</h2>
<section id="get-taxonomy-based-diversity-indices" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="get-taxonomy-based-diversity-indices"><span class="header-section-number">5.1.1</span> Get taxonomy-based diversity indices</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Get indices with alpha function (NB: index="all" if you want all the indices)</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>alpha_indices <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">alpha</span>(</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  physeq_rar,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"observed"</span>, <span class="st">"diversity_gini_simpson"</span>,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>          <span class="st">"diversity_shannon"</span>, <span class="st">"evenness_pielou"</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>          <span class="st">"dominance_relative"</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co">#save</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(alpha_indices,</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">file =</span> <span class="fu">file.path</span>(output_alpha, <span class="st">"indices_alpha_resultat.txt"</span>),</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="co">#which type?</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(alpha_indices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data.frame"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>alpha_indices</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     observed diversity_gini_simpson diversity_shannon evenness_pielou
S11B       36              0.9447863          3.146480       0.8780420
S1B        35              0.9477924          3.177766       0.8937989
S2B        43              0.9577758          3.408022       0.9060997
S2S        36              0.9414576          3.112066       0.8684385
S3B        41              0.9503989          3.275906       0.8821441
S3S        38              0.9491313          3.246802       0.8925706
S4B        40              0.9570249          3.350694       0.9083230
S4S        40              0.9363446          3.097474       0.8396788
S5B        32              0.9271578          2.978541       0.8594252
S5S        33              0.9253250          2.993341       0.8560944
S6B        41              0.9439556          3.213508       0.8653415
S6S        28              0.8247810          2.440971       0.7325395
S7B        36              0.9435901          3.157702       0.8811735
S7S        44              0.9488744          3.278296       0.8663140
S8B        33              0.9452117          3.108474       0.8890226
S8S        39              0.9517578          3.307644       0.9028494
S9B        36              0.9443038          3.105908       0.8667202
S9S        33              0.9487545          3.180393       0.9095912
     dominance_relative
S11B         0.10274791
S1B          0.10274791
S2B          0.09677419
S2S          0.10991637
S3B          0.10991637
S3S          0.10991637
S4B          0.08721625
S4S          0.14336918
S5B          0.16606930
S5S          0.18876941
S6B          0.13620072
S6S          0.38351254
S7B          0.13022700
S7S          0.10633214
S8B          0.09438471
S8S          0.09677419
S9B          0.09438471
S9S          0.10394265</code></pre>
</div>
</div>
<p><strong>What can you say about S6S?</strong></p>
</section>
<section id="add-the-alpha-indices-result-to-your-metadata-sample_data-phyloseq-object" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="add-the-alpha-indices-result-to-your-metadata-sample_data-phyloseq-object"><span class="header-section-number">5.1.2</span> Add the alpha indices result to your metadata (sample_data) phyloseq object</h3>
<p>Important because many times you will probably want to add new variables in the phyloseq class object!!!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Turn into sample_data object : sample_data function</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>alpha_indices <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">sample_data</span>(alpha_indices)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co">#See</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(alpha_indices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sample_data"
attr(,"package")
[1] "phyloseq"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Add alpha_indices to phyloseq sample_data object: merge_phyloseq function!</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>physeq_rar <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">merge_phyloseq</span>(physeq_rar, alpha_indices)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co">#See the result</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_data</span>(physeq_rar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="get-phylogeny-based-diversity-indices-get_nri_nti-function" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="get-phylogeny-based-diversity-indices-get_nri_nti-function"><span class="header-section-number">5.1.3</span> Get phylogeny based diversity indices: get_NRI_NTI function</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CalculateNRI,NTI,PD...: get_NRI_NTI function</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>ind_comp <span class="ot">&lt;-</span> MicrobiotaProcess<span class="sc">::</span><span class="fu">get_NRI_NTI</span>(physeq_rar,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">abundance.weighted =</span> <span class="cn">FALSE</span>,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">metric =</span> <span class="st">"all"</span>,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Retrieve only those of interest :select function, results are in ind_comp@alpha</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>indi_comp <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ind_comp<span class="sc">@</span>alpha)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>NRI_NTI_PB <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(indi_comp, NRI<span class="sc">:</span>PD)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>NRI_NTI_PB</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             NRI           NTI       PD
S11B -1.70064052 -1.7348808000 3.532377
S1B   1.17623968 -0.7634036100 3.315546
S2B  -0.26125740 -0.6647458642 3.697007
S2S  -2.45515064 -0.7418024886 3.422223
S3B   0.62045110 -1.2987453680 3.683481
S3S  -0.14108530 -0.7345369499 3.440318
S4B  -0.48556229  0.0045554178 3.317148
S4S   1.77346210 -0.9136191708 3.436577
S5B   0.15698400  0.1315279847 2.959208
S5S  -0.13425169  1.8924504384 2.473861
S6B   0.21850759  1.0880702249 3.122788
S6S   2.63122819  0.0003761727 2.422982
S7B  -1.47035872 -0.6371365496 3.169274
S7S  -2.51835742  0.7082829258 3.453089
S8B  -0.09163059  0.7447376259 2.935800
S8S  -1.20596938  0.4464282161 3.301764
S9B  -0.07394926  0.3100746390 2.880719
S9S   0.44303515  2.4561469676 2.437359</code></pre>
</div>
</div>
</section>
<section id="again-add-the-phylogenetic-indices-to-your-metadata-sample_data-phyloseq-object" class="level3" data-number="5.1.4">
<h3 data-number="5.1.4" class="anchored" data-anchor-id="again-add-the-phylogenetic-indices-to-your-metadata-sample_data-phyloseq-object"><span class="header-section-number">5.1.4</span> Again!!! Add the phylogenetic indices to your metadata (sample_data) phyloseq object</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Turn into sample_data object : sample_data function</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>NRI_NTI_PB <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">sample_data</span>(NRI_NTI_PB)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Add alpha_indices to phyloseq sample_data object: merge_phyloseq function!</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>physeq_rar <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">merge_phyloseq</span>(physeq_rar, NRI_NTI_PB)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co">#See the result with all the indices included</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_data</span>(physeq_rar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importance-of-metadata-tablefile" class="level3" data-number="5.1.5">
<h3 data-number="5.1.5" class="anchored" data-anchor-id="importance-of-metadata-tablefile"><span class="header-section-number">5.1.5</span> Importance of metadata table/file</h3>
<p><em>Metadata groups all the meta information (category/numerical) such as sample names, geographic group, treatment groups (disease/normal), measures of environmental factors, alpha diversity indices etc.</em> <em>This table is central for further analyses and graphic representations</em> <em>You saw how to add alpha indices from calculation with alpha function</em> <em>Now, how to add a customized variable in metadata?</em></p>
</section>
<section id="add-my-own-variable-to-metadata" class="level3" data-number="5.1.6">
<h3 data-number="5.1.6" class="anchored" data-anchor-id="add-my-own-variable-to-metadata"><span class="header-section-number">5.1.6</span> Add my own variable to metadata</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create a dataframe with a vector with  values of your new variable</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>mydataframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">MYNEWVAR =</span> <span class="fu">c</span>(<span class="st">"sediment"</span>, <span class="st">"mer"</span>, <span class="st">"sediment"</span>,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"trap"</span>, <span class="st">"mer"</span>, <span class="st">"mer"</span>,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"trap"</span>, <span class="st">"trap"</span>, <span class="st">"trap"</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"sediment"</span>, <span class="st">"mer"</span>, <span class="st">"mer"</span>,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"mer"</span>, <span class="st">"trap"</span>, <span class="st">"trap"</span>,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"mer"</span>, <span class="st">"mer"</span>, <span class="st">"sediment"</span>))</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Add rownames=samples names</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(mydataframe) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"S2S"</span>, <span class="st">"S1B"</span>, <span class="st">"S2B"</span>,</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"S3S"</span>, <span class="st">"S3B"</span>, <span class="st">"S4S"</span>,</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"S4B"</span>, <span class="st">"S5S"</span>, <span class="st">"S5B"</span>,</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"S6S"</span>, <span class="st">"S6B"</span>, <span class="st">"S7S"</span>,</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"S7B"</span>, <span class="st">"S8S"</span>, <span class="st">"S8B"</span>,</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"S9S"</span>, <span class="st">"S9B"</span>, <span class="st">"S11B"</span>)</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="co"># See &amp; notice that order of sample names is not the same as in physeq_rar@sam_data</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>mydataframe</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     MYNEWVAR
S2S  sediment
S1B       mer
S2B  sediment
S3S      trap
S3B       mer
S4S       mer
S4B      trap
S5S      trap
S5B      trap
S6S  sediment
S6B       mer
S7S       mer
S7B       mer
S8S      trap
S8B      trap
S9S       mer
S9B       mer
S11B sediment</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>mydataframe <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">sample_data</span>(mydataframe)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Add your own variable</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>physeq_rar <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">merge_phyloseq</span>(physeq_rar, mydataframe)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result with your MYNEWVAR with ordenring Ok as merge_phyloseq manages it for you</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_data</span>(physeq_rar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="alpha-diversity-representations" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="alpha-diversity-representations"><span class="header-section-number">5.2</span> Alpha diversity representations</h2>
<p><em>This section will show you how to plot by different ways the alpha diversity and its customization.</em> <em>Understand how it works!</em></p>
<section id="alpha-representations-using-phyloseqplot_richness" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="alpha-representations-using-phyloseqplot_richness"><span class="header-section-number">5.2.1</span> Alpha representations using phyloseq::plot_richness()</h3>
<p><em>You are limited to the indices calculated by the phyloseq::estimate_richness function</em> <em>(i.e.Observed, Chao1, ACE, Shannon, Simpson, InvSimpson, Fisher).</em></p>
<section id="selected-indices-sampname" class="level4" data-number="5.2.1.1">
<h4 data-number="5.2.1.1" class="anchored" data-anchor-id="selected-indices-sampname"><span class="header-section-number">5.2.1.1</span> Selected indices + SampName</h4>
<p><code>x</code> allow you to choose the column from sample_data(physeq_rar) for applying the label</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">plot_richness</span>(physeq_rar, <span class="at">x =</span> <span class="st">"SampName"</span>,</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">measures =</span> <span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Shannon"</span>, <span class="st">"Simpson"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="color-by-group-color-geo-change-sample-name" class="level4" data-number="5.2.1.2">
<h4 data-number="5.2.1.2" class="anchored" data-anchor-id="color-by-group-color-geo-change-sample-name"><span class="header-section-number">5.2.1.2</span> Color by group: <code>color = Geo</code> &amp; change sample name</h4>
<p>For color option pass the column of <code>sample_data(physeq_rar)</code> that you want. Here different colors is applied depending on <code>Geo</code> (which is North and South, so 2 different colors)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">plot_richness</span>(physeq_rar,</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">x =</span> <span class="st">"Description"</span>,</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color=</span><span class="st">"Geo"</span>,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">measures=</span><span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Shannon"</span>, <span class="st">"Simpson"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="make-box_plot-by-adding-geom_boxplot-function" class="level4" data-number="5.2.1.3">
<h4 data-number="5.2.1.3" class="anchored" data-anchor-id="make-box_plot-by-adding-geom_boxplot-function"><span class="header-section-number">5.2.1.3</span> Make box_plot by adding geom_boxplot function</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">plot_richness</span>(physeq_rar,</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">x=</span><span class="st">"Geo"</span>,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color=</span><span class="st">"Geo"</span>,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">measures=</span><span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Shannon"</span>, <span class="st">"Simpson"</span>)) <span class="sc">+</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="make-box_plot-geom_boxplot-fill-color-of-boxplot-fill-transparency-with-alpha" class="level4" data-number="5.2.1.4">
<h4 data-number="5.2.1.4" class="anchored" data-anchor-id="make-box_plot-geom_boxplot-fill-color-of-boxplot-fill-transparency-with-alpha"><span class="header-section-number">5.2.1.4</span> Make box_plot : geom_boxplot + fill color of boxplot (fill) + transparency (with alpha)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">plot_richness</span>(physeq_rar,</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">x=</span><span class="st">"Geo"</span>,</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">measures=</span><span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Shannon"</span>, <span class="st">"Simpson"</span>)) <span class="sc">+</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Geo), <span class="at">alpha =</span> <span class="fl">0.4</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="alpha-representations-using-microbiomeboxplot_alpha" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="alpha-representations-using-microbiomeboxplot_alpha"><span class="header-section-number">5.2.2</span> Alpha representations using <code>Microbiome::boxplot_alpha</code></h3>
<p>Again, you are limited to the indices calculated by the Microbiome::alpha function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>microbiome<span class="sc">::</span><span class="fu">boxplot_alpha</span>(physeq_rar,</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">index =</span> <span class="st">"observed"</span>,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">violin =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x_var =</span> <span class="st">"Geo"</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fill.colors =</span> <span class="fu">c</span>(<span class="at">North=</span><span class="st">"#00AFBB"</span>, <span class="at">South=</span><span class="st">"#E7B800"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `.data` argument of `add_column()` must have unique names as of tibble 3.0.0.
Use `.name_repair = "minimal"`.
This warning is displayed once every 8 hours.
Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="alpha-representations-using-ggplot2" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="alpha-representations-using-ggplot2"><span class="header-section-number">5.2.3</span> Alpha representations using ggplot2</h3>
<p>Interest: Freedom!! you can use ANY indices that you have calculated from different packages &amp; included in sample_data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Before : Change your phyloseq class oject sample_data as a dataframe</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>metadata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(physeq_rar))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="basic-points-color" class="level4" data-number="5.2.3.1">
<h4 data-number="5.2.3.1" class="anchored" data-anchor-id="basic-points-color"><span class="header-section-number">5.2.3.1</span> basic: points &amp; color</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#You use the columns of the metadata (Geo, observed, groupe etc)</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> Geo, <span class="at">y =</span> observed)) <span class="sc">+</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> groupe, <span class="at">fill =</span> groupe))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="deals-with-superposed-points-geom_dotplot" class="level4" data-number="5.2.3.2">
<h4 data-number="5.2.3.2" class="anchored" data-anchor-id="deals-with-superposed-points-geom_dotplot"><span class="header-section-number">5.2.3.2</span> Deals with superposed points: <code>geom_dotplot()</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> Geo, <span class="at">y =</span> observed)) <span class="sc">+</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">"y"</span>, <span class="at">stackdir =</span> <span class="st">"center"</span>, <span class="at">stackgroups =</span> <span class="cn">TRUE</span>,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">color =</span> groupe, <span class="at">fill =</span> groupe)) <span class="sc">+</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Geographic position"</span>) <span class="sc">+</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Number of Observed ASVs"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="boxplot-color-control-scale_fill-scale_color" class="level4" data-number="5.2.3.3">
<h4 data-number="5.2.3.3" class="anchored" data-anchor-id="boxplot-color-control-scale_fill-scale_color"><span class="header-section-number">5.2.3.3</span> Boxplot &amp; color control : <code>scale_fill</code> &amp; <code>scale_color</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> Geo, <span class="at">y =</span> observed)) <span class="sc">+</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="fu">aes</span>(<span class="at">color =</span> Geo, <span class="at">fill =</span> Geo)) <span class="sc">+</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> Geo, <span class="at">y =</span> observed)) <span class="sc">+</span> </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="fu">aes</span>(<span class="at">color =</span> Geo, <span class="at">fill =</span> Geo)) <span class="sc">+</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>)) <span class="sc">+</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="boxplot-color-control-points-geom_jitter" class="level4" data-number="5.2.3.4">
<h4 data-number="5.2.3.4" class="anchored" data-anchor-id="boxplot-color-control-points-geom_jitter"><span class="header-section-number">5.2.3.4</span> Boxplot, color control &amp; points: <code>geom_jitter()</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> Geo, <span class="at">y =</span> observed)) <span class="sc">+</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>),</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>))<span class="sc">+</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> groupe), <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.07</span>), <span class="at">cex =</span> <span class="fl">2.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="boxplot-color-control-points-and-mean-sd-stat_summary" class="level4" data-number="5.2.3.5">
<h4 data-number="5.2.3.5" class="anchored" data-anchor-id="boxplot-color-control-points-and-mean-sd-stat_summary"><span class="header-section-number">5.2.3.5</span> Boxplot, color control, points and Mean SD: <code>stat_summary()</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> Geo, <span class="at">y =</span> observed)) <span class="sc">+</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>),</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>)) <span class="sc">+</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> groupe), <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.07</span>), <span class="at">cex =</span> <span class="fl">2.2</span>) <span class="sc">+</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">17</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_se"</span>, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> .<span class="dv">1</span>, <span class="at">color =</span> <span class="st">"white"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="combine-graphs-on-same-figure-patchwork" class="level4" data-number="5.2.3.6">
<h4 data-number="5.2.3.6" class="anchored" data-anchor-id="combine-graphs-on-same-figure-patchwork"><span class="header-section-number">5.2.3.6</span> Combine graphs on same figure: <code>patchwork</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Put your  graphs in different variables P1,P2,P3</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> Geo, <span class="at">y =</span> observed)) <span class="sc">+</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>,<span class="st">"#E7B800"</span>),</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="fu">c</span>(<span class="st">"#00AFBB"</span>,<span class="st">"#E7B800"</span>)) <span class="sc">+</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> groupe), <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.07</span>), <span class="at">cex =</span> <span class="fl">2.2</span>) <span class="sc">+</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> Geo, <span class="at">y =</span> evenness_pielou)) <span class="sc">+</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>),</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>)) <span class="sc">+</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> groupe), <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.07</span>), <span class="at">cex =</span> <span class="fl">2.2</span>) <span class="sc">+</span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> Geo, <span class="at">y =</span> diversity_gini_simpson)) <span class="sc">+</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>),</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>)) <span class="sc">+</span></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> groupe), <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.07</span>), <span class="at">cex =</span> <span class="fl">2.2</span>) <span class="sc">+</span></span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Put the grpah of p1, p2 and p3 on same Figure</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>) <span class="sc">+</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggpubr::ggarrange(p1, p2, p3, ncol = 3, nrow = 1,common.legend = TRUE, legend = "right",labels=c("A","B","C"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="univariate-statistics-for-alpha-diversity" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="univariate-statistics-for-alpha-diversity"><span class="header-section-number">5.3</span> Univariate Statistics for alpha diversity</h2>
<section id="normality-test-check-the-normal-or-not-normal-distribution-of-your-data-to-choose-the-right-test" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="normality-test-check-the-normal-or-not-normal-distribution-of-your-data-to-choose-the-right-test"><span class="header-section-number">5.3.1</span> Normality test: Check the Normal or not normal distribution of your data to choose the right test!</h3>
<section id="shapiro-test-h0-null-hypothesis-follows-normal-distribution" class="level4" data-number="5.3.1.1">
<h4 data-number="5.3.1.1" class="anchored" data-anchor-id="shapiro-test-h0-null-hypothesis-follows-normal-distribution"><span class="header-section-number">5.3.1.1</span> Shapiro test: H0 Null Hypothesis: follows Normal distribution!</h4>
<p>Means if p&lt;0.05 -&gt; reject the H0 (so does not follow a normal distribution)</p>
</section>
<section id="q-qplots-compare-your-distribution-with-a-theoretical-normal-distribution" class="level4" data-number="5.3.1.2">
<h4 data-number="5.3.1.2" class="anchored" data-anchor-id="q-qplots-compare-your-distribution-with-a-theoretical-normal-distribution"><span class="header-section-number">5.3.1.2</span> Q-Qplots: Compare your distribution with a theoretical normal distribution</h4>
<p>If your data follow a normal distribution, youre expecting a linear relationship theoritical vs.&nbsp;experimental</p>
<p>Our custom function <code>indices_normality()</code> (defined in <code>R/alpha_diversity.R</code>) plots the results of Shapiro test as well as Q-Qplots.</p>
</section>
</section>
<section id="select-indices-to-test-run-normality-check" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="select-indices-to-test-run-normality-check"><span class="header-section-number">5.3.2</span> Select indices to test &amp; run normality check</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>metadata <span class="sc">|&gt;</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(observed,</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>                diversity_gini_simpson,</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>                diversity_shannon,</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>                evenness_pielou,</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>                PD) <span class="sc">|&gt;</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">indices_normality</span>(<span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>What are your conclusions?</p>
</section>
<section id="anova-parametric-follows-normal-distribution-and-at-least-3-groups" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="anova-parametric-follows-normal-distribution-and-at-least-3-groups"><span class="header-section-number">5.3.3</span> ANOVA: parametric (follows normal distribution) AND at least 3 groups</h3>
<section id="anova-for-observed-asv-and-4-groups" class="level4" data-number="5.3.3.1">
<h4 data-number="5.3.3.1" class="anchored" data-anchor-id="anova-for-observed-asv-and-4-groups"><span class="header-section-number">5.3.3.1</span> Anova for Observed ASV and 4 groups</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many groups used? See the column "groupe" of metadata:</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">factor</span>(metadata<span class="sc">$</span>groupe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] SGF NBF NBF NBS NBF NBS NBF NBS NBF NBS SGF SGS SGF SGS SGF SGS SGF SGS
Levels: NBF NBS SGF SGS</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check homogeneity of variance between groups</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (avoid bias in ANOVA result &amp; keep the power of the test)</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co"># H0= equality of variances in the different populations</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">bartlett.test</span>(observed <span class="sc">~</span> groupe, metadata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  observed by groupe
Bartlett's K-squared = 3.1798, df = 3, p-value = 0.3647</code></pre>
</div>
</div>
<p><strong>Conclusion?</strong></p>
</section>
</section>
<section id="alternative-to-bartlett-levene-test-package-car-less-sensitive-to-normality-deviation" class="level3" data-number="5.3.4">
<h3 data-number="5.3.4" class="anchored" data-anchor-id="alternative-to-bartlett-levene-test-package-car-less-sensitive-to-normality-deviation"><span class="header-section-number">5.3.4</span> Alternative to Bartlett : Levene test (package car), less sensitive to normality deviation</h3>
<p>Global Test: Anova tell you if that some of the group means are different, but you dont know which pairs of groups are different!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>aov_observed <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">aov</span>(observed <span class="sc">~</span> groupe, metadata)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov_observed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
groupe       3  13.03   4.343   0.211  0.887
Residuals   14 288.75  20.625               </code></pre>
</div>
</div>
<p>Which pairs of groups are different? -&gt; Post-hoc test: Tukey multiple pairwise-comparisons</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>signif_pairgroups <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">TukeyHSD</span>(aov_observed, <span class="at">method =</span> <span class="st">"bh"</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>signif_pairgroups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: stats::aov(formula = observed ~ groupe, data = metadata)

$groupe
         diff        lwr      upr     p adj
NBS-NBF -1.45 -10.304898 7.404898 0.9631679
SGF-NBF -1.80 -10.148478 6.548478 0.9217657
SGS-NBF -2.20 -11.054898 6.654898 0.8866424
SGF-NBS -0.35  -9.204898 8.504898 0.9994302
SGS-NBS -0.75 -10.083882 8.583882 0.9953019
SGS-SGF -0.40  -9.254898 8.454898 0.9991510</code></pre>
</div>
</div>
</section>
<section id="kruskal-wallis-non-parametric-at-least-three-groups" class="level3" data-number="5.3.5">
<h3 data-number="5.3.5" class="anchored" data-anchor-id="kruskal-wallis-non-parametric-at-least-three-groups"><span class="header-section-number">5.3.5</span> Kruskal-Wallis: non-parametric &amp; at least three groups</h3>
<section id="kruskal-for-diversity_shannon-and-4-groups" class="level4" data-number="5.3.5.1">
<h4 data-number="5.3.5.1" class="anchored" data-anchor-id="kruskal-for-diversity_shannon-and-4-groups"><span class="header-section-number">5.3.5.1</span> Kruskal for diversity_shannon and 4 groups</h4>
<p>Global test</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">kruskal.test</span>(diversity_shannon <span class="sc">~</span> groupe, <span class="at">data =</span> metadata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  diversity_shannon by groupe
Kruskal-Wallis chi-squared = 2.9544, df = 3, p-value = 0.3987</code></pre>
</div>
</div>
<p>Post hoc test: Dunn test (pairwise group test)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>signifgroup <span class="ot">&lt;-</span> FSA<span class="sc">::</span><span class="fu">dunnTest</span>(diversity_shannon <span class="sc">~</span> groupe,</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> metadata,</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"bh"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: groupe was coerced to a factor.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">#See</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>signifgroup</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Comparison          Z   P.unadj     P.adj
1  NBF - NBS  1.5218359 0.1280502 0.7683013
2  NBF - SGF  1.2439326 0.2135244 0.6405731
3  NBS - SGF -0.3490449 0.7270556 0.7270556
4  NBF - SGS  0.4048921 0.6855568 0.8226682
5  NBS - SGS -1.0596259 0.2893148 0.5786297
6  SGF - SGS -0.7678988 0.4425473 0.6638209</code></pre>
</div>
</div>
</section>
</section>
<section id="t-test-parametric-2-groups-i.e-north-vs.-sud" class="level3" data-number="5.3.6">
<h3 data-number="5.3.6" class="anchored" data-anchor-id="t-test-parametric-2-groups-i.e-north-vs.-sud"><span class="header-section-number">5.3.6</span> T-test: parametric, 2 groups (<em>i.e</em> North Vs. Sud)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">bartlett.test</span>(observed <span class="sc">~</span> Geo, metadata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  observed by Geo
Bartlett's K-squared = 0.38191, df = 1, p-value = 0.5366</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>observed_ttest <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">t.test</span>(observed <span class="sc">~</span> Geo, <span class="at">data =</span> metadata)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>observed_ttest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  observed by Geo
t = 0.66008, df = 15.246, p-value = 0.5191
alternative hypothesis: true difference in means between group North and group South is not equal to 0
95 percent confidence interval:
 -2.966072  5.632739
sample estimates:
mean in group North mean in group South 
           37.55556            36.22222 </code></pre>
</div>
</div>
</section>
<section id="wilcoxon-rank-sum-non-parametric-2-groups" class="level3" data-number="5.3.7">
<h3 data-number="5.3.7" class="anchored" data-anchor-id="wilcoxon-rank-sum-non-parametric-2-groups"><span class="header-section-number">5.3.7</span> Wilcoxon rank sum: non-parametric &amp; 2 Groups</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>pairwise_test <span class="ot">&lt;-</span> ggpubr<span class="sc">::</span><span class="fu">compare_means</span>(diversity_shannon <span class="sc">~</span> Geo,</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>                                       metadata,</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">method =</span> <span class="st">"wilcox.test"</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="co">#See</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>pairwise_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1  8
  .y.               group1 group2     p p.adj p.format p.signif method  
  &lt;chr&gt;             &lt;chr&gt;  &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;   
1 diversity_shannon South  North  0.863  0.86 0.86     ns       Wilcoxon</code></pre>
</div>
</div>
</section>
<section id="boxplot-representation-with-p-value-information" class="level3" data-number="5.3.8">
<h3 data-number="5.3.8" class="anchored" data-anchor-id="boxplot-representation-with-p-value-information"><span class="header-section-number">5.3.8</span> Boxplot representation with p-value information</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Boxplot as previously seen</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>graph_shan <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> Geo, <span class="at">y =</span> diversity_shannon)) <span class="sc">+</span> </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.6</span>,</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>),</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>)) <span class="sc">+</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> groupe),</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.02</span>) ,</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">cex=</span><span class="fl">2.2</span>)<span class="sc">+</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">17</span>, <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"white"</span>)</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Add p-value on graph</span></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>graph_shan <span class="sc">+</span> ggpubr<span class="sc">::</span><span class="fu">stat_pvalue_manual</span>(</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>  pairwise_test,</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">y.position =</span> <span class="fl">3.5</span>,</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">"p.adj = {p.adj}"</span>,</span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">linetype =</span> <span class="dv">1</span>,</span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">tip.length =</span> <span class="fl">0.01</span></span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="bivariate-statistics-linear-regression" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Bivariate statistics &amp; linear Regression</h1>
<section id="correlation-analysis" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="correlation-analysis"><span class="header-section-number">6.1</span> Correlation analysis</h2>
<p>Methods available are <code>spearman</code>, <code>kendall</code> and <code>pearson</code>. Correlation coefficient r is <strong>independent of change of origin and scale (So no data transformation!!)</strong>. Correlation analysis describes the nature (strength (0-&gt;1) and direction +/-) of the relationship between two variables (r), whatever the range and the measurement units of them.</p>
<p>Considerations for statistical tests (test of the value being zero): * Pearsons test is parametric (normal distribution required) * Spearmans and Kendalls tests are non-parametric</p>
<section id="select-variables" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="select-variables"><span class="header-section-number">6.1.1</span> Select variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Select variables for bivariate correlation</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>myvariables <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(metadata, SiOH4<span class="sc">:</span>PO4, observed,</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>                             diversity_shannon, PD)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>myvariables</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     SiOH4   NO2   NO3   NH4   PO4 observed diversity_shannon       PD
S11B 3.324 0.083 0.756 0.467 0.115       36          3.146480 3.532377
S1B  1.813 0.256 0.889 0.324 0.132       35          3.177766 3.315546
S2B  2.592 0.105 1.125 0.328 0.067       43          3.408022 3.697007
S2S  3.381 0.231 0.706 0.450 0.109       36          3.112066 3.422223
S3B  1.438 0.057 1.159 0.369 0.174       41          3.275906 3.683481
S3S  1.656 0.098 0.794 0.367 0.095       38          3.246802 3.440318
S4B  2.457 0.099 1.087 0.349 0.137       40          3.350694 3.317148
S4S  2.457 0.099 1.087 0.349 0.137       40          3.097474 3.436577
S5B  2.028 0.103 1.135 0.216 0.128       32          2.978541 2.959208
S5S  2.669 0.136 0.785 0.267 0.114       33          2.993341 2.473861
S6B  2.206 0.249 0.768 0.629 0.236       41          3.213508 3.122788
S6S  3.004 0.251 0.927 0.653 0.266       28          2.440971 2.422982
S7B  3.016 0.157 0.895 0.491 0.176       36          3.157702 3.169274
S7S  1.198 0.165 1.099 0.432 0.180       44          3.278296 3.453089
S8B  3.868 0.253 0.567 0.533 0.169       33          3.108474 2.935800
S8S  3.639 0.255 0.658 0.665 0.247       39          3.307644 3.301764
S9B  3.910 0.107 0.672 0.490 0.134       36          3.105908 2.880719
S9S  3.607 0.139 0.644 0.373 0.167       33          3.180393 2.437359</code></pre>
</div>
</div>
</section>
<section id="apply-the-method" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="apply-the-method"><span class="header-section-number">6.1.2</span> Apply the method</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Apply method pearson</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>matrixCor <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">cor</span>(myvariables, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>matrixCor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       SiOH4        NO2         NO3         NH4        PO4
SiOH4              1.0000000  0.2680225 -0.72770308  0.44354653  0.1194938
NO2                0.2680225  1.0000000 -0.48440242  0.62864562  0.5775735
NO3               -0.7277031 -0.4844024  1.00000000 -0.49147592 -0.1691272
NH4                0.4435465  0.6286456 -0.49147592  1.00000000  0.7744357
PO4                0.1194938  0.5775735 -0.16912716  0.77443570  1.0000000
observed          -0.4539279 -0.2844272  0.40577219 -0.06052592 -0.1598867
diversity_shannon -0.2072882 -0.2931624  0.09476396 -0.24014733 -0.3779158
PD                -0.4216740 -0.2872557  0.41958058 -0.13328333 -0.3522890
                     observed diversity_shannon         PD
SiOH4             -0.45392787       -0.20728823 -0.4216740
NO2               -0.28442718       -0.29316236 -0.2872557
NO3                0.40577219        0.09476396  0.4195806
NH4               -0.06052592       -0.24014733 -0.1332833
PO4               -0.15988665       -0.37791579 -0.3522890
observed           1.00000000        0.80004197  0.7792103
diversity_shannon  0.80004197        1.00000000  0.6703605
PD                 0.77921035        0.67036049  1.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we use a function defined in R/utils.R</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="co"># to move the row names content to a new column</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">df_export</span>(matrixCor, <span class="at">new_rn =</span> <span class="st">"variable"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           variable      SiOH4        NO2         NO3         NH4        PO4
1             SiOH4  1.0000000  0.2680225 -0.72770308  0.44354653  0.1194938
2               NO2  0.2680225  1.0000000 -0.48440242  0.62864562  0.5775735
3               NO3 -0.7277031 -0.4844024  1.00000000 -0.49147592 -0.1691272
4               NH4  0.4435465  0.6286456 -0.49147592  1.00000000  0.7744357
5               PO4  0.1194938  0.5775735 -0.16912716  0.77443570  1.0000000
6          observed -0.4539279 -0.2844272  0.40577219 -0.06052592 -0.1598867
7 diversity_shannon -0.2072882 -0.2931624  0.09476396 -0.24014733 -0.3779158
8                PD -0.4216740 -0.2872557  0.41958058 -0.13328333 -0.3522890
     observed diversity_shannon         PD
1 -0.45392787       -0.20728823 -0.4216740
2 -0.28442718       -0.29316236 -0.2872557
3  0.40577219        0.09476396  0.4195806
4 -0.06052592       -0.24014733 -0.1332833
5 -0.15988665       -0.37791579 -0.3522890
6  1.00000000        0.80004197  0.7792103
7  0.80004197        1.00000000  0.6703605
8  0.77921035        0.67036049  1.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we can now export</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">df_export</span>(matrixCor, <span class="at">new_rn =</span> <span class="st">"variable"</span>),</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">file.path</span>(output_alpha, <span class="st">"correlation_matrix.tsv"</span>),</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">quote =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-results-corrplot-function" class="level3" data-number="6.1.3">
<h3 data-number="6.1.3" class="anchored" data-anchor-id="plot-results-corrplot-function"><span class="header-section-number">6.1.3</span> Plot results: corrplot function</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  matrixCor,</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">method=</span><span class="st">"circle"</span>,</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type=</span><span class="st">"lower"</span>,</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">order=</span><span class="st">'hclust'</span>,</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.cex=</span><span class="fl">0.9</span>,</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">diag =</span> <span class="cn">FALSE</span></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="is-the-correlation-is-due-to-chance-significance-test" class="level3" data-number="6.1.4">
<h3 data-number="6.1.4" class="anchored" data-anchor-id="is-the-correlation-is-due-to-chance-significance-test"><span class="header-section-number">6.1.4</span> Is the correlation is due to chance? Significance test!</h3>
<p>The idea: Test the correlation at the population scale (=Rho) and compare to r (your samples). HO is : there is not a significant linear correlation between x and y in the population. For instance t-test allows to use sample data to generalize an assumption to an entire population.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Test stats</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>ptest <span class="ot">&lt;-</span> corrplot<span class="sc">::</span><span class="fu">cor.mtest</span>(matrixCor, <span class="at">conf.level =</span> .<span class="dv">95</span>)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co">#The p-value are stored in ptest$p</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>ptest<span class="sc">$</span>p </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         SiOH4         NO2          NO3         NH4         PO4
SiOH4             0.0000000000 0.049489497 0.0002332876 0.027766508 0.163621297
NO2               0.0494894971 0.000000000 0.0131598941 0.001291248 0.004356718
NO3               0.0002332876 0.013159894 0.0000000000 0.009159687 0.106919410
NH4               0.0277665081 0.001291248 0.0091596871 0.000000000 0.001585739
PO4               0.1636212970 0.004356718 0.1069194104 0.001585739 0.000000000
observed          0.0127916768 0.014498926 0.0315030294 0.030686706 0.031731622
diversity_shannon 0.1017556942 0.021558528 0.1531313980 0.032086176 0.007967349
PD                0.0156006175 0.010570716 0.0277011182 0.018036573 0.011994662
                      observed diversity_shannon           PD
SiOH4             1.279168e-02      0.1017556942 1.560062e-02
NO2               1.449893e-02      0.0215585277 1.057072e-02
NO3               3.150303e-02      0.1531313980 2.770112e-02
NH4               3.068671e-02      0.0320861758 1.803657e-02
PO4               3.173162e-02      0.0079673485 1.199466e-02
observed          0.000000e+00      0.0006687658 7.658065e-05
diversity_shannon 6.687658e-04      0.0000000000 1.385245e-03
PD                7.658065e-05      0.0013852451 0.000000e+00</code></pre>
</div>
</div>
</section>
<section id="show-only-correlations-with-significant-p-values" class="level3" data-number="6.1.5">
<h3 data-number="6.1.5" class="anchored" data-anchor-id="show-only-correlations-with-significant-p-values"><span class="header-section-number">6.1.5</span> Show only correlations with significant p-values</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  matrixCor,</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.mat =</span> ptest<span class="sc">$</span>p,</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>,</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"circle"</span>,</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"lower"</span>,</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">order =</span> <span class="st">'hclust'</span>,</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.cex =</span> <span class="fl">0.7</span>,</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">diag =</span> <span class="cn">FALSE</span></span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="linear-regression" class="level3" data-number="6.1.6">
<h3 data-number="6.1.6" class="anchored" data-anchor-id="linear-regression"><span class="header-section-number">6.1.6</span> Linear regression</h3>
<p>Determination coefficient R<sup>2</sup> provides percentage variation in y which is explained by all the x together. Its value is (usually) between 0 and 1 and it indicates strength of Linear Regression model. Higher the R<sup>2</sup> value, data points are less scattered so it is a good model. Lesser the R<sup>2</sup> value is more scattered the data points.</p>
<section id="shannon-observed" class="level4" data-number="6.1.6.1">
<h4 data-number="6.1.6.1" class="anchored" data-anchor-id="shannon-observed"><span class="header-section-number">6.1.6.1</span> Shannon ~ Observed</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> observed, <span class="at">y =</span> diversity_shannon)) <span class="sc">+</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  ggpmisc<span class="sc">::</span><span class="fu">stat_poly_eq</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">after_stat</span>(rr.label),</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">after_stat</span>(p.value.label),</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">sep =</span> <span class="st">"*</span><span class="sc">\"</span><span class="st">, </span><span class="sc">\"</span><span class="st">*"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="pd-observed" class="level4" data-number="6.1.6.2">
<h4 data-number="6.1.6.2" class="anchored" data-anchor-id="pd-observed"><span class="header-section-number">6.1.6.2</span> PD ~ Observed</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(metadata, <span class="fu">aes</span>(<span class="at">x =</span> observed, <span class="at">y =</span> PD)) <span class="sc">+</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  ggpmisc<span class="sc">::</span><span class="fu">stat_poly_eq</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">after_stat</span>(rr.label),</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">after_stat</span>(p.value.label),</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">sep =</span> <span class="st">"*</span><span class="sc">\"</span><span class="st">, </span><span class="sc">\"</span><span class="st">*"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Using these two examples, what should be your conclusionsbe careful</p>
<p>What are R<sup>2</sup> of these exemple? See matrixCor. Do you see the relation beetween R<sup>2</sup> and r?</p>
</section>
</section>
</section>
</section>
<section id="taxonomy-barplot-graph" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Taxonomy: barplot graph</h1>
<section id="abundance-transformation" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="abundance-transformation"><span class="header-section-number">7.1</span> Abundance Transformation</h2>
<section id="counts-in-percentage-using-phyloseqtransform_sample_counts" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="counts-in-percentage-using-phyloseqtransform_sample_counts"><span class="header-section-number">7.1.1</span> Counts in percentage using <code>phyloseq::transform_sample_counts()</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>pourcentS <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">transform_sample_counts</span>(physeq_rar, <span class="cf">function</span>(x) x<span class="sc">/</span><span class="fu">sum</span>(x) <span class="sc">*</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>See plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">plot_bar</span>(pourcentS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>What are the separation lines?</p>
</section>
<section id="summarise-at-a-given-taxonomic-level-with-phyloseqtax_glom" class="level3" data-number="7.1.2">
<h3 data-number="7.1.2" class="anchored" data-anchor-id="summarise-at-a-given-taxonomic-level-with-phyloseqtax_glom"><span class="header-section-number">7.1.2</span> Summarise at a given taxonomic level with <code>phyloseq::tax_glom()</code></h3>
<p>Remember ranks can be obtained with <code>phyloseq::rank_names()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">rank_names</span>(pourcentS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Kingdom" "Phylum"  "Class"   "Order"   "Family"  "Genus"   "Species"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>Phylum_glom <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">tax_glom</span>(pourcentS,</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">taxrank =</span> <span class="st">"Phylum"</span>,</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">NArm =</span> <span class="cn">FALSE</span>)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot at Phylum taxonomic rank, with color</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">plot_bar</span>(Phylum_glom, <span class="at">fill =</span> <span class="st">"Phylum"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>NArm?</em></p>
</section>
<section id="filter-phylum-mean-of-the-line-phyloseqfilter_taxa" class="level3" data-number="7.1.3">
<h3 data-number="7.1.3" class="anchored" data-anchor-id="filter-phylum-mean-of-the-line-phyloseqfilter_taxa"><span class="header-section-number">7.1.3</span> Filter phylum (mean of the line): <code>phyloseq::filter_taxa()</code></h3>
<p>Lets filter out the phylums with a mean relative abundance inferior to 1%</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>Phylum_1 <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">filter_taxa</span>(Phylum_glom,</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">flist =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">&gt;=</span> <span class="dv">1</span>,</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">prune =</span> <span class="cn">TRUE</span>)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot at Phylum taxonomic rank, with color</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">plot_bar</span>(Phylum_1, <span class="at">fill =</span> <span class="st">"Phylum"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="how-to-save-a-table-into-a-file-exemple-of-phylum-taxonomic-table" class="level3" data-number="7.1.4">
<h3 data-number="7.1.4" class="anchored" data-anchor-id="how-to-save-a-table-into-a-file-exemple-of-phylum-taxonomic-table"><span class="header-section-number">7.1.4</span> How to save a table into a file: exemple of phylum taxonomic table</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">df_export</span>(<span class="fu">otu_table</span>(Phylum_glom)),</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">file =</span> <span class="fu">file.path</span>(output_alpha, <span class="st">"Phylum_pourcent.tsv"</span>),</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="remove-black-lines" class="level3" data-number="7.1.5">
<h3 data-number="7.1.5" class="anchored" data-anchor-id="remove-black-lines"><span class="header-section-number">7.1.5</span> Remove black lines</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">plot_bar</span>(Phylum_glom, <span class="st">"Description"</span>, <span class="at">fill =</span> <span class="st">"Phylum"</span>) <span class="sc">+</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Phylum), <span class="at">stat =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="microbiome-package" class="level4" data-number="7.1.5.1">
<h4 data-number="7.1.5.1" class="anchored" data-anchor-id="microbiome-package"><span class="header-section-number">7.1.5.1</span> Microbiome package</h4>
<section id="microbiomeaggregate_taxa" class="level5" data-number="7.1.5.1.1">
<h5 data-number="7.1.5.1.1" class="anchored" data-anchor-id="microbiomeaggregate_taxa"><span class="header-section-number">7.1.5.1.1</span> <code>microbiome::aggregate_taxa()</code></h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Order Rank</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>Order_microb <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">aggregate_taxa</span>(pourcentS, <span class="st">"Order"</span>)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Filter at 1%</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>Order1 <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">filter_taxa</span>(Order_microb, <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">&gt;=</span> <span class="dv">1</span>, <span class="at">prune =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="microbiomeplot_composition" class="level5" data-number="7.1.5.1.2">
<h5 data-number="7.1.5.1.2" class="anchored" data-anchor-id="microbiomeplot_composition"><span class="header-section-number">7.1.5.1.2</span> <code>microbiome::plot_composition()</code></h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>p_order <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">plot_composition</span>(Order1,</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">otu.sort =</span> <span class="st">"abundance"</span>,</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">sample.sort =</span> <span class="st">"Description"</span>,</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">x.label =</span> <span class="st">"Description"</span>,</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">plot.type =</span> <span class="st">"barplot"</span>,</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">verbose =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Relative abundance (%)"</span>)</span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>p_order</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Average by group :average_by option</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>p_order_groupe <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">plot_composition</span>(Order1,</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">otu.sort =</span> <span class="st">"abundance"</span>,</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">sample.sort =</span> <span class="st">"Description"</span>,</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">x.label =</span> <span class="st">"Description"</span>,</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">plot.type =</span> <span class="st">"barplot"</span>,</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">average_by =</span> <span class="st">"Geo"</span>) <span class="sc">+</span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Relative abundance (%)"</span>)</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>p_order_groupe</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="interactive-barplot-with-plotlyggplotly" class="level4" data-number="7.1.5.2">
<h4 data-number="7.1.5.2" class="anchored" data-anchor-id="interactive-barplot-with-plotlyggplotly"><span class="header-section-number">7.1.5.2</span> Interactive barplot with <code>plotly::ggplotly()</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>plotly<span class="sc">::</span><span class="fu">ggplotly</span>(p_order)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-ecdcee306a1d6e0cab28" style="width:100%;height:464px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-ecdcee306a1d6e0cab28">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.899999999999999,0.9,0.9,0.899999999999999,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],"base":[53.763440860215,52.21027479092,61.0513739545998,65.8303464755078,55.5555555555556,67.9808841099164,65.9498207885305,63.0824372759857,51.6129032258065,71.2066905615293,69.6535244922342,73.2377538829152,73.3572281959379,75.3882915173238,74.5519713261649,81.0035842293907,79.9283154121864,93.1899641577061],"x":[7,4,6,17,2,3,15,1,5,8,18,16,9,10,14,13,12,11],"y":[37.8733572281959,36.7980884109916,35.7228195937873,33.0943847072879,30.4659498207885,30.4659498207885,30.3464755077658,29.7491039426523,27.2401433691756,27.0011947431302,26.0454002389486,24.3727598566308,23.1780167264038,22.8195937873357,21.1469534050179,15.0537634408602,13.6200716845878,6.57108721624851],"text":["Sample: S4S<br />Abundance: 37.8733572<br />Tax: SAR11 clade","Sample: S3B<br />Abundance: 36.7980884<br />Tax: SAR11 clade","Sample: S4B<br />Abundance: 35.7228196<br />Tax: SAR11 clade","Sample: S9S<br />Abundance: 33.0943847<br />Tax: SAR11 clade","Sample: S2B<br />Abundance: 30.4659498<br />Tax: SAR11 clade","Sample: S2S<br />Abundance: 30.4659498<br />Tax: SAR11 clade","Sample: S8S<br />Abundance: 30.3464755<br />Tax: SAR11 clade","Sample: S1B<br />Abundance: 29.7491039<br />Tax: SAR11 clade","Sample: S3S<br />Abundance: 27.2401434<br />Tax: SAR11 clade","Sample: S5B<br />Abundance: 27.0011947<br />Tax: SAR11 clade","Sample: S11B<br />Abundance: 26.0454002<br />Tax: SAR11 clade","Sample: S9B<br />Abundance: 24.3727599<br />Tax: SAR11 clade","Sample: S5S<br />Abundance: 23.1780167<br />Tax: SAR11 clade","Sample: S6B<br />Abundance: 22.8195938<br />Tax: SAR11 clade","Sample: S8B<br />Abundance: 21.1469534<br />Tax: SAR11 clade","Sample: S7S<br />Abundance: 15.0537634<br />Tax: SAR11 clade","Sample: S7B<br />Abundance: 13.6200717<br />Tax: SAR11 clade","Sample: S6S<br />Abundance:  6.5710872<br />Tax: SAR11 clade"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"SAR11 clade","legendgroup":"SAR11 clade","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999],"base":[30.4659498207885,44.3249701314218,49.2234169653524,49.3428912783751,45.9976105137395,57.4671445639188,51.8518518518518,71.5651135005974,61.2903225806452,62.4850657108722,68.1003584229391,59.0203106332139,51.7323775388291,61.1708482676225,49.8207885304659,55.1971326164875,52.21027479092,73.3572281959379],"x":[11,12,14,16,3,10,17,13,18,15,8,6,7,1,5,2,4,9],"y":[62.7240143369176,35.6033452807646,25.3285543608124,23.89486260454,21.9832735961768,17.921146953405,13.9784946236559,9.43847072879332,8.36320191158901,3.46475507765831,3.1063321385902,2.0310633213859,2.0310633213859,1.9115890083632,1.79211469534051,0.358422939068099,0,0],"text":["Sample: S6S<br />Abundance: 62.7240143<br />Tax: Enterobacterales","Sample: S7B<br />Abundance: 35.6033453<br />Tax: Enterobacterales","Sample: S8B<br />Abundance: 25.3285544<br />Tax: Enterobacterales","Sample: S9B<br />Abundance: 23.8948626<br />Tax: Enterobacterales","Sample: S2S<br />Abundance: 21.9832736<br />Tax: Enterobacterales","Sample: S6B<br />Abundance: 17.9211470<br />Tax: Enterobacterales","Sample: S9S<br />Abundance: 13.9784946<br />Tax: Enterobacterales","Sample: S7S<br />Abundance:  9.4384707<br />Tax: Enterobacterales","Sample: S11B<br />Abundance:  8.3632019<br />Tax: Enterobacterales","Sample: S8S<br />Abundance:  3.4647551<br />Tax: Enterobacterales","Sample: S5B<br />Abundance:  3.1063321<br />Tax: Enterobacterales","Sample: S4B<br />Abundance:  2.0310633<br />Tax: Enterobacterales","Sample: S4S<br />Abundance:  2.0310633<br />Tax: Enterobacterales","Sample: S1B<br />Abundance:  1.9115890<br />Tax: Enterobacterales","Sample: S3S<br />Abundance:  1.7921147<br />Tax: Enterobacterales","Sample: S2B<br />Abundance:  0.3584229<br />Tax: Enterobacterales","Sample: S3B<br />Abundance:  0.0000000<br />Tax: Enterobacterales","Sample: S5S<br />Abundance:  0.0000000<br />Tax: Enterobacterales"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(219,142,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Enterobacterales","legendgroup":"Enterobacterales","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.899999999999999,0.899999999999999,0.9,0.9,0.9,0.899999999999999,0.9,0.899999999999999,0.9,0.899999999999999,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],"base":[51.4934289127838,48.1481481481481,30.5854241338112,34.5280764635603,44.9223416965352,43.1302270011947,38.1123058542413,38.8291517323775,35.6033452807646,51.015531660693,49.1039426523297,45.8781362007168,40.0238948626045,21.9832735961768,63.0824372759857,55.0776583034648,38.8291517323775,43.9665471923536],"x":[9,8,5,7,1,10,4,17,3,18,6,2,16,11,13,15,12,14],"y":[21.8637992831541,19.9522102747909,19.2353643966547,17.2043010752688,16.2485065710872,14.336917562724,14.0979689366786,13.0227001194743,10.3942652329749,10.2747909199522,9.91636798088411,9.31899641577061,9.31899641577061,8.48267622461171,8.4826762246117,7.4074074074074,5.49581839904421,5.2568697729988],"text":["Sample: S5S<br />Abundance: 21.8637993<br />Tax: Synechococcales","Sample: S5B<br />Abundance: 19.9522103<br />Tax: Synechococcales","Sample: S3S<br />Abundance: 19.2353644<br />Tax: Synechococcales","Sample: S4S<br />Abundance: 17.2043011<br />Tax: Synechococcales","Sample: S1B<br />Abundance: 16.2485066<br />Tax: Synechococcales","Sample: S6B<br />Abundance: 14.3369176<br />Tax: Synechococcales","Sample: S3B<br />Abundance: 14.0979689<br />Tax: Synechococcales","Sample: S9S<br />Abundance: 13.0227001<br />Tax: Synechococcales","Sample: S2S<br />Abundance: 10.3942652<br />Tax: Synechococcales","Sample: S11B<br />Abundance: 10.2747909<br />Tax: Synechococcales","Sample: S4B<br />Abundance:  9.9163680<br />Tax: Synechococcales","Sample: S2B<br />Abundance:  9.3189964<br />Tax: Synechococcales","Sample: S9B<br />Abundance:  9.3189964<br />Tax: Synechococcales","Sample: S6S<br />Abundance:  8.4826762<br />Tax: Synechococcales","Sample: S7S<br />Abundance:  8.4826762<br />Tax: Synechococcales","Sample: S8S<br />Abundance:  7.4074074<br />Tax: Synechococcales","Sample: S7B<br />Abundance:  5.4958184<br />Tax: Synechococcales","Sample: S8B<br />Abundance:  5.2568698<br />Tax: Synechococcales"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(174,162,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Synechococcales","legendgroup":"Synechococcales","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.899999999999999,0.9,0.899999999999999,0.9,0.899999999999999,0.899999999999999,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.9],"base":[13.0227001194743,32.9749103942652,30.4659498207885,23.7753882915173,23.5364396654719,34.2891278375149,31.4217443249701,49.5818399044205,38.1123058542413,18.1600955794504,40.5017921146953,32.8554360812425,33.9307048984468,30.5854241338112,13.5005973715651,46.5949820788531,31.7801672640382,29.5101553166069],"x":[7,6,2,17,4,8,1,13,9,5,18,10,14,16,11,15,12,3],"y":[21.505376344086,16.1290322580645,15.4121863799283,15.0537634408602,14.5758661887694,13.8590203106332,13.5005973715651,13.5005973715651,13.3811230585424,12.4253285543608,10.5137395459976,10.2747909199522,10.0358422939068,9.43847072879331,8.48267622461171,8.48267622461171,7.04898446833931,6.09318996415771],"text":["Sample: S4S<br />Abundance: 21.5053763<br />Tax: Rhodospirillales","Sample: S4B<br />Abundance: 16.1290323<br />Tax: Rhodospirillales","Sample: S2B<br />Abundance: 15.4121864<br />Tax: Rhodospirillales","Sample: S9S<br />Abundance: 15.0537634<br />Tax: Rhodospirillales","Sample: S3B<br />Abundance: 14.5758662<br />Tax: Rhodospirillales","Sample: S5B<br />Abundance: 13.8590203<br />Tax: Rhodospirillales","Sample: S1B<br />Abundance: 13.5005974<br />Tax: Rhodospirillales","Sample: S7S<br />Abundance: 13.5005974<br />Tax: Rhodospirillales","Sample: S5S<br />Abundance: 13.3811231<br />Tax: Rhodospirillales","Sample: S3S<br />Abundance: 12.4253286<br />Tax: Rhodospirillales","Sample: S11B<br />Abundance: 10.5137395<br />Tax: Rhodospirillales","Sample: S6B<br />Abundance: 10.2747909<br />Tax: Rhodospirillales","Sample: S8B<br />Abundance: 10.0358423<br />Tax: Rhodospirillales","Sample: S9B<br />Abundance:  9.4384707<br />Tax: Rhodospirillales","Sample: S6S<br />Abundance:  8.4826762<br />Tax: Rhodospirillales","Sample: S8S<br />Abundance:  8.4826762<br />Tax: Rhodospirillales","Sample: S7B<br />Abundance:  7.0489845<br />Tax: Rhodospirillales","Sample: S2S<br />Abundance:  6.0931900<br />Tax: Rhodospirillales"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(100,178,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Rhodospirillales","legendgroup":"Rhodospirillales","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.9,0.899999999999999,0.899999999999999,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.9,0.899999999999999,0.9,0.9],"base":[18.0406212664277,29.6296296296296,27.479091995221,14.336917562724,13.8590203106332,18.5185185185185,18.5185185185185,20.310633213859,25.2090800477897,20.5495818399044,21.7443249701314,11.1111111111111,18.5185185185185,28.1959378733572,19.115890083632,11.7084826762246,30.3464755077658,12.6642771804062],"x":[18,13,15,12,16,14,6,8,9,2,3,5,17,10,4,11,1,7],"y":[22.4611708482676,19.9522102747909,19.115890083632,17.4432497013142,16.726403823178,15.4121863799283,14.4563918757467,13.9784946236559,12.9032258064516,9.91636798088411,7.76583034647551,7.04898446833931,5.2568697729988,4.6594982078853,4.42054958183991,1.7921146953405,1.0752688172043,0.358422939068101],"text":["Sample: S11B<br />Abundance: 22.4611708<br />Tax: Marine Group II","Sample: S7S<br />Abundance: 19.9522103<br />Tax: Marine Group II","Sample: S8S<br />Abundance: 19.1158901<br />Tax: Marine Group II","Sample: S7B<br />Abundance: 17.4432497<br />Tax: Marine Group II","Sample: S9B<br />Abundance: 16.7264038<br />Tax: Marine Group II","Sample: S8B<br />Abundance: 15.4121864<br />Tax: Marine Group II","Sample: S4B<br />Abundance: 14.4563919<br />Tax: Marine Group II","Sample: S5B<br />Abundance: 13.9784946<br />Tax: Marine Group II","Sample: S5S<br />Abundance: 12.9032258<br />Tax: Marine Group II","Sample: S2B<br />Abundance:  9.9163680<br />Tax: Marine Group II","Sample: S2S<br />Abundance:  7.7658303<br />Tax: Marine Group II","Sample: S3S<br />Abundance:  7.0489845<br />Tax: Marine Group II","Sample: S9S<br />Abundance:  5.2568698<br />Tax: Marine Group II","Sample: S6B<br />Abundance:  4.6594982<br />Tax: Marine Group II","Sample: S3B<br />Abundance:  4.4205496<br />Tax: Marine Group II","Sample: S6S<br />Abundance:  1.7921147<br />Tax: Marine Group II","Sample: S1B<br />Abundance:  1.0752688<br />Tax: Marine Group II","Sample: S4S<br />Abundance:  0.3584229<br />Tax: Marine Group II"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,189,92,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Marine Group II","legendgroup":"Marine Group II","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.9,0.899999999999999,0.9,0.9,0.899999999999999,0.9,0.9,0.899999999999999,0.9,0.899999999999999,0.899999999999999,0.9,0.899999999999999],"base":[3.584229390681,10.9916367980884,5.01792114695341,17.3237753882915,10.0358422939068,10.8721624850657,18.2795698924731,21.6248506571087,10.5137395459976,10.9916367980884,6.21266427718041,13.0227001194743,7.88530465949821,16.8458781362007,7.28793309438471,11.5890083632019,8.72162485065711,15.7706093189964],"x":[9,13,17,10,8,2,15,1,6,14,7,4,16,3,11,12,5,18],"y":[21.6248506571087,18.6379928315412,13.5005973715651,10.8721624850657,10.2747909199522,9.67741935483871,9.19952210274791,8.72162485065711,8.00477897252091,7.52688172043011,6.45161290322581,6.09318996415771,5.97371565113501,4.89844683393071,4.42054958183991,2.7479091995221,2.389486260454,2.2700119474313],"text":["Sample: S5S<br />Abundance: 21.6248507<br />Tax: Actinomarinales","Sample: S7S<br />Abundance: 18.6379928<br />Tax: Actinomarinales","Sample: S9S<br />Abundance: 13.5005974<br />Tax: Actinomarinales","Sample: S6B<br />Abundance: 10.8721625<br />Tax: Actinomarinales","Sample: S5B<br />Abundance: 10.2747909<br />Tax: Actinomarinales","Sample: S2B<br />Abundance:  9.6774194<br />Tax: Actinomarinales","Sample: S8S<br />Abundance:  9.1995221<br />Tax: Actinomarinales","Sample: S1B<br />Abundance:  8.7216249<br />Tax: Actinomarinales","Sample: S4B<br />Abundance:  8.0047790<br />Tax: Actinomarinales","Sample: S8B<br />Abundance:  7.5268817<br />Tax: Actinomarinales","Sample: S4S<br />Abundance:  6.4516129<br />Tax: Actinomarinales","Sample: S3B<br />Abundance:  6.0931900<br />Tax: Actinomarinales","Sample: S9B<br />Abundance:  5.9737157<br />Tax: Actinomarinales","Sample: S2S<br />Abundance:  4.8984468<br />Tax: Actinomarinales","Sample: S6S<br />Abundance:  4.4205496<br />Tax: Actinomarinales","Sample: S7B<br />Abundance:  2.7479092<br />Tax: Actinomarinales","Sample: S3S<br />Abundance:  2.3894863<br />Tax: Actinomarinales","Sample: S11B<br />Abundance:  2.2700119<br />Tax: Actinomarinales"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,193,167,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Actinomarinales","legendgroup":"Actinomarinales","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.899999999999999,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.9,0.899999999999999],"base":[9.43847072879331,5.37634408602151,7.64635603345281,6.81003584229391,12.4253285543608,6.57108721624851,14.0979689366786,13.3811230585424,2.389486260454,5.01792114695341,4.5400238948626,7.40740740740741,13.2616487455197,6.21266427718041,3.584229390681,9.91636798088411,9.55794504181601,3.2258064516129],"x":[1,2,4,12,3,14,15,10,7,5,11,8,18,16,17,13,6,9],"y":[12.1863799283154,5.49581839904421,5.3763440860215,4.77897252090801,4.42054958183991,4.4205495818399,4.18160095579451,3.9426523297491,3.8231780167264,3.7037037037037,2.7479091995221,2.6284348864994,2.5089605734767,1.6726403823178,1.4336917562724,1.0752688172043,0.955794504181601,0.358422939068101],"text":["Sample: S1B<br />Abundance: 12.1863799<br />Tax: Pseudomonadales","Sample: S2B<br />Abundance:  5.4958184<br />Tax: Pseudomonadales","Sample: S3B<br />Abundance:  5.3763441<br />Tax: Pseudomonadales","Sample: S7B<br />Abundance:  4.7789725<br />Tax: Pseudomonadales","Sample: S2S<br />Abundance:  4.4205496<br />Tax: Pseudomonadales","Sample: S8B<br />Abundance:  4.4205496<br />Tax: Pseudomonadales","Sample: S8S<br />Abundance:  4.1816010<br />Tax: Pseudomonadales","Sample: S6B<br />Abundance:  3.9426523<br />Tax: Pseudomonadales","Sample: S4S<br />Abundance:  3.8231780<br />Tax: Pseudomonadales","Sample: S3S<br />Abundance:  3.7037037<br />Tax: Pseudomonadales","Sample: S6S<br />Abundance:  2.7479092<br />Tax: Pseudomonadales","Sample: S5B<br />Abundance:  2.6284349<br />Tax: Pseudomonadales","Sample: S11B<br />Abundance:  2.5089606<br />Tax: Pseudomonadales","Sample: S9B<br />Abundance:  1.6726404<br />Tax: Pseudomonadales","Sample: S9S<br />Abundance:  1.4336918<br />Tax: Pseudomonadales","Sample: S7S<br />Abundance:  1.0752688<br />Tax: Pseudomonadales","Sample: S4B<br />Abundance:  0.9557945<br />Tax: Pseudomonadales","Sample: S5S<br />Abundance:  0.3584229<br />Tax: Pseudomonadales"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,186,222,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Pseudomonadales","legendgroup":"Pseudomonadales","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.899999999999999,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.9,0.9,0.9,0.899999999999999,0.9,0.899999999999999,0.9,0.899999999999999,0.899999999999999,0.9,0.899999999999999,0.899999999999999,0.899999999999999],"base":[6.45161290322581,6.45161290322581,9.08004778972521,6.21266427718041,10.5137395459976,2.5089605734767,0.1194743130227,3.2258064516129,5.37634408602151,5.73476702508961,5.01792114695341,7.88530465949821,5.37634408602151,5.25686977299881,8.96057347670251,2.8673835125448,4.5400238948626,3.584229390681],"x":[18,3,15,13,10,5,7,2,8,4,12,1,14,16,6,9,11,17],"y":[6.81003584229391,5.97371565113501,5.01792114695341,3.7037037037037,2.8673835125448,2.5089605734767,2.2700119474313,2.1505376344086,2.0310633213859,1.9115890083632,1.7921146953405,1.5531660692951,1.194743130227,0.955794504181601,0.597371565113502,0.3584229390681,0,0],"text":["Sample: S11B<br />Abundance:  6.8100358<br />Tax: Unknown","Sample: S2S<br />Abundance:  5.9737157<br />Tax: Unknown","Sample: S8S<br />Abundance:  5.0179211<br />Tax: Unknown","Sample: S7S<br />Abundance:  3.7037037<br />Tax: Unknown","Sample: S6B<br />Abundance:  2.8673835<br />Tax: Unknown","Sample: S3S<br />Abundance:  2.5089606<br />Tax: Unknown","Sample: S4S<br />Abundance:  2.2700119<br />Tax: Unknown","Sample: S2B<br />Abundance:  2.1505376<br />Tax: Unknown","Sample: S5B<br />Abundance:  2.0310633<br />Tax: Unknown","Sample: S3B<br />Abundance:  1.9115890<br />Tax: Unknown","Sample: S7B<br />Abundance:  1.7921147<br />Tax: Unknown","Sample: S1B<br />Abundance:  1.5531661<br />Tax: Unknown","Sample: S8B<br />Abundance:  1.1947431<br />Tax: Unknown","Sample: S9B<br />Abundance:  0.9557945<br />Tax: Unknown","Sample: S4B<br />Abundance:  0.5973716<br />Tax: Unknown","Sample: S5S<br />Abundance:  0.3584229<br />Tax: Unknown","Sample: S6S<br />Abundance:  0.0000000<br />Tax: Unknown","Sample: S9S<br />Abundance:  0.0000000<br />Tax: Unknown"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,166,255,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Unknown","legendgroup":"Unknown","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.899999999999999,0.9,0.899999999999999,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.9,0.9,0.9,0.899999999999999,0.9,0.899999999999999,0.899999999999999,0.899999999999999],"base":[1.7921146953405,2.1505376344086,6.33213859020311,1.9115890083632,4.1816009557945,5.73476702508961,2.6284348864994,4.0621266427718,3.3452807646356,2.7479091995221,1.5531660692951,7.52688172043011,1.6726403823178,3.1063321385902,0,5.37634408602151,2.8673835125448,5.01792114695341],"x":[18,3,10,4,1,15,14,13,16,11,2,6,5,17,7,8,9,12],"y":[4.6594982078853,4.3010752688172,4.1816009557945,3.8231780167264,3.7037037037037,3.3452807646356,2.7479091995221,2.1505376344086,1.9115890083632,1.7921146953405,1.6726403823178,1.4336917562724,0.836320191158901,0.477897252090801,0.1194743130227,0,0,0],"text":["Sample: S11B<br />Abundance:  4.6594982<br />Tax: Flavobacteriales","Sample: S2S<br />Abundance:  4.3010753<br />Tax: Flavobacteriales","Sample: S6B<br />Abundance:  4.1816010<br />Tax: Flavobacteriales","Sample: S3B<br />Abundance:  3.8231780<br />Tax: Flavobacteriales","Sample: S1B<br />Abundance:  3.7037037<br />Tax: Flavobacteriales","Sample: S8S<br />Abundance:  3.3452808<br />Tax: Flavobacteriales","Sample: S8B<br />Abundance:  2.7479092<br />Tax: Flavobacteriales","Sample: S7S<br />Abundance:  2.1505376<br />Tax: Flavobacteriales","Sample: S9B<br />Abundance:  1.9115890<br />Tax: Flavobacteriales","Sample: S6S<br />Abundance:  1.7921147<br />Tax: Flavobacteriales","Sample: S2B<br />Abundance:  1.6726404<br />Tax: Flavobacteriales","Sample: S4B<br />Abundance:  1.4336918<br />Tax: Flavobacteriales","Sample: S3S<br />Abundance:  0.8363202<br />Tax: Flavobacteriales","Sample: S9S<br />Abundance:  0.4778973<br />Tax: Flavobacteriales","Sample: S4S<br />Abundance:  0.1194743<br />Tax: Flavobacteriales","Sample: S5B<br />Abundance:  0.0000000<br />Tax: Flavobacteriales","Sample: S5S<br />Abundance:  0.0000000<br />Tax: Flavobacteriales","Sample: S7B<br />Abundance:  0.0000000<br />Tax: Flavobacteriales"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(179,133,255,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Flavobacteriales","legendgroup":"Flavobacteriales","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.9,0.9,0.9,0.9,0.9],"base":[1.194743130227,1.4336917562724,2.0310633213859,3.1063321385902,0,2.2700119474313,0,0,1.194743130227,2.1505376344086,1.5531660692951,1.4336917562724,1.4336917562724,1.3142174432497,4.1816009557945,1.5531660692951,1.9115890083632,0],"x":[6,15,8,10,17,12,14,3,16,13,9,11,18,5,1,2,4,7],"y":[6.33213859020311,4.3010752688172,3.3452807646356,3.2258064516129,3.1063321385902,2.7479091995221,2.6284348864994,2.1505376344086,2.1505376344086,1.9115890083632,1.3142174432497,1.3142174432497,0.3584229390681,0.3584229390681,0,0,0,0],"text":["Sample: S4B<br />Abundance:  6.3321386<br />Tax: Chloroplast","Sample: S8S<br />Abundance:  4.3010753<br />Tax: Chloroplast","Sample: S5B<br />Abundance:  3.3452808<br />Tax: Chloroplast","Sample: S6B<br />Abundance:  3.2258065<br />Tax: Chloroplast","Sample: S9S<br />Abundance:  3.1063321<br />Tax: Chloroplast","Sample: S7B<br />Abundance:  2.7479092<br />Tax: Chloroplast","Sample: S8B<br />Abundance:  2.6284349<br />Tax: Chloroplast","Sample: S2S<br />Abundance:  2.1505376<br />Tax: Chloroplast","Sample: S9B<br />Abundance:  2.1505376<br />Tax: Chloroplast","Sample: S7S<br />Abundance:  1.9115890<br />Tax: Chloroplast","Sample: S5S<br />Abundance:  1.3142174<br />Tax: Chloroplast","Sample: S6S<br />Abundance:  1.3142174<br />Tax: Chloroplast","Sample: S11B<br />Abundance:  0.3584229<br />Tax: Chloroplast","Sample: S3S<br />Abundance:  0.3584229<br />Tax: Chloroplast","Sample: S1B<br />Abundance:  0.0000000<br />Tax: Chloroplast","Sample: S2B<br />Abundance:  0.0000000<br />Tax: Chloroplast","Sample: S3B<br />Abundance:  0.0000000<br />Tax: Chloroplast","Sample: S4S<br />Abundance:  0.0000000<br />Tax: Chloroplast"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(239,103,235,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Chloroplast","legendgroup":"Chloroplast","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.9,0.9,0.899999999999999,0.9,0.9,0.899999999999999,0.899999999999999],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,10,12,13,8,4,2,9,18,11,15,5,6,16,3,7,14,17],"y":[4.1816009557945,3.1063321385902,2.2700119474313,2.1505376344086,2.0310633213859,1.9115890083632,1.5531660692951,1.5531660692951,1.4336917562724,1.4336917562724,1.4336917562724,1.3142174432497,1.194743130227,1.194743130227,0,0,0,0],"text":["Sample: S1B<br />Abundance:  4.1816010<br />Tax: Rhodobacterales","Sample: S6B<br />Abundance:  3.1063321<br />Tax: Rhodobacterales","Sample: S7B<br />Abundance:  2.2700119<br />Tax: Rhodobacterales","Sample: S7S<br />Abundance:  2.1505376<br />Tax: Rhodobacterales","Sample: S5B<br />Abundance:  2.0310633<br />Tax: Rhodobacterales","Sample: S3B<br />Abundance:  1.9115890<br />Tax: Rhodobacterales","Sample: S2B<br />Abundance:  1.5531661<br />Tax: Rhodobacterales","Sample: S5S<br />Abundance:  1.5531661<br />Tax: Rhodobacterales","Sample: S11B<br />Abundance:  1.4336918<br />Tax: Rhodobacterales","Sample: S6S<br />Abundance:  1.4336918<br />Tax: Rhodobacterales","Sample: S8S<br />Abundance:  1.4336918<br />Tax: Rhodobacterales","Sample: S3S<br />Abundance:  1.3142174<br />Tax: Rhodobacterales","Sample: S4B<br />Abundance:  1.1947431<br />Tax: Rhodobacterales","Sample: S9B<br />Abundance:  1.1947431<br />Tax: Rhodobacterales","Sample: S2S<br />Abundance:  0.0000000<br />Tax: Rhodobacterales","Sample: S4S<br />Abundance:  0.0000000<br />Tax: Rhodobacterales","Sample: S8B<br />Abundance:  0.0000000<br />Tax: Rhodobacterales","Sample: S9S<br />Abundance:  0.0000000<br />Tax: Rhodobacterales"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,99,182,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Rhodobacterales","legendgroup":"Rhodobacterales","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":54.7945205479452,"l":43.1050228310502},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,18.6],"tickmode":"array","ticktext":["North4S","North3B","North4B","South4S","North2B","North2S","South3S","North1B","North3S","North5B","South5B","South4B","North5S","South1B","South3B","South2S","South2B","South1S"],"tickvals":[7,4,6,17,2,3,15,1,5,8,18,16,9,10,14,13,12,11],"categoryorder":"array","categoryarray":["North4S","North3B","North4B","South4S","North2B","North2S","South3S","North1B","North3S","North5B","South5B","South4B","North5S","South1B","South3B","South2S","South2B","South1S"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-90,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-4.98805256869773,104.749103942652],"tickmode":"array","ticktext":["0","25","50","75","100"],"tickvals":[0,25,50,75,100],"categoryorder":"array","categoryarray":["0","25","50","75","100"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Relative abundance (%)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"title":{"text":"Tax","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"750e31529933":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"750e31529933","visdat":{"750e31529933":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
</section>
<section id="how-to-manage-colors-in-barplots" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="how-to-manage-colors-in-barplots"><span class="header-section-number">7.2</span> How to manage colors in barplots**</h2>
<p>With the number of Phyla, Order etc a barplot can become very confusing Need to have distinct color for each taxonomic groups.</p>
<p><em>Use the library <code>RColorBrewer</code> et <code>scale_fill_manual()</code> </em>See here to understand the possibilities* <em>https://www.nceas.ucsb.edu/sites/default/files/2020-04/colorPaletteCheatsheet.pdf</em></p>
<p>You can visualise <code>RColorBrewer</code>s palettes with the following command:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>RColorBrewer<span class="sc">::</span><span class="fu">display.brewer.all</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="build-your-own-palette" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="build-your-own-palette"><span class="header-section-number">7.2.1</span> Build your own palette</h3>
<p>Lets assemble from two RColorBrewers palettes a single 13 colors palette</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co">#See Set2 colors</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>(col1 <span class="ot">&lt;-</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="at">name =</span> <span class="st">"Set2"</span>, <span class="at">n =</span> <span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "#66C2A5" "#FC8D62" "#8DA0CB" "#E78AC3" "#A6D854" "#FFD92F" "#E5C494"
[8] "#B3B3B3"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co">#See  Paired colors </span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>(col2 <span class="ot">&lt;-</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="at">name =</span> <span class="st">"Paired"</span>, <span class="at">n =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "#A6CEE3" "#1F78B4" "#B2DF8A" "#33A02C" "#FB9A99"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Build your set of colors using brewer.pal or your own colors</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>mycolors <span class="ot">&lt;-</span> <span class="fu">c</span>(col1, col2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="use-your-palette-in-the-p_order-barplot" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="use-your-palette-in-the-p_order-barplot"><span class="header-section-number">7.2.2</span> Use your palette in the p_order barplot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Use scale_fill_manual</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>p_order <span class="sc">+</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="st">"Order"</span>, <span class="at">values =</span> mycolors) <span class="sc">+</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="other-data-manipulation-select-specific-taxa-merge-samples" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="other-data-manipulation-select-specific-taxa-merge-samples"><span class="header-section-number">7.3</span> Other data Manipulation : select specific taxa, merge samples</h2>
<section id="select-actinobacteria-and-bacteroidetes-phyloseqsubset_taxa" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="select-actinobacteria-and-bacteroidetes-phyloseqsubset_taxa"><span class="header-section-number">7.3.1</span> Select Actinobacteria AND Bacteroidetes: <code>phyloseq::subset_taxa()</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>myselection1 <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">subset_taxa</span>(Phylum_glom, Phylum <span class="sc">==</span> <span class="st">"Actinobacteriota"</span> <span class="sc">|</span> Phylum <span class="sc">==</span> <span class="st">"Bacteroidota"</span>)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">plot_bar</span>(myselection1, <span class="at">x =</span> <span class="st">"Description"</span>, <span class="at">fill =</span> <span class="st">"Phylum"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">plot_bar</span>(myselection1, <span class="at">x =</span> <span class="st">"Description"</span>,</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill=</span><span class="st">"Phylum"</span>, <span class="at">facet_grid =</span> <span class="sc">~</span>Phylum) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="keep-all-with-the-exception-of-a-class-a-genus-etc-e.g.-contamination" class="level3" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="keep-all-with-the-exception-of-a-class-a-genus-etc-e.g.-contamination"><span class="header-section-number">7.3.2</span> Keep all with the exception of a class, a genus etc (e.g.&nbsp;contamination)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>myselection2 <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">subset_taxa</span>(physeq, Class <span class="sc">!=</span> <span class="st">"Thermoplasmata"</span> <span class="sc">|</span> <span class="fu">is.na</span>(Class))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="understand" class="level3" data-number="7.3.3">
<h3 data-number="7.3.3" class="anchored" data-anchor-id="understand"><span class="header-section-number">7.3.3</span> Understand:</h3>
<p><span style="color: red;">!</span> <span style="color: steelblue;"><strong>= means IS NOT</strong></span></p>
<p><span style="color: red;">|</span> <span style="color: steelblue;"><strong>= AND</strong></span></p>
<p><span style="color: red;">Is.na</span> <span style="color: steelblue;"> <strong>= do not remove the NA (Not Assigned at the Class rank), by default it will be removed. be careful</strong>!</span></p>
</section>
<section id="merge-samples-groups-duplicates-etc" class="level3" data-number="7.3.4">
<h3 data-number="7.3.4" class="anchored" data-anchor-id="merge-samples-groups-duplicates-etc"><span class="header-section-number">7.3.4</span> Merge samples (groups, duplicates etc)</h3>
<p>Use a column from metadata to group/merge samples (North &amp; South)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>(NordSud <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">merge_samples</span>(physeq_rar, <span class="st">"Geo"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in asMethod(object): NAs introduits lors de la conversion automatique

Warning in asMethod(object): NAs introduits lors de la conversion automatique

Warning in asMethod(object): NAs introduits lors de la conversion automatique

Warning in asMethod(object): NAs introduits lors de la conversion automatique

Warning in asMethod(object): NAs introduits lors de la conversion automatique</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 209 taxa and 2 samples ]
sample_data() Sample Data:       [ 2 samples by 30 sample variables ]
tax_table()   Taxonomy Table:    [ 209 taxa by 7 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 209 tips and 208 internal nodes ]</code></pre>
</div>
</div>
</section>
<section id="sample-selection-phyloseqsubset_samples" class="level3" data-number="7.3.5">
<h3 data-number="7.3.5" class="anchored" data-anchor-id="sample-selection-phyloseqsubset_samples"><span class="header-section-number">7.3.5</span> Sample selection: <code>phyloseq::subset_samples()</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>(sub_North <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">subset_samples</span>(pourcentS, Geo <span class="sc">==</span> <span class="st">"North"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 209 taxa and 9 samples ]
sample_data() Sample Data:       [ 9 samples by 30 sample variables ]
tax_table()   Taxonomy Table:    [ 209 taxa by 7 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 209 tips and 208 internal nodes ]
refseq()      DNAStringSet:      [ 209 reference sequences ]</code></pre>
</div>
</div>
</section>
<section id="alternative-way-phyloseqprune_samples" class="level3" data-number="7.3.6">
<h3 data-number="7.3.6" class="anchored" data-anchor-id="alternative-way-phyloseqprune_samples"><span class="header-section-number">7.3.6</span> Alternative way: <code>phyloseq::prune_samples</code></h3>
<p>Define what you want to keep</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>keep <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"S1B"</span>,<span class="st">"S2S"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then extract these samples from pourcentS phyloseq object</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>keep2samples <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">prune_samples</span>(keep, pourcentS)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_names</span>(keep2samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "S1B" "S2S"</code></pre>
</div>
</div>
</section>
</section>
<section id="retrieve-fasta-sequences-from-a-phyloseq-object" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="retrieve-fasta-sequences-from-a-phyloseq-object"><span class="header-section-number">7.4</span> Retrieve fasta sequences from a phyloseq object</h2>
<section id="create-a-fasta-file-from-your-sequences" class="level3" data-number="7.4.1">
<h3 data-number="7.4.1" class="anchored" data-anchor-id="create-a-fasta-file-from-your-sequences"><span class="header-section-number">7.4.1</span> Create a fasta file from your sequences</h3>
<p>One sequence:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>Biostrings<span class="sc">::</span><span class="fu">writeXStringSet</span>(physeq_rar<span class="sc">@</span>refseq[<span class="st">"ASV1"</span>],</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">filepath =</span> <span class="fu">file.path</span>(output_alpha,<span class="st">"ASV1.fasta"</span>),</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">format =</span> <span class="st">"fasta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="retrieve-a-subset-of-sequences" class="level3" data-number="7.4.2">
<h3 data-number="7.4.2" class="anchored" data-anchor-id="retrieve-a-subset-of-sequences"><span class="header-section-number">7.4.2</span> Retrieve a subset of sequences</h3>
<section id="by-name" class="level4" data-number="7.4.2.1">
<h4 data-number="7.4.2.1" class="anchored" data-anchor-id="by-name"><span class="header-section-number">7.4.2.1</span> By name</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>listASV <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ASV2"</span>, <span class="st">"ASV8"</span>, <span class="st">"ASV32"</span>, <span class="st">"ASV58"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>Biostrings<span class="sc">::</span><span class="fu">writeXStringSet</span>(physeq_rar<span class="sc">@</span>refseq[listASV],</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">filepath =</span> <span class="fu">file.path</span>(output_alpha,<span class="st">"several_asvs.fasta"</span>),</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">format =</span> <span class="st">"fasta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="from-a-selection" class="level4" data-number="7.4.2.2">
<h4 data-number="7.4.2.2" class="anchored" data-anchor-id="from-a-selection"><span class="header-section-number">7.4.2.2</span> From a selection</h4>
<p>Lets export a fasta files of all ASVs with a maximum relative abundance superior to 10% in North samples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">subset_samples</span>(pourcentS, Geo <span class="sc">==</span> <span class="st">"North"</span>) <span class="sc">|&gt;</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>  phyloseq<span class="sc">::</span><span class="fu">filter_taxa</span>(<span class="at">flist =</span> <span class="cf">function</span>(x) <span class="fu">max</span>(x) <span class="sc">&gt;=</span> <span class="dv">10</span>, <span class="at">prune =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>  phyloseq<span class="sc">::</span><span class="fu">refseq</span>() <span class="sc">|&gt;</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>  Biostrings<span class="sc">::</span><span class="fu">writeXStringSet</span>(</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">filepath =</span> <span class="fu">file.path</span>(output_alpha,<span class="st">"fancy_selection_asvs.fasta"</span>),</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">format =</span> <span class="st">"fasta"</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="retrieve-all-sequences" class="level4" data-number="7.4.2.3">
<h4 data-number="7.4.2.3" class="anchored" data-anchor-id="retrieve-all-sequences"><span class="header-section-number">7.4.2.3</span> Retrieve all sequences</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>Biostrings<span class="sc">::</span><span class="fu">writeXStringSet</span>(physeq_rar<span class="sc">@</span>refseq,</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">filepath =</span> <span class="fu">file.path</span>(output_alpha,<span class="st">"all_asvs.fasta"</span>),</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">format =</span> <span class="st">"fasta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
</section>
<section id="core-microbiota-analysis" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Core microbiota analysis</h1>
<section id="identify-the-taxa-names-of-the-core-microbiota" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="identify-the-taxa-names-of-the-core-microbiota"><span class="header-section-number">8.1</span> Identify the taxa names of the core microbiota</h2>
<section id="which-core-compare-north-south-core-microbiota" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="which-core-compare-north-south-core-microbiota"><span class="header-section-number">8.1.1</span> Which core? Compare North &amp; South core microbiota</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create 2 phyloseq objects for North and South sample groups</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>sub_North <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">subset_samples</span>(pourcentS, Geo <span class="sc">==</span> <span class="st">"North"</span>)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>sub_South <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">subset_samples</span>(pourcentS, Geo <span class="sc">==</span> <span class="st">"South"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check groups ok</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>sub_South<span class="sc">@</span>sam_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     SampName   Geo Description groupe Pres PicoEuk Synec Prochloro NanoEuk
S11B     S11B South     South5B    SGF   35    5370 46830       580    6010
S6B       S6B South     South1B    SGF   13    2520 39050       705    3630
S6S       S6S South     South1S    SGS    0    2435 35890       915    3735
S7B       S7B South     South2B    SGF   26       0     0         0    4005
S7S       S7S South     South2S    SGS    0    4535 26545      1340    6585
S8B       S8B South     South3B    SGF   33       0     0         0    5910
S8S       S8S South     South3S    SGS    0    4260 36745       985    5470
S9B       S9B South     South4B    SGF   25    4000 31730       485    4395
S9S       S9S South     South4S    SGS    0    5465 32860       820    5045
     Crypto SiOH4   NO2   NO3   NH4   PO4    NT    PT   Chla       T       S
S11B   1690 3.324 0.083 0.756 0.467 0.115 9.539 4.138 0.0182 23.0308 38.9967
S6B    1295 2.206 0.249 0.768 0.629 0.236 9.013 3.455 0.0000 22.0197 39.0877
S6S    1300 3.004 0.251 0.927 0.653 0.266 8.776 3.230 0.0134 22.0515 39.0884
S7B    1600 3.016 0.157 0.895 0.491 0.176 8.968 4.116 0.0000 23.6669 38.9699
S7S    1355 1.198 0.165 1.099 0.432 0.180 8.256 3.182 0.0000 23.6814 38.9708
S8B    1590 3.868 0.253 0.567 0.533 0.169 8.395 3.126 0.0000 23.1236 39.0054
S8S    2265 3.639 0.255 0.658 0.665 0.247 8.991 3.843 0.0132 23.3147 38.9885
S9B    1180 3.910 0.107 0.672 0.490 0.134 8.954 4.042 0.0172 22.6306 38.9094
S9S    1545 3.607 0.139 0.644 0.373 0.167 9.817 3.689 0.0062 22.9545 38.7777
     Sigma_t observed diversity_gini_simpson diversity_shannon evenness_pielou
S11B 26.9631       36              0.9447863          3.146480       0.8780420
S6B  27.3241       41              0.9439556          3.213508       0.8653415
S6S  27.3151       28              0.8247810          2.440971       0.7325395
S7B  26.7536       36              0.9435901          3.157702       0.8811735
S7S  26.7488       44              0.9488744          3.278296       0.8663140
S8B  26.9423       33              0.9452117          3.108474       0.8890226
S8S  26.8713       39              0.9517578          3.307644       0.9028494
S9B  27.0131       36              0.9443038          3.105908       0.8667202
S9S  26.8172       33              0.9487545          3.180393       0.9095912
     dominance_relative         NRI           NTI       PD MYNEWVAR
S11B         0.10274791 -1.70064052 -1.7348808000 3.532377 sediment
S6B          0.13620072  0.21850759  1.0880702249 3.122788      mer
S6S          0.38351254  2.63122819  0.0003761727 2.422982 sediment
S7B          0.13022700 -1.47035872 -0.6371365496 3.169274      mer
S7S          0.10633214 -2.51835742  0.7082829258 3.453089      mer
S8B          0.09438471 -0.09163059  0.7447376259 2.935800     trap
S8S          0.09677419 -1.20596938  0.4464282161 3.301764     trap
S9B          0.09438471 -0.07394926  0.3100746390 2.880719      mer
S9S          0.10394265  0.44303515  2.4561469676 2.437359      mer</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>sub_North<span class="sc">@</span>sam_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    SampName   Geo Description groupe Pres PicoEuk Synec Prochloro NanoEuk
S1B      S1B North     North1B    NBF   52     660 32195     10675     955
S2B      S2B North     North2B    NBF   59     890 25480     16595     670
S2S      S2S North     North2S    NBS    0     890 25480     16595     670
S3B      S3B North     North3B    NBF   74     835 13340     25115    1115
S3S      S3S North     North3S    NBS    0     715 26725     16860     890
S4B      S4B North     North4B    NBF   78    2220  3130     29835    2120
S4S      S4S North     North4S    NBS   78    2220  3130     29835    2120
S5B      S5B North     North5B    NBF   42    1620 55780     23795    2555
S5S      S5S North     North5S    NBS    0    1620 56555     22835    2560
    Crypto SiOH4   NO2   NO3   NH4   PO4    NT    PT   Chla       T       S
S1B    115 1.813 0.256 0.889 0.324 0.132 9.946 3.565 0.0000 22.7338 37.6204
S2B    395 2.592 0.105 1.125 0.328 0.067 9.378 3.391 0.0000 22.6824 37.6627
S2S    395 3.381 0.231 0.706 0.450 0.109 8.817 3.345 0.0000 22.6854 37.6176
S3B    165 1.438 0.057 1.159 0.369 0.174 8.989 2.568 0.0000 21.5296 37.5549
S3S    200 1.656 0.098 0.794 0.367 0.095 7.847 2.520 0.0000 22.5610 37.5960
S4B    235 2.457 0.099 1.087 0.349 0.137 8.689 3.129 0.0000 18.8515 37.4542
S4S    235 2.457 0.099 1.087 0.349 0.137 8.689 3.129 0.0000 18.8515 37.4542
S5B   1355 2.028 0.103 1.135 0.216 0.128 8.623 3.137 0.0102 24.1905 38.3192
S5S    945 2.669 0.136 0.785 0.267 0.114 9.146 3.062 0.0000 24.1789 38.3213
    Sigma_t observed diversity_gini_simpson diversity_shannon evenness_pielou
S1B 26.0046       35              0.9477924          3.177766       0.8937989
S2B 26.0521       43              0.9577758          3.408022       0.9060997
S2S 26.0137       36              0.9414576          3.112066       0.8684385
S3B 26.2987       41              0.9503989          3.275906       0.8821441
S3S 26.0332       38              0.9491313          3.246802       0.8925706
S4B 26.9415       40              0.9570249          3.350694       0.9083230
S4S 26.9415       40              0.9363446          3.097474       0.8396788
S5B 26.1037       32              0.9271578          2.978541       0.8594252
S5S 26.1065       33              0.9253250          2.993341       0.8560944
    dominance_relative        NRI          NTI       PD MYNEWVAR
S1B         0.10274791  1.1762397 -0.763403610 3.315546      mer
S2B         0.09677419 -0.2612574 -0.664745864 3.697007 sediment
S2S         0.10991637 -2.4551506 -0.741802489 3.422223 sediment
S3B         0.10991637  0.6204511 -1.298745368 3.683481      mer
S3S         0.10991637 -0.1410853 -0.734536950 3.440318     trap
S4B         0.08721625 -0.4855623  0.004555418 3.317148     trap
S4S         0.14336918  1.7734621 -0.913619171 3.436577      mer
S5B         0.16606930  0.1569840  0.131527985 2.959208     trap
S5S         0.18876941 -0.1342517  1.892450438 2.473861     trap</code></pre>
</div>
</div>
</section>
<section id="change-first-column-name-of-taxonomy-rank" class="level3" data-number="8.1.2">
<h3 data-number="8.1.2" class="anchored" data-anchor-id="change-first-column-name-of-taxonomy-rank"><span class="header-section-number">8.1.2</span> Change first column name of taxonomy rank</h3>
<p>Replace Kingdom by Domain, needed for the use of add_best function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Before</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(sub_North<span class="sc">@</span>tax_table)[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Kingdom"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Apply change for North</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(sub_North<span class="sc">@</span>tax_table)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Domain"</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="co">#See </span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(sub_North<span class="sc">@</span>tax_table)[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Domain"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Apply change for South</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(sub_South<span class="sc">@</span>tax_table)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Domain"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="add-the-lowest-taxonomy-classification" class="level3" data-number="8.1.3">
<h3 data-number="8.1.3" class="anchored" data-anchor-id="add-the-lowest-taxonomy-classification"><span class="header-section-number">8.1.3</span> Add the lowest taxonomy classification</h3>
<p>https://rdrr.io/github/microbiome/microbiome/man/add_besthit.html</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>sub_North <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">add_besthit</span>(sub_North, <span class="at">sep =</span> <span class="st">":"</span>)</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>sub_South <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">add_besthit</span>(sub_South, <span class="at">sep =</span> <span class="st">":"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="see-the-transformation-of-tax_table" class="level3" data-number="8.1.4">
<h3 data-number="8.1.4" class="anchored" data-anchor-id="see-the-transformation-of-tax_table"><span class="header-section-number">8.1.4</span> See the transformation of tax_table</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sub_North<span class="sc">@</span>tax_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Taxonomy Table:     [6 taxa by 7 taxonomic ranks]:
                          Domain     Phylum             Class                
ASV1:Synechococcus CC9902 "Bacteria" "Cyanobacteria"    "Cyanobacteriia"     
ASV2:Pseudoalteromonas    "Bacteria" "Proteobacteria"   "Gammaproteobacteria"
ASV3:Clade Ia             "Bacteria" "Proteobacteria"   "Alphaproteobacteria"
ASV4:Marine Group II      "Archaea"  "Thermoplasmatota" "Thermoplasmata"     
ASV5:Clade Ia             "Bacteria" "Proteobacteria"   "Alphaproteobacteria"
ASV6:Clade II             "Bacteria" "Proteobacteria"   "Alphaproteobacteria"
                          Order              Family                  
ASV1:Synechococcus CC9902 "Synechococcales"  "Cyanobiaceae"          
ASV2:Pseudoalteromonas    "Enterobacterales" "Pseudoalteromonadaceae"
ASV3:Clade Ia             "SAR11 clade"      "Clade I"               
ASV4:Marine Group II      "Marine Group II"  NA                      
ASV5:Clade Ia             "SAR11 clade"      "Clade I"               
ASV6:Clade II             "SAR11 clade"      "Clade II"              
                          Genus                  Species
ASV1:Synechococcus CC9902 "Synechococcus CC9902" NA     
ASV2:Pseudoalteromonas    "Pseudoalteromonas"    NA     
ASV3:Clade Ia             "Clade Ia"             NA     
ASV4:Marine Group II      NA                     NA     
ASV5:Clade Ia             "Clade Ia"             NA     
ASV6:Clade II             NA                     NA     </code></pre>
</div>
</div>
</section>
<section id="identify-core-microbiota" class="level3" data-number="8.1.5">
<h3 data-number="8.1.5" class="anchored" data-anchor-id="identify-core-microbiota"><span class="header-section-number">8.1.5</span> Identify Core microbiota</h3>
<p>https://rdrr.io/github/microbiome/microbiome/man/core_members.html</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co">#North</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>(core_taxa_north <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">core_members</span>(sub_North,</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">detection =</span> <span class="fl">0.0001</span>,</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">prevalence =</span> <span class="dv">50</span><span class="sc">/</span><span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "ASV1:Synechococcus CC9902"            
 [2] "ASV2:Pseudoalteromonas"               
 [3] "ASV3:Clade Ia"                        
 [4] "ASV4:Marine Group II"                 
 [5] "ASV5:Clade Ia"                        
 [6] "ASV6:Clade II"                        
 [7] "ASV9:Clade Ia"                        
 [8] "ASV10:Clade Ia"                       
 [9] "ASV11:AEGEAN-169 marine group"        
[10] "ASV12:Prochlorococcus MIT9313.marinus"
[11] "ASV16:AEGEAN-169 marine group"        
[12] "ASV18:Clade Ib"                       
[13] "ASV22:Clade Ia"                       
[14] "ASV23:Clade Ia"                       
[15] "ASV26:Chloroplast"                    
[16] "ASV30:Marine Group II"                
[17] "ASV32:Dadabacteriales"                
[18] "ASV33:SAR324 clade(Marine group B)"   
[19] "ASV35:Clade IV"                       
[20] "ASV37:Marine Group III"               
[21] "ASV49:SAR202 clade"                   
[22] "ASV53:AEGEAN-169 marine group"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co">#South</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>(core.taxa.South <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">core_members</span>(sub_South,</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">detection =</span> <span class="fl">0.0001</span>,</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">prevalence =</span> <span class="dv">50</span><span class="sc">/</span><span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "ASV1:Synechococcus CC9902"          "ASV2:Pseudoalteromonas"            
 [3] "ASV3:Clade Ia"                      "ASV4:Marine Group II"              
 [5] "ASV5:Clade Ia"                      "ASV6:Clade II"                     
 [7] "ASV7:AEGEAN-169 marine group"       "ASV8:Pseudoalteromonas"            
 [9] "ASV9:Clade Ia"                      "ASV13:Alteromonas"                 
[11] "ASV19:AEGEAN-169 marine group"      "ASV20:Marine Group II"             
[13] "ASV21:SAR86 clade"                  "ASV24:NS4 marine group"            
[15] "ASV26:Chloroplast"                  "ASV27:Marine Group II"             
[17] "ASV29:Clade Ib"                     "ASV33:SAR324 clade(Marine group B)"
[19] "ASV41:Marine Group II"              "ASV43:Marine Group II"             
[21] "ASV51:SAR324 clade(Marine group B)" "ASV54:SAR202 clade"                
[23] "ASV62:Pseudoalteromonas"            "ASV90:Pseudoalteromonas"           </code></pre>
</div>
</div>
</section>
<section id="get-core-microbiota-phyloseq-object" class="level3" data-number="8.1.6">
<h3 data-number="8.1.6" class="anchored" data-anchor-id="get-core-microbiota-phyloseq-object"><span class="header-section-number">8.1.6</span> Get core microbiota phyloseq object</h3>
<p>Get the phyloseq object with also sequences, phylo tree etc.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>(phyloseq_core_north <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">core</span>(sub_North,</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">detection =</span> <span class="fl">0.0001</span>,</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">prevalence =</span> .<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 22 taxa and 9 samples ]
sample_data() Sample Data:       [ 9 samples by 30 sample variables ]
tax_table()   Taxonomy Table:    [ 22 taxa by 7 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 22 tips and 21 internal nodes ]
refseq()      DNAStringSet:      [ 22 reference sequences ]</code></pre>
</div>
</div>
<p>See full taxanomy of core members</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>(tax_mat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(phyloseq<span class="sc">::</span><span class="fu">tax_table</span>(phyloseq_core_north)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                        Domain                       Phylum
ASV1:Synechococcus CC9902             Bacteria                Cyanobacteria
ASV2:Pseudoalteromonas                Bacteria               Proteobacteria
ASV3:Clade Ia                         Bacteria               Proteobacteria
ASV4:Marine Group II                   Archaea             Thermoplasmatota
ASV5:Clade Ia                         Bacteria               Proteobacteria
ASV6:Clade II                         Bacteria               Proteobacteria
ASV9:Clade Ia                         Bacteria               Proteobacteria
ASV10:Clade Ia                        Bacteria               Proteobacteria
ASV11:AEGEAN-169 marine group         Bacteria               Proteobacteria
ASV12:Prochlorococcus MIT9313.marinus Bacteria                Cyanobacteria
ASV16:AEGEAN-169 marine group         Bacteria               Proteobacteria
ASV18:Clade Ib                        Bacteria               Proteobacteria
ASV22:Clade Ia                        Bacteria               Proteobacteria
ASV23:Clade Ia                        Bacteria               Proteobacteria
ASV26:Chloroplast                     Bacteria                Cyanobacteria
ASV30:Marine Group II                  Archaea             Thermoplasmatota
ASV32:Dadabacteriales                 Bacteria                 Dadabacteria
ASV33:SAR324 clade(Marine group B)    Bacteria SAR324 clade(Marine group B)
ASV35:Clade IV                        Bacteria               Proteobacteria
ASV37:Marine Group III                 Archaea             Thermoplasmatota
ASV49:SAR202 clade                    Bacteria                  Chloroflexi
ASV53:AEGEAN-169 marine group         Bacteria               Proteobacteria
                                                    Class            Order
ASV1:Synechococcus CC9902                  Cyanobacteriia  Synechococcales
ASV2:Pseudoalteromonas                Gammaproteobacteria Enterobacterales
ASV3:Clade Ia                         Alphaproteobacteria      SAR11 clade
ASV4:Marine Group II                       Thermoplasmata  Marine Group II
ASV5:Clade Ia                         Alphaproteobacteria      SAR11 clade
ASV6:Clade II                         Alphaproteobacteria      SAR11 clade
ASV9:Clade Ia                         Alphaproteobacteria      SAR11 clade
ASV10:Clade Ia                        Alphaproteobacteria      SAR11 clade
ASV11:AEGEAN-169 marine group         Alphaproteobacteria Rhodospirillales
ASV12:Prochlorococcus MIT9313.marinus      Cyanobacteriia  Synechococcales
ASV16:AEGEAN-169 marine group         Alphaproteobacteria Rhodospirillales
ASV18:Clade Ib                        Alphaproteobacteria      SAR11 clade
ASV22:Clade Ia                        Alphaproteobacteria      SAR11 clade
ASV23:Clade Ia                        Alphaproteobacteria      SAR11 clade
ASV26:Chloroplast                          Cyanobacteriia      Chloroplast
ASV30:Marine Group II                      Thermoplasmata  Marine Group II
ASV32:Dadabacteriales                       Dadabacteriia  Dadabacteriales
ASV33:SAR324 clade(Marine group B)                   &lt;NA&gt;             &lt;NA&gt;
ASV35:Clade IV                        Alphaproteobacteria      SAR11 clade
ASV37:Marine Group III                     Thermoplasmata Marine Group III
ASV49:SAR202 clade                        Dehalococcoidia     SAR202 clade
ASV53:AEGEAN-169 marine group         Alphaproteobacteria Rhodospirillales
                                                       Family
ASV1:Synechococcus CC9902                        Cyanobiaceae
ASV2:Pseudoalteromonas                 Pseudoalteromonadaceae
ASV3:Clade Ia                                         Clade I
ASV4:Marine Group II                                     &lt;NA&gt;
ASV5:Clade Ia                                         Clade I
ASV6:Clade II                                        Clade II
ASV9:Clade Ia                                         Clade I
ASV10:Clade Ia                                        Clade I
ASV11:AEGEAN-169 marine group         AEGEAN-169 marine group
ASV12:Prochlorococcus MIT9313.marinus            Cyanobiaceae
ASV16:AEGEAN-169 marine group         AEGEAN-169 marine group
ASV18:Clade Ib                                        Clade I
ASV22:Clade Ia                                        Clade I
ASV23:Clade Ia                                        Clade I
ASV26:Chloroplast                                        &lt;NA&gt;
ASV30:Marine Group II                                    &lt;NA&gt;
ASV32:Dadabacteriales                                    &lt;NA&gt;
ASV33:SAR324 clade(Marine group B)                       &lt;NA&gt;
ASV35:Clade IV                                       Clade IV
ASV37:Marine Group III                                   &lt;NA&gt;
ASV49:SAR202 clade                                       &lt;NA&gt;
ASV53:AEGEAN-169 marine group         AEGEAN-169 marine group
                                                        Genus Species
ASV1:Synechococcus CC9902                Synechococcus CC9902    &lt;NA&gt;
ASV2:Pseudoalteromonas                      Pseudoalteromonas    &lt;NA&gt;
ASV3:Clade Ia                                        Clade Ia    &lt;NA&gt;
ASV4:Marine Group II                                     &lt;NA&gt;    &lt;NA&gt;
ASV5:Clade Ia                                        Clade Ia    &lt;NA&gt;
ASV6:Clade II                                            &lt;NA&gt;    &lt;NA&gt;
ASV9:Clade Ia                                        Clade Ia    &lt;NA&gt;
ASV10:Clade Ia                                       Clade Ia    &lt;NA&gt;
ASV11:AEGEAN-169 marine group                            &lt;NA&gt;    &lt;NA&gt;
ASV12:Prochlorococcus MIT9313.marinus Prochlorococcus MIT9313 marinus
ASV16:AEGEAN-169 marine group                            &lt;NA&gt;    &lt;NA&gt;
ASV18:Clade Ib                                       Clade Ib    &lt;NA&gt;
ASV22:Clade Ia                                       Clade Ia    &lt;NA&gt;
ASV23:Clade Ia                                       Clade Ia    &lt;NA&gt;
ASV26:Chloroplast                                        &lt;NA&gt;    &lt;NA&gt;
ASV30:Marine Group II                                    &lt;NA&gt;    &lt;NA&gt;
ASV32:Dadabacteriales                                    &lt;NA&gt;    &lt;NA&gt;
ASV33:SAR324 clade(Marine group B)                       &lt;NA&gt;    &lt;NA&gt;
ASV35:Clade IV                                           &lt;NA&gt;    &lt;NA&gt;
ASV37:Marine Group III                                   &lt;NA&gt;    &lt;NA&gt;
ASV49:SAR202 clade                                       &lt;NA&gt;    &lt;NA&gt;
ASV53:AEGEAN-169 marine group                            &lt;NA&gt;    &lt;NA&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="visualise-core-microbiome-with-microbiomeplot_core" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="visualise-core-microbiome-with-microbiomeplot_core"><span class="header-section-number">8.2</span> Visualise core microbiome with <code>microbiome::plot_core()</code></h2>
<p>Visualise the core microbiome of North samples</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>microbiome<span class="sc">::</span><span class="fu">plot_core</span>(phyloseq_core_north,</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">plot.type =</span> <span class="st">"heatmap"</span>,</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">colours =</span> <span class="fu">rev</span>(RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"RdBu"</span>)),</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">prevalences =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">1</span>),</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">detections =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.1</span>, <span class="at">to =</span> <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Detection Threshold (Relative Abundance (%))"</span>) <span class="sc">+</span></span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"ASVs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in microbiome::plot_core(phyloseq_core_north, plot.type = "heatmap", : The plot_core function is typically used with compositional 
                data. The data is not compositional. Make sure that you
                intend to operate on non-compositional data.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="alpha_diversity_files/figure-html/unnamed-chunk-105-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>Do the same for the South samples .. please!</p>
<p>What are your conclusions about the comparison between North &amp; South core micobiota at the ASV level?</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>